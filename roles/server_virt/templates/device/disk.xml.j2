<disk type='{{dev.type}}' device='{{dev.device}}'{%- if dev.rawio is defined -%} rawio='{{dev.rawio}}'{%- endif -%}{%- if dev.sgio is defined -%} sgio='{{dev.sgio}}'{%- endif -%}{%- if dev.snapshot is defined -%} snapshot='{{dev.snapshot}}'{%- endif -%}>
    {%- source_type = dev.type -%}
    {%- source = dev.source -%}
    {%- include 'device/disk_source.xml.j2'}
    {%- if dev.backing_store is defined -%}
        {% set backing_store = dev.backing_store %}
        {% include 'disk_backing_store.xml.j2' %}
    {%- endif -%}
    {# TODO mirror #}
    {%- if dev.target is defined -%}
        <target dev='{{dev.target.dev}}'{%- if dev.target.bus is defined -%} bus='{{dev.target.bus}}'{%- endif -%}{%- if dev.target.tray is defined -%} tray='{{dev.target.tray}}'{%- endif -%}{%- if dev.target.removable is defined -%} removable='{{dev.target.removable}}'{%- endif -%}/>
    {%- endif -%}
    {# TODO iotune #}
    {# TODO backenddomain #}
    {%- if dev.shareable is defined -%}
        <shareable/>
    {%- endif -%}
    {%- if dev.transient is defined -%}
        <transient/>
    {%- endif -%}
    {%- if dev.serial is defined -%}
        <serial>{{dev.serial}}</serial>
    {%- endif -%}
    {%- if dev.wwn is defined -%}
        <wwn>{{dev.wwn}}</wwn>
    {%- endif -%}
    {%- if dev.vendor is defined -%}
        <vendor>{{dev.vendor}}</vendor>
    {%- endif -%}
    {%- if dev.product is defined -%}
        <product>{{dev.product}}</product>
    {%- endif -%}
    {# TODO geometry}
    {# TODO blockio}
    {%- include 'common.xml.j2' -%}
</disk>
