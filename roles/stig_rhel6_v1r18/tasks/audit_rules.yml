# Vuln ID: V-38522
# Severity: low
# Group Title: SRG-OS-000062
# Rule ID: SV-50323r3_rule
# STIG ID: RHEL-06-000167
# Rule Title: The audit system must be configured to audit all attempts to alter system time through settimeofday.
# Discussion: Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "settimeofday" system call, run the following command:
#
# $ sudo grep -w "settimeofday" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line.
#
# If the system is not configured to audit time changes, this is a finding.
# Fix Text: On a 32-bit system, add the following to "/etc/audit/audit.rules":
#
# # audit_time_rules
# -a always,exit -F arch=b32 -S settimeofday -k audit_time_rules
#
# On a 64-bit system, add the following to "/etc/audit/audit.rules":
#
# # audit_time_rules
# -a always,exit -F arch=b64 -S settimeofday -k audit_time_rules
#
# The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport. Multiple system calls can be defined on the same line to save space if desired, but is not required. See an example of multiple combined syscalls:
#
# -a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -k audit_time_rules
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000169
# The information system provides audit record generation capability for the auditable events defined in AU-2 a at organization-defined information system components.
# NIST SP 800-53 :: AU-12 a
# NIST SP 800-53A :: AU-12.1 (ii)
# NIST SP 800-53 Revision 4 :: AU-12 a
#
#
- name: check stig_rhel6_v1r18 v_38522
  set_fact: stig_rhel6_v1r18_results['v_38522'] = 'fail'
  when: '"v_38522" in check_findings'


# Vuln ID: V-38525
# Severity: low
# Group Title: SRG-OS-000062
# Rule ID: SV-50326r4_rule
# STIG ID: RHEL-06-000169
# Rule Title: The audit system must be configured to audit all attempts to alter system time through stime.
# Discussion: Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.
# IA Controls:
# Check Content: If the system is 64-bit only, this is not applicable.
#
# To determine if the system is configured to audit calls to the "stime" system call, run the following command:
#
# $ sudo grep -w "stime" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line.
#
# If the system is not configured to audit time changes, this is a finding.
# Fix Text: On a 32-bit system, add the following to "/etc/audit/audit.rules":
#
# # audit_time_rules
# -a always,exit -F arch=b32 -S stime -k audit_time_rules
#
# On a 64-bit system, the "-S stime" is not necessary. The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport. Multiple system calls can be defined on the same line to save space if desired, but is not required. See an example of multiple combined syscalls:
#
# -a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -k audit_time_rules
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000169
# The information system provides audit record generation capability for the auditable events defined in AU-2 a at organization-defined information system components.
# NIST SP 800-53 :: AU-12 a
# NIST SP 800-53A :: AU-12.1 (ii)
# NIST SP 800-53 Revision 4 :: AU-12 a
#
#
- name: check stig_rhel6_v1r18 v_38525
  set_fact: stig_rhel6_v1r18_results['v_38525'] = 'fail'
  when: '"v_38525" in check_findings'


# Vuln ID: V-38527
# Severity: low
# Group Title: SRG-OS-000062
# Rule ID: SV-50328r3_rule
# STIG ID: RHEL-06-000171
# Rule Title: The audit system must be configured to audit all attempts to alter system time through clock_settime.
# Discussion: Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "clock_settime" system call, run the following command:
#
# $ sudo grep -w "clock_settime" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line.
#
# If the system is not configured to audit time changes, this is a finding.
# Fix Text: On a 32-bit system, add the following to "/etc/audit/audit.rules":
#
# # audit_time_rules
# -a always,exit -F arch=b32 -S clock_settime -k audit_time_rules
#
# On a 64-bit system, add the following to "/etc/audit/audit.rules":
#
# # audit_time_rules
# -a always,exit -F arch=b64 -S clock_settime -k audit_time_rules
#
# The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport. Multiple system calls can be defined on the same line to save space if desired, but is not required. See an example of multiple combined syscalls:
#
# -a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -k audit_time_rules
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000169
# The information system provides audit record generation capability for the auditable events defined in AU-2 a at organization-defined information system components.
# NIST SP 800-53 :: AU-12 a
# NIST SP 800-53A :: AU-12.1 (ii)
# NIST SP 800-53 Revision 4 :: AU-12 a
#
#
- name: check stig_rhel6_v1r18 v_38527
  set_fact: stig_rhel6_v1r18_results['v_38527'] = 'fail'
  when: '"v_38527" in check_findings'


# Vuln ID: V-38530
# Severity: low
# Group Title: SRG-OS-000062
# Rule ID: SV-50331r2_rule
# STIG ID: RHEL-06-000173
# Rule Title: The audit system must be configured to audit all attempts to alter system time through /etc/localtime.
# Discussion: Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.
# IA Controls:
# Check Content: To determine if the system is configured to audit attempts to alter time via the /etc/localtime file, run the following command:
#
# $ sudo grep -w "/etc/localtime" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line.
#
# If the system is not configured to audit time changes, this is a finding.
# Fix Text: Add the following to "/etc/audit/audit.rules":
#
# -w /etc/localtime -p wa -k audit_time_rules
#
# The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport and should always be used.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000169
# The information system provides audit record generation capability for the auditable events defined in AU-2 a at organization-defined information system components.
# NIST SP 800-53 :: AU-12 a
# NIST SP 800-53A :: AU-12.1 (ii)
# NIST SP 800-53 Revision 4 :: AU-12 a
#
#
- name: check stig_rhel6_v1r18 v_38530
  set_fact: stig_rhel6_v1r18_results['v_38530'] = 'fail'
  when: '"v_38530" in check_findings'


# Vuln ID: V-38531
# Severity: low
# Group Title: SRG-OS-000004
# Rule ID: SV-50332r2_rule
# STIG ID: RHEL-06-000174
# Rule Title: The operating system must automatically audit account creation.
# Discussion: In addition to auditing new user and group accounts, these watches will alert the system administrator(s) to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.
# IA Controls:
# Check Content: To determine if the system is configured to audit account changes, run the following command:
#
# $ sudo egrep -w '(/etc/passwd|/etc/shadow|/etc/group|/etc/gshadow|/etc/security/opasswd)' /etc/audit/audit.rules
#
# If the system is configured to watch for account changes, lines should be returned for each file specified (and with "-p wa" for each).
#
# If the system is not configured to audit account changes, this is a finding.
# Fix Text: Add the following to "/etc/audit/audit.rules", in order to capture events that modify account changes:
#
# # audit_account_changes
# -w /etc/group -p wa -k audit_account_changes
# -w /etc/passwd -p wa -k audit_account_changes
# -w /etc/gshadow -p wa -k audit_account_changes
# -w /etc/shadow -p wa -k audit_account_changes
# -w /etc/security/opasswd -p wa -k audit_account_changes
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000018
# The information system automatically audits account creation actions.
# NIST SP 800-53 :: AC-2 (4)
# NIST SP 800-53A :: AC-2 (4).1 (i&ii)
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
#
- name: check stig_rhel6_v1r18 v_38531
  set_fact: stig_rhel6_v1r18_results['v_38531'] = 'fail'
  when: '"v_38531" in check_findings'


# Vuln ID: V-38534
# Severity: low
# Group Title: SRG-OS-000239
# Rule ID: SV-50335r2_rule
# STIG ID: RHEL-06-000175
# Rule Title: The operating system must automatically audit account modification.
# Discussion: In addition to auditing new user and group accounts, these watches will alert the system administrator(s) to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.
# IA Controls:
# Check Content: To determine if the system is configured to audit account changes, run the following command:
#
# $sudo egrep -w '(/etc/passwd|/etc/shadow|/etc/group|/etc/gshadow|/etc/security/opasswd)' /etc/audit/audit.rules
#
# If the system is configured to watch for account changes, lines should be returned for each file specified (and with "-p wa" for each).
#
# If the system is not configured to audit account changes, this is a finding.
# Fix Text: Add the following to "/etc/audit/audit.rules", in order to capture events that modify account changes:
#
# # audit_account_changes
# -w /etc/group -p wa -k audit_account_changes
# -w /etc/passwd -p wa -k audit_account_changes
# -w /etc/gshadow -p wa -k audit_account_changes
# -w /etc/shadow -p wa -k audit_account_changes
# -w /etc/security/opasswd -p wa -k audit_account_changes
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001403
# The information system automatically audits account modification actions.
# NIST SP 800-53 :: AC-2 (4)
# NIST SP 800-53A :: AC-2 (4).1 (i&ii)
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
#
- name: check stig_rhel6_v1r18 v_38534
  set_fact: stig_rhel6_v1r18_results['v_38534'] = 'fail'
  when: '"v_38534" in check_findings'


# Vuln ID: V-38536
# Severity: low
# Group Title: SRG-OS-000240
# Rule ID: SV-50337r2_rule
# STIG ID: RHEL-06-000176
# Rule Title: The operating system must automatically audit account disabling actions.
# Discussion: In addition to auditing new user and group accounts, these watches will alert the system administrator(s) to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.
# IA Controls:
# Check Content: To determine if the system is configured to audit account changes, run the following command:
#
# $sudo egrep -w '(/etc/passwd|/etc/shadow|/etc/group|/etc/gshadow|/etc/security/opasswd)' /etc/audit/audit.rules
#
# If the system is configured to watch for account changes, lines should be returned for each file specified (and with "-p wa" for each).
#
# If the system is not configured to audit account changes, this is a finding.
# Fix Text: Add the following to "/etc/audit/audit.rules", in order to capture events that modify account changes:
#
# # audit_account_changes
# -w /etc/group -p wa -k audit_account_changes
# -w /etc/passwd -p wa -k audit_account_changes
# -w /etc/gshadow -p wa -k audit_account_changes
# -w /etc/shadow -p wa -k audit_account_changes
# -w /etc/security/opasswd -p wa -k audit_account_changes
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001404
# The information system automatically audits account disabling actions.
# NIST SP 800-53 :: AC-2 (4)
# NIST SP 800-53A :: AC-2 (4).1 (i&ii)
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
#
- name: check stig_rhel6_v1r18 v_38536
  set_fact: stig_rhel6_v1r18_results['v_38536'] = 'fail'
  when: '"v_38536" in check_findings'


# Vuln ID: V-38538
# Severity: low
# Group Title: SRG-OS-000241
# Rule ID: SV-50339r2_rule
# STIG ID: RHEL-06-000177
# Rule Title: The operating system must automatically audit account termination.
# Discussion: In addition to auditing new user and group accounts, these watches will alert the system administrator(s) to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.
# IA Controls:
# Check Content: To determine if the system is configured to audit account changes, run the following command:
#
# $sudo egrep -w '(/etc/passwd|/etc/shadow|/etc/group|/etc/gshadow|/etc/security/opasswd)' /etc/audit/audit.rules
#
# If the system is configured to watch for account changes, lines should be returned for each file specified (and with "-p wa" for each).
#
# If the system is not configured to audit account changes, this is a finding.
# Fix Text: Add the following to "/etc/audit/audit.rules", in order to capture events that modify account changes:
#
# # audit_account_changes
# -w /etc/group -p wa -k audit_account_changes
# -w /etc/passwd -p wa -k audit_account_changes
# -w /etc/gshadow -p wa -k audit_account_changes
# -w /etc/shadow -p wa -k audit_account_changes
# -w /etc/security/opasswd -p wa -k audit_account_changes
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001405
# The information system automatically audits account removal actions.
# NIST SP 800-53 :: AC-2 (4)
# NIST SP 800-53A :: AC-2 (4).1 (i&ii)
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
#
- name: check stig_rhel6_v1r18 v_38538
  set_fact: stig_rhel6_v1r18_results['v_38538'] = 'fail'
  when: '"v_38538" in check_findings'


# Vuln ID: V-38540
# Severity: low
# Group Title: SRG-OS-999999
# Rule ID: SV-50341r4_rule
# STIG ID: RHEL-06-000182
# Rule Title: The audit system must be configured to audit modifications to the systems network configuration.
# Discussion: The network environment should not be modified by anything other than administrator action. Any change to network parameters should be audited.
# IA Controls:
# Check Content: If you are running x86_64 architecture, determine the values for sethostname:
# $ uname -m; ausyscall i386 sethostname; ausyscall x86_64 sethostname
#
# If the values returned are not identical verify that the system is configured to monitor network configuration changes for the i386 and x86_64 architectures:
#
# $ sudo egrep -w '(sethostname|setdomainname|/etc/issue|/etc/issue.net|/etc/hosts|/etc/sysconfig/network)' /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S sethostname -S setdomainname -k audit_network_modifications
# -w /etc/issue -p wa -k audit_network_modifications
# -w /etc/issue.net -p wa -k audit_network_modifications
# -w /etc/hosts -p wa -k audit_network_modifications
# -w /etc/sysconfig/network -p wa -k audit_network_modifications
#
# -a always,exit -F arch=b64 -S sethostname -S setdomainname -k audit_network_modifications
# -w /etc/issue -p wa -k audit_network_modifications
# -w /etc/issue.net -p wa -k audit_network_modifications
# -w /etc/hosts -p wa -k audit_network_modifications
# -w /etc/sysconfig/network -p wa -k audit_network_modifications
#
# If the system is configured to watch for network configuration changes, a line should be returned for each file specified for both (and "-p wa" should be indicated for each).
#
# If the system is not configured to audit changes of the network configuration, this is a finding.
#
# Fix Text: Add the following to "/etc/audit/audit.rules", setting ARCH to either b32 or b64 as appropriate for your system:
#
# # audit_network_modifications
# -a always,exit -F arch=ARCH -S sethostname -S setdomainname -k audit_network_modifications
# -w /etc/issue -p wa -k audit_network_modifications
# -w /etc/issue.net -p wa -k audit_network_modifications
# -w /etc/hosts -p wa -k audit_network_modifications
# -w /etc/sysconfig/network -p wa -k audit_network_modifications
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38540
  set_fact: stig_rhel6_v1r18_results['v_38540'] = 'fail'
  when: '"v_38540" in check_findings'


# Vuln ID: V-38541
# Severity: low
# Group Title: SRG-OS-999999
# Rule ID: SV-50342r2_rule
# STIG ID: RHEL-06-000183
# Rule Title: The audit system must be configured to audit modifications to the systems Mandatory Access Control (MAC) configuration (SELinux).
# Discussion: The system's mandatory access policy (SELinux) should not be arbitrarily changed by anything other than administrator action. All changes to MAC policy should be audited.
# IA Controls:
# Check Content: To determine if the system is configured to audit changes to its SELinux configuration files, run the following command:
#
# $ sudo grep -w "/etc/selinux" /etc/audit/audit.rules
#
# If the system is configured to watch for changes to its SELinux configuration, a line should be returned (including "-p wa" indicating permissions that are watched).
#
# If the system is not configured to audit attempts to change the MAC policy, this is a finding.
# Fix Text: Add the following to "/etc/audit/audit.rules":
#
# -w /etc/selinux/ -p wa -k MAC-policy
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38541
  set_fact: stig_rhel6_v1r18_results['v_38541'] = 'fail'
  when: '"v_38541" in check_findings'


# Vuln ID: V-38543
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50344r3_rule
# STIG ID: RHEL-06-000184
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using chmod.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "chmod" system call, run the following command:
#
# $ sudo grep -w "chmod" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If the system is not configured to audit permission changes, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S chmod -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S chmod -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S chmod -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S chmod -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
- name: check stig_rhel6_v1r18 v_38543
  set_fact: stig_rhel6_v1r18_results['v_38543'] = 'fail'
  when: '"v_38543" in check_findings'


# Vuln ID: V-38545
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50346r3_rule
# STIG ID: RHEL-06-000185
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using chown.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "chown" system call, run the following command:
#
# $ sudo grep -w "chown" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S chown -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S chown -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S chown -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S chown -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
- name: check stig_rhel6_v1r18 v_38545
  set_fact: stig_rhel6_v1r18_results['v_38545'] = 'fail'
  when: '"v_38545" in check_findings'


# Vuln ID: V-38547
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50348r3_rule
# STIG ID: RHEL-06-000186
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using fchmod.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "fchmod" system call, run the following command:
#
# $ sudo grep -w "fchmod" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S fchmod -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S fchmod -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S fchmod -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S fchmod -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
- name: check stig_rhel6_v1r18 v_38547
  set_fact: stig_rhel6_v1r18_results['v_38547'] = 'fail'
  when: '"v_38547" in check_findings'


# Vuln ID: V-38550
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50351r3_rule
# STIG ID: RHEL-06-000187
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using fchmodat.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "fchmodat" system call, run the following command:
#
# $ sudo grep -w "fchmodat" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S fchmodat -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S fchmodat -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S fchmodat -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S fchmodat -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
- name: check stig_rhel6_v1r18 v_38550
  set_fact: stig_rhel6_v1r18_results['v_38550'] = 'fail'
  when: '"v_38550" in check_findings'


# Vuln ID: V-38552
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50353r3_rule
# STIG ID: RHEL-06-000188
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using fchown.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "fchown" system call, run the following command:
#
# $ sudo grep -w "fchown" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S fchown -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S fchown -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S fchown -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S fchown -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
- name: check stig_rhel6_v1r18 v_38552
  set_fact: stig_rhel6_v1r18_results['v_38552'] = 'fail'
  when: '"v_38552" in check_findings'


# Severity: low
# Vuln ID: V-38554
# Group Title: SRG-OS-000064
# Rule ID: SV-50355r3_rule
# STIG ID: RHEL-06-000189
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using fchownat.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "fchownat" system call, run the following command:
#
# $ sudo grep -w "fchownat" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S fchownat -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S fchownat -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S fchownat -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S fchownat -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
- name: check stig_rhel6_v1r18 v_38554
  set_fact: stig_rhel6_v1r18_results['v_38554'] = 'fail'
  when: '"v_38554" in check_findings'


# Vuln ID: V-38556
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50357r3_rule
# STIG ID: RHEL-06-000190
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using fremovexattr.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "fremovexattr" system call, run the following command:
#
# $ sudo grep -w "fremovexattr" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S fremovexattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S fremovexattr -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S fremovexattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S fremovexattr -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
- name: check stig_rhel6_v1r18 v_38556
  set_fact: stig_rhel6_v1r18_results['v_38556'] = 'fail'
  when: '"v_38556" in check_findings'


# Vuln ID: V-38557
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50358r3_rule
# STIG ID: RHEL-06-000191
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using fsetxattr.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "fsetxattr" system call, run the following command:
#
# $ sudo grep -w "fsetxattr" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S fsetxattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S fsetxattr -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S fsetxattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S fsetxattr -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
- name: check stig_rhel6_v1r18 v_38557
  set_fact: stig_rhel6_v1r18_results['v_38557'] = 'fail'
  when: '"v_38557" in check_findings'


# Vuln ID: V-38558
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50359r3_rule
# STIG ID: RHEL-06-000192
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using lchown.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "lchown" system call, run the following command:
#
# $ sudo grep -w "lchown" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S lchown -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S lchown -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S lchown -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S lchown -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
- name: check stig_rhel6_v1r18 v_38558
  set_fact: stig_rhel6_v1r18_results['v_38558'] = 'fail'
  when: '"v_38558" in check_findings'


# Vuln ID: V-38559
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50360r3_rule
# STIG ID: RHEL-06-000193
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using lremovexattr.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "lremovexattr" system call, run the following command:
#
# $ sudo grep -w "lremovexattr" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S lremovexattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S lremovexattr -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S lremovexattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S lremovexattr -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
- name: check stig_rhel6_v1r18 v_38559
  set_fact: stig_rhel6_v1r18_results['v_38559'] = 'fail'
  when: '"v_38559" in check_findings'


# Vuln ID: V-38561
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50362r3_rule
# STIG ID: RHEL-06-000194
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using lsetxattr.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "lsetxattr" system call, run the following command:
#
# $ sudo grep -w "lsetxattr" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S lsetxattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S lsetxattr -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S lsetxattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S lsetxattr -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
- name: check stig_rhel6_v1r18 v_38561
  set_fact: stig_rhel6_v1r18_results['v_38561'] = 'fail'
  when: '"v_38561" in check_findings'


# Vuln ID: V-38563
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50364r3_rule
# STIG ID: RHEL-06-000195
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using removexattr.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "removexattr" system call, run the following command:
#
# $ sudo grep -w "removexattr" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S removexattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S removexattr -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S removexattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S removexattr -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
- name: check stig_rhel6_v1r18 v_38563
  set_fact: stig_rhel6_v1r18_results['v_38563'] = 'fail'
  when: '"v_38563" in check_findings'


# Vuln ID: V-38565
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50366r3_rule
# STIG ID: RHEL-06-000196
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using setxattr.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "setxattr" system call, run the following command:
#
# $ sudo grep -w "setxattr" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S setxattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S setxattr -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S setxattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S setxattr -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
- name: check stig_rhel6_v1r18 v_38565
  set_fact: stig_rhel6_v1r18_results['v_38565'] = 'fail'
  when: '"v_38565" in check_findings'


# Vuln ID: V-38566
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50367r2_rule
# STIG ID: RHEL-06-000197
# Rule Title: The audit system must be configured to audit failed attempts to access files and programs.
# Discussion: Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.
# IA Controls:
# Check Content: To verify that the audit system collects unauthorized file accesses, run the following commands:
#
# # grep EACCES /etc/audit/audit.rules
#
#
#
# # grep EPERM /etc/audit/audit.rules
#
#
# If either command lacks output, this is a finding.
# Fix Text: At a minimum, the audit system should collect unauthorized file accesses for all users and root. Add the following to "/etc/audit/audit.rules", setting ARCH to either b32 or b64 as appropriate for your system:
#
# -a always,exit -F arch=ARCH -S creat -S open -S openat -S truncate \
# -S ftruncate -F exit=-EACCES -F auid>=500 -F auid!=4294967295 -k access
# -a always,exit -F arch=ARCH -S creat -S open -S openat -S truncate \
# -S ftruncate -F exit=-EPERM -F auid>=500 -F auid!=4294967295 -k access
# -a always,exit -F arch=ARCH -S creat -S open -S openat -S truncate \
# -S ftruncate -F exit=-EACCES -F auid=0 -k access
# -a always,exit -F arch=ARCH -S creat -S open -S openat -S truncate \
# -S ftruncate -F exit=-EPERM -F auid=0 -k access
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
- name: check stig_rhel6_v1r18 v_38566
  set_fact: stig_rhel6_v1r18_results['v_38566'] = 'fail'
  when: '"v_38566" in check_findings'


# Vuln ID: V-38567
# Severity: low
# Group Title: SRG-OS-000020
# Rule ID: SV-50368r4_rule
# STIG ID: RHEL-06-000198
# Rule Title: The audit system must be configured to audit all use of setuid and setgid programs.
# Discussion: Privileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.
# IA Controls:
# Check Content: To verify that auditing of privileged command use is configured, run the following command once for each local partition [PART] to find relevant setuid / setgid programs:
#
# $ sudo find [PART] -xdev -type f -perm /6000 2>/dev/null
#
# Run the following command to verify entries in the audit rules for all programs found with the previous command:
#
# $ sudo grep path /etc/audit/audit.rules
#
# It should be the case that all relevant setuid / setgid programs have a line in the audit rules. If that is not the case, this is a finding.
# Fix Text: At a minimum, the audit system should collect the execution of privileged commands for all users and root. To find the relevant setuid / setgid programs, run the following command for each local partition [PART]:
#
# $ sudo find [PART] -xdev -type f -perm /6000 2>/dev/null
#
# Then, for each setuid / setgid program on the system, add a line of the following form to "/etc/audit/audit.rules", where [SETUID_PROG_PATH] is the full path to each setuid / setgid program in the list:
#
# -a always,exit -F path=[SETUID_PROG_PATH] -F perm=x -F auid>=500 -F auid!=4294967295 -k privileged
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000040
# The organization audits any use of privileged accounts, or roles, with access to organization defined security functions or security-relevant information, when accessing other system functions.
# NIST SP 800-53 :: AC-6 (2)
# NIST SP 800-53A :: AC-6 (2).1 (iii)
#
#
- name: check stig_rhel6_v1r18 v_38567
  set_fact: stig_rhel6_v1r18_results['v_38567'] = 'fail'
  when: '"v_38567" in check_findings'


# Vuln ID: V-38568
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50369r3_rule
# STIG ID: RHEL-06-000199
# Rule Title: The audit system must be configured to audit successful file system mounts.
# Discussion: The unauthorized exportation of data to external media could result in an information leak where classified information, Privacy Act information, and intellectual property could be lost. An audit trail should be created each time a filesystem is mounted to help identify and guard against information loss.
# IA Controls:
# Check Content: To verify that auditing is configured for all media exportation events, run the following command:
#
# $ sudo grep -w "mount" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect media exportation events for all users and root. Add the following to "/etc/audit/audit.rules", setting ARCH to either b32 or b64 as appropriate for your system:
#
# -a always,exit -F arch=ARCH -S mount -F auid>=500 -F auid!=4294967295 -k export
# -a always,exit -F arch=ARCH -S mount -F auid=0 -k export
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
- name: check stig_rhel6_v1r18 v_38568
  set_fact: stig_rhel6_v1r18_results['v_38568'] = 'fail'
  when: '"v_38568" in check_findings'


# Vuln ID: V-38575
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50376r4_rule
# STIG ID: RHEL-06-000200
# Rule Title: The audit system must be configured to audit user deletions of files and programs.
# Discussion: Auditing file deletions will create an audit trail for files that are removed from the system. The audit trail could aid in system troubleshooting, as well as detecting malicious processes that attempt to delete log files to conceal their presence.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "rmdir" system call, run the following command:
#
# $ sudo grep -w "rmdir" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line. To determine if the system is configured to audit calls to the "unlink" system call, run the following command:
#
# $ sudo grep -w "unlink" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line. To determine if the system is configured to audit calls to the "unlinkat" system call, run the following command:
#
# $ sudo grep -w "unlinkat" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line. To determine if the system is configured to audit calls to the "rename" system call, run the following command:
#
# $ sudo grep -w "rename" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line. To determine if the system is configured to audit calls to the "renameat" system call, run the following command:
#
# $ sudo grep -w "renameat" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file deletion events for all users and root. Add the following (or equivalent) to "/etc/audit/audit.rules", setting ARCH to either b32 or b64 as appropriate for your system:
#
# -a always,exit -F arch=ARCH -S rmdir -S unlink -S unlinkat -S rename -S renameat -F auid>=500 -F auid!=4294967295 -k delete
# -a always,exit -F arch=ARCH -S rmdir -S unlink -S unlinkat -S rename -S renameat -F auid=0 -k delete
#
#
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
- name: check stig_rhel6_v1r18 v_38575
  set_fact: stig_rhel6_v1r18_results['v_38575'] = 'fail'
  when: '"v_38575" in check_findings'


# Vuln ID: V-38578
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50379r2_rule
# STIG ID: RHEL-06-000201
# Rule Title: The audit system must be configured to audit changes to the /etc/sudoers file.
# Discussion: The actions taken by system administrators should be audited to keep a record of what was executed on the system, as well as, for accountability purposes.
# IA Controls:
# Check Content: To verify that auditing is configured for system administrator actions, run the following command:
#
# $ sudo grep -w "/etc/sudoers" /etc/audit/audit.rules
#
# If the system is configured to watch for changes to its sudoers configuration, a line should be returned (including "-p wa" indicating permissions that are watched).
#
# If there is no output, this is a finding.
# Fix Text: At a minimum, the audit system should collect administrator actions for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -w /etc/sudoers -p wa -k actions
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
- name: check stig_rhel6_v1r18 v_38578
  set_fact: stig_rhel6_v1r18_results['v_38578'] = 'fail'
  when: '"v_38578" in check_findings'


# Vuln ID: V-38580
# Severity: medium
# Group Title: SRG-OS-000064
# Rule ID: SV-50381r2_rule
# STIG ID: RHEL-06-000202
# Rule Title: The audit system must be configured to audit the loading and unloading of dynamic kernel modules.
# Discussion: The addition/removal of kernel modules can be used to alter the behavior of the kernel and potentially introduce malicious code into kernel space. It is important to have an audit trail of modules that have been introduced into the kernel.
# IA Controls:
# Check Content: To determine if the system is configured to audit execution of module management programs, run the following commands:
#
# $ sudo egrep -e "(-w |-F path=)/sbin/insmod" /etc/audit/audit.rules
# $ sudo egrep -e "(-w |-F path=)/sbin/rmmod" /etc/audit/audit.rules
# $ sudo egrep -e "(-w |-F path=)/sbin/modprobe" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line.
#
# To determine if the system is configured to audit calls to the "init_module" system call, run the following command:
#
# $ sudo grep -w "init_module" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line.
#
# To determine if the system is configured to audit calls to the "delete_module" system call, run the following command:
#
# $ sudo grep -w "delete_module" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line.
#
# If no line is returned for any of these commands, this is a finding.
# Fix Text: Add the following to "/etc/audit/audit.rules" in order to capture kernel module loading and unloading events, setting ARCH to either b32 or b64 as appropriate for your system:
#
# -w /sbin/insmod -p x -k modules
# -w /sbin/rmmod -p x -k modules
# -w /sbin/modprobe -p x -k modules
# -a always,exit -F arch=[ARCH] -S init_module -S delete_module -k modules
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
- name: check stig_rhel6_v1r18 v_38580
  set_fact: stig_rhel6_v1r18_results['v_38580'] = 'fail'
  when: '"v_38580" in check_findings'
