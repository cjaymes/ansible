# Vuln ID: V-38445
# Severity: medium
# Group Title: SRG-OS-000057
# Rule ID: SV-50245r2_rule
# STIG ID: RHEL-06-000522
# Rule Title: Audit log files must be group-owned by root.
# Discussion: If non-privileged users can write to audit logs, audit trails can be modified or destroyed.
# IA Controls:
# Check Content: Run the following command to check the group owner of the system audit logs:
#
# grep "^log_file" /etc/audit/auditd.conf|sed s/^[^\/]*//|xargs stat -c %G:%n
#
# Audit logs must be group-owned by root.
# If they are not, this is a finding.
# Fix Text: Change the group owner of the audit log files with the following command:
#
# # chgrp root [audit_file]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000162
# The information system protects audit information from unauthorized access.
# NIST SP 800-53 :: AU-9
# NIST SP 800-53A :: AU-9.1
# NIST SP 800-53 Revision 4 :: AU-9
#
#
- name: check stig_rhel6_v1r18 v_38445
  set_fact:
    stig_rhel6_v1r18_results: "{{stig_rhel6_v1r18_results|combine({'v_38445': 'fail'})}}"
  when: '"v_38445" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38464
# Severity: medium
# Group Title: SRG-OS-000047
# Rule ID: SV-50264r1_rule
# STIG ID: RHEL-06-000511
# Rule Title: The audit system must take appropriate action when there are disk errors on the audit storage volume.
# Discussion: Taking appropriate action in case of disk errors will minimize the possibility of losing audit records.
# IA Controls:
# Check Content: Inspect "/etc/audit/auditd.conf" and locate the following line to determine if the system is configured to take appropriate action when disk errors occur:
#
# # grep disk_error_action /etc/audit/auditd.conf
# disk_error_action = [ACTION]
#
#
# If the system is configured to "suspend" when disk errors occur or "ignore" them, this is a finding.
# Fix Text: Edit the file "/etc/audit/auditd.conf". Modify the following line, substituting [ACTION] appropriately:
#
# disk_error_action = [ACTION]
#
# Possible values for [ACTION] are described in the "auditd.conf" man page. These include:
#
# "ignore"
# "syslog"
# "exec"
# "suspend"
# "single"
# "halt"
#
#
# Set this to "syslog", "exec", "single", or "halt".
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000140
# The information system takes organization-defined actions upon audit failure (e.g., shut down information system, overwrite oldest audit records, stop generating audit records).
# NIST SP 800-53 :: AU-5 b
# NIST SP 800-53A :: AU-5.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-5 b
#
#
- name: check stig_rhel6_v1r18 v_38464
  set_fact:
    stig_rhel6_v1r18_results: "{{stig_rhel6_v1r18_results|combine({'v_38464': 'fail'})}}"
  when: '"v_38464" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38468
# Severity: medium
# Group Title: SRG-OS-000047
# Rule ID: SV-50268r1_rule
# STIG ID: RHEL-06-000510
# Rule Title: The audit system must take appropriate action when the audit storage volume is full.
# Discussion: Taking appropriate action in case of a filled audit storage volume will minimize the possibility of losing audit records.
# IA Controls:
# Check Content: Inspect "/etc/audit/auditd.conf" and locate the following line to determine if the system is configured to take appropriate action when the audit storage volume is full:
#
# # grep disk_full_action /etc/audit/auditd.conf
# disk_full_action = [ACTION]
#
#
# If the system is configured to "suspend" when the volume is full or "ignore" that it is full, this is a finding.
# Fix Text: The "auditd" service can be configured to take an action when disk space starts to run low. Edit the file "/etc/audit/auditd.conf". Modify the following line, substituting [ACTION] appropriately:
#
# disk_full_action = [ACTION]
#
# Possible values for [ACTION] are described in the "auditd.conf" man page. These include:
#
# "ignore"
# "syslog"
# "exec"
# "suspend"
# "single"
# "halt"
#
#
# Set this to "syslog", "exec", "single", or "halt".
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000140
# The information system takes organization-defined actions upon audit failure (e.g., shut down information system, overwrite oldest audit records, stop generating audit records).
# NIST SP 800-53 :: AU-5 b
# NIST SP 800-53A :: AU-5.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-5 b
#
#
- name: check stig_rhel6_v1r18 v_38468
  set_fact:
    stig_rhel6_v1r18_results: "{{stig_rhel6_v1r18_results|combine({'v_38468': 'fail'})}}"
  when: '"v_38468" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38470
# Severity: medium
# Group Title: SRG-OS-000045
# Rule ID: SV-50270r2_rule
# STIG ID: RHEL-06-000005
# Rule Title: The audit system must alert designated staff members when the audit storage volume approaches capacity.
# Discussion: Notifying administrators of an impending disk space problem may allow them to take corrective action prior to any disruption.
# IA Controls:
# Check Content: Inspect "/etc/audit/auditd.conf" and locate the following line to determine if the system is configured to email the administrator when disk space is starting to run low:
#
# # grep space_left_action /etc/audit/auditd.conf
# space_left_action = email
#
#
# If the system is not configured to send an email to the system administrator when disk space is starting to run low, this is a finding.  The "syslog" option is acceptable when it can be demonstrated that the local log management infrastructure notifies an appropriate administrator in a timely manner.
# Fix Text: The "auditd" service can be configured to take an action when disk space starts to run low. Edit the file "/etc/audit/auditd.conf". Modify the following line, substituting [ACTION] appropriately:
#
# space_left_action = [ACTION]
#
# Possible values for [ACTION] are described in the "auditd.conf" man page. These include:
#
# "ignore"
# "syslog"
# "email"
# "exec"
# "suspend"
# "single"
# "halt"
#
#
# Set this to "email" (instead of the default, which is "suspend") as it is more likely to get prompt attention.  The "syslog" option is acceptable, provided the local log management infrastructure notifies an appropriate administrator in a timely manner.
#
# RHEL-06-000521 ensures that the email generated through the operation "space_left_action" will be sent to an administrator.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# Classification: Unclass
# VMS Asset Posture:
#  CCI: CCI-000138
# The organization configures auditing to reduce the likelihood of storage capacity being exceeded.
# NIST SP 800-53 :: AU-4
# NIST SP 800-53A :: AU-4.1 (ii)
#
#
- name: check stig_rhel6_v1r18 v_38470
  set_fact:
    stig_rhel6_v1r18_results: "{{stig_rhel6_v1r18_results|combine({'v_38470': 'fail'})}}"
  when: '"v_38470" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38493
# Severity: medium
# Group Title: SRG-OS-000059
# Rule ID: SV-50294r1_rule
# STIG ID: RHEL-06-000385
# Rule Title: Audit log directories must have mode 0755 or less permissive.
# Discussion: If users can delete audit logs, audit trails can be modified or destroyed.
# IA Controls:
# Check Content: Run the following command to check the mode of the system audit directories:
#
# grep "^log_file" /etc/audit/auditd.conf|sed 's/^[^/]*//; s/[^/]*$//'|xargs stat -c %a:%n
#
# Audit directories must be mode 0755 or less permissive.
# If any are more permissive, this is a finding.
# Fix Text: Change the mode of the audit log directories with the following command:
#
# # chmod go-w [audit_directory]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000164
# The information system protects audit information from unauthorized deletion.
# NIST SP 800-53 :: AU-9
# NIST SP 800-53A :: AU-9.1
# NIST SP 800-53 Revision 4 :: AU-9
#
#
- name: check stig_rhel6_v1r18 v_38493
  set_fact:
    stig_rhel6_v1r18_results: "{{stig_rhel6_v1r18_results|combine({'v_38493': 'fail'})}}"
  when: '"v_38493" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38495
# Severity: medium
# Group Title: SRG-OS-000057
# Rule ID: SV-50296r1_rule
# STIG ID: RHEL-06-000384
# Rule Title: Audit log files must be owned by root.
# Discussion: If non-privileged users can write to audit logs, audit trails can be modified or destroyed.
# IA Controls:
# Check Content: Run the following command to check the owner of the system audit logs:
#
# grep "^log_file" /etc/audit/auditd.conf|sed s/^[^\/]*//|xargs stat -c %U:%n
#
# Audit logs must be owned by root.
# If they are not, this is a finding.
# Fix Text: Change the owner of the audit log files with the following command:
#
# # chown root [audit_file]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000162
# The information system protects audit information from unauthorized access.
# NIST SP 800-53 :: AU-9
# NIST SP 800-53A :: AU-9.1
# NIST SP 800-53 Revision 4 :: AU-9
#
#
- name: check stig_rhel6_v1r18 v_38495
  set_fact:
    stig_rhel6_v1r18_results: "{{stig_rhel6_v1r18_results|combine({'v_38495': 'fail'})}}"
  when: '"v_38495" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38498
# Severity: medium
# Group Title: SRG-OS-000058
# Rule ID: SV-50299r1_rule
# STIG ID: RHEL-06-000383
# Rule Title: Audit log files must have mode 0640 or less permissive.
# Discussion: If users can write to audit logs, audit trails can be modified or destroyed.
# IA Controls:
# Check Content: Run the following command to check the mode of the system audit logs:
#
# grep "^log_file" /etc/audit/auditd.conf|sed s/^[^\/]*//|xargs stat -c %a:%n
#
# Audit logs must be mode 0640 or less permissive.
# If any are more permissive, this is a finding.
# Fix Text: Change the mode of the audit log files with the following command:
#
# # chmod 0640 [audit_file]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000163
# The information system protects audit information from unauthorized modification.
# NIST SP 800-53 :: AU-9
# NIST SP 800-53A :: AU-9.1
# NIST SP 800-53 Revision 4 :: AU-9
#
#
- name: check stig_rhel6_v1r18 v_38498
  set_fact:
    stig_rhel6_v1r18_results: "{{stig_rhel6_v1r18_results|combine({'v_38498': 'fail'})}}"
  when: '"v_38498" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38628
# Severity: medium
# Group Title: SRG-OS-000255
# Rule ID: SV-50429r2_rule
# STIG ID: RHEL-06-000145
# Rule Title: The operating system must produce audit records containing sufficient information to establish the identity of any user/subject associated with the event.
# Discussion: Ensuring the "auditd" service is active ensures audit records generated by the kernel can be written to disk, or that appropriate actions will be taken if other obstacles exist.
# IA Controls:
# Check Content: Run the following command to determine the current status of the "auditd" service:
#
# # service auditd status
#
# If the service is enabled, it should return the following:
#
# auditd is running...
#
#
# If the service is not running, this is a finding.
# Fix Text: The "auditd" service is an essential userspace component of the Linux Auditing System, as it is responsible for writing audit records to disk. The "auditd" service can be enabled with the following commands:
#
# # chkconfig auditd on
# # service auditd start
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001487
# The information system generates audit records containing information that establishes the identity of any individuals or subjects associated with the event.
# NIST SP 800-53 :: AU-3
# NIST SP 800-53A :: AU-3.1
# NIST SP 800-53 Revision 4 :: AU-3
#
#
- name: check stig_rhel6_v1r18 v_38628
  set_fact:
    stig_rhel6_v1r18_results: "{{stig_rhel6_v1r18_results|combine({'v_38628': 'fail'})}}"
  when: '"v_38628" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38631
# Severity: medium
# Group Title: SRG-OS-000032
# Rule ID: SV-50432r2_rule
# STIG ID: RHEL-06-000148
# Rule Title: The operating system must employ automated mechanisms to facilitate the monitoring and control of remote access methods.
# Discussion: Ensuring the "auditd" service is active ensures audit records generated by the kernel can be written to disk, or that appropriate actions will be taken if other obstacles exist.
# IA Controls:
# Check Content: Run the following command to determine the current status of the "auditd" service:
#
# # service auditd status
#
# If the service is enabled, it should return the following:
#
# auditd is running...
#
#
# If the service is not running, this is a finding.
# Fix Text: The "auditd" service is an essential userspace component of the Linux Auditing System, as it is responsible for writing audit records to disk. The "auditd" service can be enabled with the following commands:
#
# # chkconfig auditd on
# # service auditd start
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000067
# The information system monitors remote access methods.
# NIST SP 800-53 :: AC-17 (1)
# NIST SP 800-53A :: AC-17 (1).1
# NIST SP 800-53 Revision 4 :: AC-17 (1)
#
#
- name: check stig_rhel6_v1r18 v_38631
  set_fact:
    stig_rhel6_v1r18_results: "{{stig_rhel6_v1r18_results|combine({'v_38631': 'fail'})}}"
  when: '"v_38631" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38632
# Severity: medium
# Group Title: SRG-OS-000037
# Rule ID: SV-50433r2_rule
# STIG ID: RHEL-06-000154
# Rule Title: The operating system must produce audit records containing sufficient information to establish what type of events occurred.
# Discussion: Ensuring the "auditd" service is active ensures audit records generated by the kernel can be written to disk, or that appropriate actions will be taken if other obstacles exist.
# IA Controls:
# Check Content: Run the following command to determine the current status of the "auditd" service:
#
# # service auditd status
#
# If the service is enabled, it should return the following:
#
# auditd is running...
#
#
# If the service is not running, this is a finding.
# Fix Text: The "auditd" service is an essential userspace component of the Linux Auditing System, as it is responsible for writing audit records to disk. The "auditd" service can be enabled with the following commands:
#
# # chkconfig auditd on
# # service auditd start
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000130
# The information system generates audit records containing information that establishes what type of event occurred.
# NIST SP 800-53 :: AU-3
# NIST SP 800-53A :: AU-3.1
# NIST SP 800-53 Revision 4 :: AU-3
#
#
- name: check stig_rhel6_v1r18 v_38632
  set_fact:
    stig_rhel6_v1r18_results: "{{stig_rhel6_v1r18_results|combine({'v_38632': 'fail'})}}"
  when: '"v_38632" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38633
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50434r1_rule
# STIG ID: RHEL-06-000160
# Rule Title: The system must set a maximum audit log file size.
# Discussion: The total storage for audit log files must be large enough to retain log information over the period required. This is a function of the maximum log file size and the number of logs retained.
# IA Controls:
# Check Content: Inspect "/etc/audit/auditd.conf" and locate the following line to determine how much data the system will retain in each audit log file: "# grep max_log_file /etc/audit/auditd.conf"
#
# max_log_file = 6
#
#
# If the system audit data threshold hasn't been properly set up, this is a finding.
# Fix Text: Determine the amount of audit data (in megabytes) which should be retained in each log file. Edit the file "/etc/audit/auditd.conf". Add or modify the following line, substituting the correct value for [STOREMB]:
#
# max_log_file = [STOREMB]
#
# Set the value to "6" (MB) or higher for general-purpose systems. Larger values, of course, support retention of even more audit data.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38633
  set_fact:
    stig_rhel6_v1r18_results: "{{stig_rhel6_v1r18_results|combine({'v_38633': 'fail'})}}"
  when: '"v_38633" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38634
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50435r2_rule
# STIG ID: RHEL-06-000161
# Rule Title: The system must rotate audit log files that reach the maximum file size.
# Discussion: Automatically rotating logs (by setting this to "rotate") minimizes the chances of the system unexpectedly running out of disk space by being overwhelmed with log data. However, for systems that must never discard log data, or which use external processes to transfer it and reclaim space, "keep_logs" can be employed.
# IA Controls:
# Check Content: Inspect "/etc/audit/auditd.conf" and locate the following line to determine if the system is configured to rotate logs when they reach their maximum size:
#
# # grep max_log_file_action /etc/audit/auditd.conf
# max_log_file_action = rotate
#
# If the "keep_logs" option is configured for the "max_log_file_action" line in "/etc/audit/auditd.conf" and an alternate process is in place to ensure audit data does not overwhelm local audit storage, this is not a finding.
#
# If the system has not been properly set up to rotate audit logs, this is a finding.
# Fix Text: The default action to take when the logs reach their maximum size is to rotate the log files, discarding the oldest one. To configure the action taken by "auditd", add or correct the line in "/etc/audit/auditd.conf":
#
# max_log_file_action = [ACTION]
#
# Possible values for [ACTION] are described in the "auditd.conf" man page. These include:
#
# "ignore"
# "syslog"
# "suspend"
# "rotate"
# "keep_logs"
#
#
# Set the "[ACTION]" to "rotate" to ensure log rotation occurs. This is the default. The setting is case-insensitive.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38634
  set_fact:
    stig_rhel6_v1r18_results: "{{stig_rhel6_v1r18_results|combine({'v_38634': 'fail'})}}"
  when: '"v_38634" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38636
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50437r1_rule
# STIG ID: RHEL-06-000159
# Rule Title: The system must retain enough rotated audit logs to cover the required log retention period.
# Discussion: The total storage for audit log files must be large enough to retain log information over the period required. This is a function of the maximum log file size and the number of logs retained.
# IA Controls:
# Check Content: Inspect "/etc/audit/auditd.conf" and locate the following line to determine how many logs the system is configured to retain after rotation: "# grep num_logs /etc/audit/auditd.conf"
#
# num_logs = 5
#
#
# If the overall system log file(s) retention hasn't been properly set up, this is a finding.
# Fix Text: Determine how many log files "auditd" should retain when it rotates logs. Edit the file "/etc/audit/auditd.conf". Add or modify the following line, substituting [NUMLOGS] with the correct value:
#
# num_logs = [NUMLOGS]
#
# Set the value to 5 for general-purpose systems. Note that values less than 2 result in no log rotation.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38636
  set_fact:
    stig_rhel6_v1r18_results: "{{stig_rhel6_v1r18_results|combine({'v_38636': 'fail'})}}"
  when: '"v_38636" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38637
# Severity: medium
# Group Title: SRG-OS-000278
# Rule ID: SV-50438r2_rule
# STIG ID: RHEL-06-000281
# Rule Title: The system package management tool must verify contents of all files associated with the audit package.
# Discussion: The hash on important files like audit system executables should match the information given by the RPM database. Audit executables  with erroneous hashes could be a sign of nefarious activity on the system.
# IA Controls:
# Check Content: The following command will list which audit files on the system have file hashes different from what is expected by the RPM database.
#
# # rpm -V audit | awk '$1 ~ /..5/ && $2 != "c"'
#
#
# If there is output, this is a finding.
# Fix Text: The RPM package management system can check the hashes of audit system package files. Run the following command to list which audit files on the system have hashes that differ from what is expected by the RPM database:
#
# # rpm -V audit | grep '^..5'
#
# A "c" in the second column indicates that a file is a configuration file, which may appropriately be expected to change. If the file that has changed was not expected to then refresh from distribution media or online repositories.
#
# rpm -Uvh [affected_package]
#
# OR
#
# yum reinstall [affected_package]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001496
# The information system implements cryptographic mechanisms to protect the integrity of audit tools.
# NIST SP 800-53 :: AU-9 (3)
# NIST SP 800-53A :: AU-9 (3).1
# NIST SP 800-53 Revision 4 :: AU-9 (3)
#
#
- name: check stig_rhel6_v1r18 v_38637
  set_fact:
    stig_rhel6_v1r18_results: "{{stig_rhel6_v1r18_results|combine({'v_38637': 'fail'})}}"
  when: '"v_38637" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38663
# Severity: medium
# Group Title: SRG-OS-000256
# Rule ID: SV-50464r1_rule
# STIG ID: RHEL-06-000278
# Rule Title: The system package management tool must verify permissions on all files and directories associated with the audit package.
# Discussion: Permissions on audit binaries and configuration files that are too generous could allow an unauthorized user to gain privileges that they should not have. The permissions set by the vendor should be maintained. Any deviations from this baseline should be investigated.
# IA Controls:
# Check Content: The following command will list which audit files on the system have permissions different from what is expected by the RPM database:
#
# # rpm -V audit | grep '^.M'
#
# If there is any output, for each file or directory found, compare the RPM-expected permissions with the permissions on the file or directory:
#
# # rpm -q --queryformat "[%{FILENAMES} %{FILEMODES:perms}\n]" audit | grep  [filename]
# # ls -lL [filename]
#
# If the existing permissions are more permissive than those expected by RPM, this is a finding.
# Fix Text: The RPM package management system can restore file access permissions of the audit package files and directories. The following command will update audit files with permissions different from what is expected by the RPM database:
#
# # rpm --setperms audit
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001493
# The information system protects audit tools from unauthorized access.
# NIST SP 800-53 :: AU-9
# NIST SP 800-53A :: AU-9.1
# NIST SP 800-53 Revision 4 :: AU-9
#
#
- name: check stig_rhel6_v1r18 v_38663
  set_fact:
    stig_rhel6_v1r18_results: "{{stig_rhel6_v1r18_results|combine({'v_38663': 'fail'})}}"
  when: '"v_38663" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38664
# Severity: medium
# Group Title: SRG-OS-000257
# Rule ID: SV-50465r1_rule
# STIG ID: RHEL-06-000279
# Rule Title: The system package management tool must verify ownership on all files and directories associated with the audit package.
# Discussion: Ownership of audit binaries and configuration files that is incorrect could allow an unauthorized user to gain privileges that they should not have. The ownership set by the vendor should be maintained. Any deviations from this baseline should be investigated.
# IA Controls:
# Check Content: The following command will list which audit files on the system have ownership different from what is expected by the RPM database:
#
# # rpm -V audit | grep '^.....U'
#
#
# If there is output, this is a finding.
# Fix Text: The RPM package management system can restore file ownership of the audit package files and directories. The following command will update audit files with ownership different from what is expected by the RPM database:
#
# # rpm --setugids audit
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001494
# The information system protects audit tools from unauthorized modification.
# NIST SP 800-53 :: AU-9
# NIST SP 800-53A :: AU-9.1
# NIST SP 800-53 Revision 4 :: AU-9
#
#
- name: check stig_rhel6_v1r18 v_38664
  set_fact:
    stig_rhel6_v1r18_results: "{{stig_rhel6_v1r18_results|combine({'v_38664': 'fail'})}}"
  when: '"v_38664" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38665
# Severity: medium
# Group Title: SRG-OS-000258
# Rule ID: SV-50466r1_rule
# STIG ID: RHEL-06-000280
# Rule Title: The system package management tool must verify group-ownership on all files and directories associated with the audit package.
# Discussion: Group-ownership of audit binaries and configuration files that is incorrect could allow an unauthorized user to gain privileges that they should not have. The group-ownership set by the vendor should be maintained. Any deviations from this baseline should be investigated.
# IA Controls:
# Check Content: The following command will list which audit files on the system have group-ownership different from what is expected by the RPM database:
#
# # rpm -V audit | grep '^......G'
#
#
# If there is output, this is a finding.
# Fix Text: The RPM package management system can restore file group-ownership of the audit package files and directories. The following command will update audit files with group-ownership different from what is expected by the RPM database:
#
# # rpm --setugids audit
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001495
# The information system protects audit tools from unauthorized deletion.
# NIST SP 800-53 :: AU-9
# NIST SP 800-53A :: AU-9.1
# NIST SP 800-53 Revision 4 :: AU-9
#
#
- name: check stig_rhel6_v1r18 v_38665
  set_fact:
    stig_rhel6_v1r18_results: "{{stig_rhel6_v1r18_results|combine({'v_38665': 'fail'})}}"
  when: '"v_38665" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38678
# Severity: medium
# Group Title: SRG-OS-000048
# Rule ID: SV-50479r2_rule
# STIG ID: RHEL-06-000311
# Rule Title: The audit system must provide a warning when allocated audit record storage volume reaches a documented percentage of maximum audit record storage capacity.
# Discussion: Notifying administrators of an impending disk space problem may allow them to take corrective action prior to any disruption.
# IA Controls:
# Check Content: Inspect "/etc/audit/auditd.conf" and locate the following line to determine whether the system is configured to email the administrator when disk space is starting to run low:
#
# # grep space_left /etc/audit/auditd.conf
#
# space_left = [num_megabytes]
#
#
# If the "num_megabytes" value does not correspond to a documented value for remaining audit partition capacity or if there is no locally documented value for remaining audit partition capacity, this is a finding.
# Fix Text: The "auditd" service can be configured to take an action when disk space starts to run low. Edit the file "/etc/audit/auditd.conf". Modify the following line, substituting [num_megabytes] appropriately:
#
# space_left = [num_megabytes]
#
# The "num_megabytes" value should be set to a fraction of the total audit storage capacity available that will allow a system administrator to be notified with enough time to respond to the situation causing the capacity issues.  This value must also be documented locally.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000143
# The information system provides a warning when allocated audit record storage volume reaches an organization defined percentage of maximum audit record storage capacity.
# NIST SP 800-53 :: AU-5 (1)
# NIST SP 800-53A :: AU-5 (1).1 (ii)
#
#
- name: check stig_rhel6_v1r18 v_38678
  set_fact:
    stig_rhel6_v1r18_results: "{{stig_rhel6_v1r18_results|combine({'v_38678': 'fail'})}}"
  when: '"v_38678" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38680
# Severity: medium
# Group Title: SRG-OS-000046
# Rule ID: SV-50481r1_rule
# STIG ID: RHEL-06-000313
# Rule Title: The audit system must identify staff members to receive notifications of audit log storage volume capacity issues.
# Discussion: Email sent to the root account is typically aliased to the administrators of the system, who can take appropriate action.
# IA Controls:
# Check Content: Inspect "/etc/audit/auditd.conf" and locate the following line to determine if the system is configured to send email to an account when it needs to notify an administrator:
#
# action_mail_acct = root
#
#
# If auditd is not configured to send emails per identified actions, this is a finding.
# Fix Text: The "auditd" service can be configured to send email to a designated account in certain situations. Add or correct the following line in "/etc/audit/auditd.conf" to ensure that administrators are notified via email for those situations:
#
# action_mail_acct = root
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000139
# The information system alerts designated organization-defined personnel or roles in the event of an audit processing failure.
# NIST SP 800-53 :: AU-5 a
# NIST SP 800-53A :: AU-5.1 (ii)
# NIST SP 800-53 Revision 4 :: AU-5 a
#
#
- name: check stig_rhel6_v1r18 v_38680
  set_fact:
    stig_rhel6_v1r18_results: "{{stig_rhel6_v1r18_results|combine({'v_38680': 'fail'})}}"
  when: '"v_38680" in stig_rhel6_v1r18_checks'


# Vuln ID: V-54381
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-68627r3_rule
# STIG ID: RHEL-06-000163
# Rule Title: The audit system must switch the system to single-user mode when available audit storage volume becomes dangerously low.
# Discussion: Administrators should be made aware of an inability to record audit records. If a separate partition or logical volume of adequate size is used, running low on space for audit records should never occur.
# IA Controls:
# Check Content: Inspect "/etc/audit/auditd.conf" and locate the following line to determine if the system is configured to either suspend, switch to single-user mode, or halt when disk space has run low:
#
# admin_space_left_action = single
#
# If the system is not configured to switch to single-user mode, suspend, or halt for corrective action, this is a finding.
# Fix Text: The "auditd" service can be configured to take an action when disk space is running low but prior to running out of space completely. Edit the file "/etc/audit/auditd.conf". Add or modify the following line, substituting [ACTION] appropriately:
#
# admin_space_left_action = [ACTION]
#
# Set this value to "single" to cause the system to switch to single-user mode for corrective action. Acceptable values also include "suspend" and "halt". For certain systems, the need for availability outweighs the need to log all actions, and a different setting should be determined. Details regarding all possible values for [ACTION] are described in the "auditd.conf" man page.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_54381
  set_fact:
    stig_rhel6_v1r18_results: "{{stig_rhel6_v1r18_results|combine({'v_54381': 'fail'})}}"
  when: '"v_54381" in stig_rhel6_v1r18_checks'
