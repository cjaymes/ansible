# Vuln ID: V-38511
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50312r2_rule
# STIG ID: RHEL-06-000082
# Rule Title: IP forwarding for IPv4 must not be enabled, unless the system is a router.
# Discussion: IP forwarding permits the kernel to forward packets from one network interface to another. The ability to forward packets between two networks is only appropriate for systems acting as routers.
# IA Controls:
# Check Content: The status of the "net.ipv4.ip_forward" kernel parameter can be queried by running the following command:
#
# $ sysctl net.ipv4.ip_forward
#
# The output of the command should indicate a value of "0". If this value is not the default value, investigate how it could have been adjusted at runtime, and verify it is not set improperly in "/etc/sysctl.conf".
#
# $ grep net.ipv4.ip_forward /etc/sysctl.conf
#
# The ability to forward packets is only appropriate for routers. If the correct value is not returned, this is a finding.
# Fix Text: To set the runtime status of the "net.ipv4.ip_forward" kernel parameter, run the following command:
#
# # sysctl -w net.ipv4.ip_forward=0
#
# If this is not the system's default value, add the following line to "/etc/sysctl.conf":
#
# net.ipv4.ip_forward = 0
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38511
  set_fact: stig_rhel6_v1r18_results['v_38511'] = 'fail'
  when: '"v_38511" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38523
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50324r2_rule
# STIG ID: RHEL-06-000083
# Rule Title: The system must not accept IPv4 source-routed packets on any interface.
# Discussion: Accepting source-routed packets in the IPv4 protocol has few legitimate uses. It should be disabled unless it is absolutely required.
# IA Controls:
# Check Content: The status of the "net.ipv4.conf.all.accept_source_route" kernel parameter can be queried by running the following command:
#
# $ sysctl net.ipv4.conf.all.accept_source_route
#
# The output of the command should indicate a value of "0". If this value is not the default value, investigate how it could have been adjusted at runtime, and verify it is not set improperly in "/etc/sysctl.conf".
#
# $ grep net.ipv4.conf.all.accept_source_route /etc/sysctl.conf
#
# If the correct value is not returned, this is a finding.
# Fix Text: To set the runtime status of the "net.ipv4.conf.all.accept_source_route" kernel parameter, run the following command:
#
# # sysctl -w net.ipv4.conf.all.accept_source_route=0
#
# If this is not the system's default value, add the following line to "/etc/sysctl.conf":
#
# net.ipv4.conf.all.accept_source_route = 0
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38523
  set_fact: stig_rhel6_v1r18_results['v_38523'] = 'fail'
  when: '"v_38523" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38524
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50325r2_rule
# STIG ID: RHEL-06-000084
# Rule Title: The system must not accept ICMPv4 redirect packets on any interface.
# Discussion: Accepting ICMP redirects has few legitimate uses. It should be disabled unless it is absolutely required.
# IA Controls:
# Check Content: The status of the "net.ipv4.conf.all.accept_redirects" kernel parameter can be queried by running the following command:
#
# $ sysctl net.ipv4.conf.all.accept_redirects
#
# The output of the command should indicate a value of "0". If this value is not the default value, investigate how it could have been adjusted at runtime, and verify it is not set improperly in "/etc/sysctl.conf".
#
# $ grep net.ipv4.conf.all.accept_redirects /etc/sysctl.conf
#
# If the correct value is not returned, this is a finding.
# Fix Text: To set the runtime status of the "net.ipv4.conf.all.accept_redirects" kernel parameter, run the following command:
#
# # sysctl -w net.ipv4.conf.all.accept_redirects=0
#
# If this is not the system's default value, add the following line to "/etc/sysctl.conf":
#
# net.ipv4.conf.all.accept_redirects = 0
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38524
  set_fact: stig_rhel6_v1r18_results['v_38524'] = 'fail'
  when: '"v_38524" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38526
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50327r2_rule
# STIG ID: RHEL-06-000086
# Rule Title: The system must not accept ICMPv4 secure redirect packets on any interface.
# Discussion: Accepting "secure" ICMP redirects (from those gateways listed as default gateways) has few legitimate uses. It should be disabled unless it is absolutely required.
# IA Controls:
# Check Content: The status of the "net.ipv4.conf.all.secure_redirects" kernel parameter can be queried by running the following command:
#
# $ sysctl net.ipv4.conf.all.secure_redirects
#
# The output of the command should indicate a value of "0". If this value is not the default value, investigate how it could have been adjusted at runtime, and verify it is not set improperly in "/etc/sysctl.conf".
#
# $ grep net.ipv4.conf.all.secure_redirects /etc/sysctl.conf
#
# If the correct value is not returned, this is a finding.
# Fix Text: To set the runtime status of the "net.ipv4.conf.all.secure_redirects" kernel parameter, run the following command:
#
# # sysctl -w net.ipv4.conf.all.secure_redirects=0
#
# If this is not the system's default value, add the following line to "/etc/sysctl.conf":
#
# net.ipv4.conf.all.secure_redirects = 0
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38526
  set_fact: stig_rhel6_v1r18_results['v_38526'] = 'fail'
  when: '"v_38526" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38528
# Severity: low
# Group Title: SRG-OS-999999
# Rule ID: SV-50329r2_rule
# STIG ID: RHEL-06-000088
# Rule Title: The system must log Martian packets.
# Discussion: The presence of "martian" packets (which have impossible addresses) as well as spoofed packets, source-routed packets, and redirects could be a sign of nefarious network activity. Logging these packets enables this activity to be detected.
# IA Controls:
# Check Content: The status of the "net.ipv4.conf.all.log_martians" kernel parameter can be queried by running the following command:
#
# $ sysctl net.ipv4.conf.all.log_martians
#
# The output of the command should indicate a value of "1". If this value is not the default value, investigate how it could have been adjusted at runtime, and verify it is not set improperly in "/etc/sysctl.conf".
#
# $ grep net.ipv4.conf.all.log_martians /etc/sysctl.conf
#
# If the correct value is not returned, this is a finding.
# Fix Text: To set the runtime status of the "net.ipv4.conf.all.log_martians" kernel parameter, run the following command:
#
# # sysctl -w net.ipv4.conf.all.log_martians=1
#
# If this is not the system's default value, add the following line to "/etc/sysctl.conf":
#
# net.ipv4.conf.all.log_martians = 1
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38528
  set_fact: stig_rhel6_v1r18_results['v_38528'] = 'fail'
  when: '"v_38528" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38529
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50330r2_rule
# STIG ID: RHEL-06-000089
# Rule Title: The system must not accept IPv4 source-routed packets by default.
# Discussion: Accepting source-routed packets in the IPv4 protocol has few legitimate uses. It should be disabled unless it is absolutely required.
# IA Controls:
# Check Content: The status of the "net.ipv4.conf.default.accept_source_route" kernel parameter can be queried by running the following command:
#
# $ sysctl net.ipv4.conf.default.accept_source_route
#
# The output of the command should indicate a value of "0". If this value is not the default value, investigate how it could have been adjusted at runtime, and verify it is not set improperly in "/etc/sysctl.conf".
#
# $ grep net.ipv4.conf.default.accept_source_route /etc/sysctl.conf
#
# If the correct value is not returned, this is a finding.
# Fix Text: To set the runtime status of the "net.ipv4.conf.default.accept_source_route" kernel parameter, run the following command:
#
# # sysctl -w net.ipv4.conf.default.accept_source_route=0
#
# If this is not the system's default value, add the following line to "/etc/sysctl.conf":
#
# net.ipv4.conf.default.accept_source_route = 0
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38529
  set_fact: stig_rhel6_v1r18_results['v_38529'] = 'fail'
  when: '"v_38529" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38532
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50333r2_rule
# STIG ID: RHEL-06-000090
# Rule Title: The system must not accept ICMPv4 secure redirect packets by default.
# Discussion: Accepting "secure" ICMP redirects (from those gateways listed as default gateways) has few legitimate uses. It should be disabled unless it is absolutely required.
# IA Controls:
# Check Content: The status of the "net.ipv4.conf.default.secure_redirects" kernel parameter can be queried by running the following command:
#
# $ sysctl net.ipv4.conf.default.secure_redirects
#
# The output of the command should indicate a value of "0". If this value is not the default value, investigate how it could have been adjusted at runtime, and verify it is not set improperly in "/etc/sysctl.conf".
#
# $ grep net.ipv4.conf.default.secure_redirects /etc/sysctl.conf
#
# If the correct value is not returned, this is a finding.
# Fix Text: To set the runtime status of the "net.ipv4.conf.default.secure_redirects" kernel parameter, run the following command:
#
# # sysctl -w net.ipv4.conf.default.secure_redirects=0
#
# If this is not the system's default value, add the following line to "/etc/sysctl.conf":
#
# net.ipv4.conf.default.secure_redirects = 0
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38532
  set_fact: stig_rhel6_v1r18_results['v_38532'] = 'fail'
  when: '"v_38532" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38533
# Severity: low
# Group Title: SRG-OS-999999
# Rule ID: SV-50334r3_rule
# STIG ID: RHEL-06-000091
# Rule Title: The system must ignore ICMPv4 redirect messages by default.
# Discussion: This feature of the IPv4 protocol has few legitimate uses. It should be disabled unless it is absolutely required.
# IA Controls:
# Check Content: The status of the "net.ipv4.conf.default.accept_redirects" kernel parameter can be queried by running the following command:
#
# $ sysctl net.ipv4.conf.default.accept_redirects
#
# The output of the command should indicate a value of "0". If this value is not the default value, investigate how it could have been adjusted at runtime, and verify it is not set improperly in "/etc/sysctl.conf".
#
# $ grep net.ipv4.conf.default.accept_redirects /etc/sysctl.conf
#
# If the correct value is not returned, this is a finding.
# Fix Text: To set the runtime status of the "net.ipv4.conf.default.accept_redirects" kernel parameter, run the following command:
#
# # sysctl -w net.ipv4.conf.default.accept_redirects=0
#
# If this is not the system's default value, add the following line to "/etc/sysctl.conf":
#
# net.ipv4.conf.default.accept_redirects = 0
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38533
  set_fact: stig_rhel6_v1r18_results['v_38533'] = 'fail'
  when: '"v_38533" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38535
# Severity: low
# Group Title: SRG-OS-999999
# Rule ID: SV-50336r2_rule
# STIG ID: RHEL-06-000092
# Rule Title: The system must not respond to ICMPv4 sent to a broadcast address.
# Discussion: Ignoring ICMP echo requests (pings) sent to broadcast or multicast addresses makes the system slightly more difficult to enumerate on the network.
# IA Controls:
# Check Content: The status of the "net.ipv4.icmp_echo_ignore_broadcasts" kernel parameter can be queried by running the following command:
#
# $ sysctl net.ipv4.icmp_echo_ignore_broadcasts
#
# The output of the command should indicate a value of "1". If this value is not the default value, investigate how it could have been adjusted at runtime, and verify it is not set improperly in "/etc/sysctl.conf".
#
# $ grep net.ipv4.icmp_echo_ignore_broadcasts /etc/sysctl.conf
#
# If the correct value is not returned, this is a finding.
# Fix Text: To set the runtime status of the "net.ipv4.icmp_echo_ignore_broadcasts" kernel parameter, run the following command:
#
# # sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1
#
# If this is not the system's default value, add the following line to "/etc/sysctl.conf":
#
# net.ipv4.icmp_echo_ignore_broadcasts = 1
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38535
  set_fact: stig_rhel6_v1r18_results['v_38535'] = 'fail'
  when: '"v_38535" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38537
# Severity: low
# Group Title: SRG-OS-999999
# Rule ID: SV-50338r2_rule
# STIG ID: RHEL-06-000093
# Rule Title: The system must ignore ICMPv4 bogus error responses.
# Discussion: Ignoring bogus ICMP error responses reduces log size, although some activity would not be logged.
# IA Controls:
# Check Content: The status of the "net.ipv4.icmp_ignore_bogus_error_responses" kernel parameter can be queried by running the following command:
#
# $ sysctl net.ipv4.icmp_ignore_bogus_error_responses
#
# The output of the command should indicate a value of "1". If this value is not the default value, investigate how it could have been adjusted at runtime, and verify it is not set improperly in "/etc/sysctl.conf".
#
# $ grep net.ipv4.icmp_ignore_bogus_error_responses /etc/sysctl.conf
#
# If the correct value is not returned, this is a finding.
# Fix Text: To set the runtime status of the "net.ipv4.icmp_ignore_bogus_error_responses" kernel parameter, run the following command:
#
# # sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1
#
# If this is not the system's default value, add the following line to "/etc/sysctl.conf":
#
# net.ipv4.icmp_ignore_bogus_error_responses = 1
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38537
  set_fact: stig_rhel6_v1r18_results['v_38537'] = 'fail'
  when: '"v_38537" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38539
# Severity: medium
# Group Title: SRG-OS-000142
# Rule ID: SV-50340r2_rule
# STIG ID: RHEL-06-000095
# Rule Title: The system must be configured to use TCP syncookies when experiencing a TCP SYN flood.
# Discussion: A TCP SYN flood attack can cause a denial of service by filling a system's TCP connection table with connections in the SYN_RCVD state. Syncookies can be used to track a connection when a subsequent ACK is received, verifying the initiator is attempting a valid connection and is not a flood source. This feature is activated when a flood condition is detected, and enables the system to continue servicing valid connection requests.
# IA Controls:
# Check Content: The status of the "net.ipv4.tcp_syncookies" kernel parameter can be queried by running the following command:
#
# $ sysctl net.ipv4.tcp_syncookies
#
# The output of the command should indicate a value of "1". If this value is not the default value, investigate how it could have been adjusted at runtime, and verify it is not set improperly in "/etc/sysctl.conf".
#
# $ grep net.ipv4.tcp_syncookies /etc/sysctl.conf
#
# If the correct value is not returned, this is a finding.
# Fix Text: To set the runtime status of the "net.ipv4.tcp_syncookies" kernel parameter, run the following command:
#
# # sysctl -w net.ipv4.tcp_syncookies=1
#
# If this is not the system's default value, add the following line to "/etc/sysctl.conf":
#
# net.ipv4.tcp_syncookies = 1
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001095
# The information system manages excess capacity, bandwidth, or other redundancy to limit the effects of information flooding types of denial of service attacks.
# NIST SP 800-53 :: SC-5 (2)
# NIST SP 800-53A :: SC-5 (2).1
# NIST SP 800-53 Revision 4 :: SC-5 (2)
#
#
- name: check stig_rhel6_v1r18 v_38539
  set_fact: stig_rhel6_v1r18_results['v_38539'] = 'fail'
  when: '"v_38539" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38542
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50343r2_rule
# STIG ID: RHEL-06-000096
# Rule Title: The system must use a reverse-path filter for IPv4 network traffic when possible on all interfaces.
# Discussion: Enabling reverse path filtering drops packets with source addresses that should not have been able to be received on the interface they were received on. It should not be used on systems which are routers for complicated networks, but is helpful for end hosts and routers serving small networks.
# IA Controls:
# Check Content: The status of the "net.ipv4.conf.all.rp_filter" kernel parameter can be queried by running the following command:
#
# $ sysctl net.ipv4.conf.all.rp_filter
#
# The output of the command should indicate a value of "1". If this value is not the default value, investigate how it could have been adjusted at runtime, and verify it is not set improperly in "/etc/sysctl.conf".
#
# $ grep net.ipv4.conf.all.rp_filter /etc/sysctl.conf
#
# If the correct value is not returned, this is a finding.
# Fix Text: To set the runtime status of the "net.ipv4.conf.all.rp_filter" kernel parameter, run the following command:
#
# # sysctl -w net.ipv4.conf.all.rp_filter=1
#
# If this is not the system's default value, add the following line to "/etc/sysctl.conf":
#
# net.ipv4.conf.all.rp_filter = 1
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38542
  set_fact: stig_rhel6_v1r18_results['v_38542'] = 'fail'
  when: '"v_38542" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38544
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50345r2_rule
# STIG ID: RHEL-06-000097
# Rule Title: The system must use a reverse-path filter for IPv4 network traffic when possible by default.
# Discussion: Enabling reverse path filtering drops packets with source addresses that should not have been able to be received on the interface they were received on. It should not be used on systems which are routers for complicated networks, but is helpful for end hosts and routers serving small networks.
# IA Controls:
# Check Content: The status of the "net.ipv4.conf.default.rp_filter" kernel parameter can be queried by running the following command:
#
# $ sysctl net.ipv4.conf.default.rp_filter
#
# The output of the command should indicate a value of "1". If this value is not the default value, investigate how it could have been adjusted at runtime, and verify it is not set improperly in "/etc/sysctl.conf".
#
# $ grep net.ipv4.conf.default.rp_filter /etc/sysctl.conf
#
# If the correct value is not returned, this is a finding.
# Fix Text: To set the runtime status of the "net.ipv4.conf.default.rp_filter" kernel parameter, run the following command:
#
# # sysctl -w net.ipv4.conf.default.rp_filter=1
#
# If this is not the system's default value, add the following line to "/etc/sysctl.conf":
#
# net.ipv4.conf.default.rp_filter = 1
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38544
  set_fact: stig_rhel6_v1r18_results['v_38544'] = 'fail'
  when: '"v_38544" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38548
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50349r3_rule
# STIG ID: RHEL-06-000099
# Rule Title: The system must ignore ICMPv6 redirects by default.
# Discussion: An illicit ICMP redirect message could result in a man-in-the-middle attack.
# IA Controls:
# Check Content: If IPv6 is disabled, this is not applicable.
#
# The status of the "net.ipv6.conf.default.accept_redirects" kernel parameter can be queried by running the following command:
#
# $ sysctl net.ipv6.conf.default.accept_redirects
#
# The output of the command should indicate a value of "0". If this value is not the default value, investigate how it could have been adjusted at runtime, and verify it is not set improperly in "/etc/sysctl.conf".
#
# $ grep net.ipv6.conf.default.accept_redirects /etc/sysctl.conf
#
# If the correct value is not returned, this is a finding.
# Fix Text: To set the runtime status of the "net.ipv6.conf.default.accept_redirects" kernel parameter, run the following command:
#
# # sysctl -w net.ipv6.conf.default.accept_redirects=0
#
# If this is not the system's default value, add the following line to "/etc/sysctl.conf":
#
# net.ipv6.conf.default.accept_redirects = 0
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38548
  set_fact: stig_rhel6_v1r18_results['v_38548'] = 'fail'
  when: '"v_38548" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38600
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50401r2_rule
# STIG ID: RHEL-06-000080
# Rule Title: The system must not send ICMPv4 redirects by default.
# Discussion: Sending ICMP redirects permits the system to instruct other systems to update their routing information. The ability to send ICMP redirects is only appropriate for systems acting as routers.
# IA Controls:
# Check Content: The status of the "net.ipv4.conf.default.send_redirects" kernel parameter can be queried by running the following command:
#
# $ sysctl net.ipv4.conf.default.send_redirects
#
# The output of the command should indicate a value of "0". If this value is not the default value, investigate how it could have been adjusted at runtime, and verify it is not set improperly in "/etc/sysctl.conf".
#
# $ grep net.ipv4.conf.default.send_redirects /etc/sysctl.conf
#
# If the correct value is not returned, this is a finding.
# Fix Text: To set the runtime status of the "net.ipv4.conf.default.send_redirects" kernel parameter, run the following command:
#
# # sysctl -w net.ipv4.conf.default.send_redirects=0
#
# If this is not the system's default value, add the following line to "/etc/sysctl.conf":
#
# net.ipv4.conf.default.send_redirects = 0
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38600
  set_fact: stig_rhel6_v1r18_results['v_38600'] = 'fail'
  when: '"v_38600" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38601
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50402r2_rule
# STIG ID: RHEL-06-000081
# Rule Title: The system must not send ICMPv4 redirects from any interface.
# Discussion: Sending ICMP redirects permits the system to instruct other systems to update their routing information. The ability to send ICMP redirects is only appropriate for systems acting as routers.
# IA Controls:
# Check Content: The status of the "net.ipv4.conf.all.send_redirects" kernel parameter can be queried by running the following command:
#
# $ sysctl net.ipv4.conf.all.send_redirects
#
# The output of the command should indicate a value of "0". If this value is not the default value, investigate how it could have been adjusted at runtime, and verify it is not set improperly in "/etc/sysctl.conf".
#
# $ grep net.ipv4.conf.all.send_redirects /etc/sysctl.conf
#
# If the correct value is not returned, this is a finding.
# Fix Text: To set the runtime status of the "net.ipv4.conf.all.send_redirects" kernel parameter, run the following command:
#
# # sysctl -w net.ipv4.conf.all.send_redirects=0
#
# If this is not the system's default value, add the following line to "/etc/sysctl.conf":
#
# net.ipv4.conf.all.send_redirects = 0
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38601
  set_fact: stig_rhel6_v1r18_results['v_38601'] = 'fail'
  when: '"v_38601" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38679
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50480r3_rule
# STIG ID: RHEL-06-000292
# Rule Title: The DHCP client must be disabled if not needed.
# Discussion: DHCP relies on trusting the local network. If the local network is not trusted, then it should not be used. However, the automatic configuration provided by DHCP is commonly used and the alternative, manual configuration, presents an unacceptable burden in many circumstances.
# IA Controls:
# Check Content: If DHCP is required by the organization, this is Not Applicable.
#
# For each interface [IFACE] on the system (e.g. eth0), verify that DHCP is not being used:
#
# # cat /etc/sysconfig/network-scripts/ifcfg-[IFACE] | grep -i “bootproto” | grep –v “#”
#
# BOOTPROTO=none
#
# If no output is returned this is a finding.
# If BOOTPROTO is not set to ”none”, this is a finding.
#
# Fix Text: For each interface [IFACE] on the system (e.g. eth0), edit "/etc/sysconfig/network-scripts/ifcfg-[IFACE]" and make the following changes.
#
# Correct the BOOTPROTO line to read:
#
# BOOTPROTO=none
#
#
# Add or correct the following lines, substituting the appropriate values based on your site's addressing scheme:
#
# NETMASK=[local LAN netmask]
# IPADDR=[assigned IP address]
# GATEWAY=[local LAN default gateway]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38679
  set_fact: stig_rhel6_v1r18_results['v_38679'] = 'fail'
  when: '"v_38679" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38687
# Severity: low
# Group Title: SRG-OS-000160
# Rule ID: SV-50488r3_rule
# STIG ID: RHEL-06-000321
# Rule Title: The system must provide VPN connectivity for communications over untrusted networks.
# Discussion: Providing the ability for remote users or systems to initiate a secure VPN connection protects information when it is transmitted over a wide area network.
# IA Controls:
# Check Content: If the system does not communicate over untrusted networks, this is not applicable.
#
# Run the following command to determine if the "libreswan" package is installed:
#
# # rpm -q libreswan
#
# If the package is not installed, this is a finding.
# Fix Text: The “libreswan” package provides an implementation of IPsec and IKE, which permits the creation of secure tunnels over untrusted networks. The "libreswan" package can be installed with the following command:
#
# # yum install libreswan
#
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001130
# The information system protects the confidentiality of transmitted information.
# NIST SP 800-53 :: SC-9
# NIST SP 800-53A :: SC-9.1
#
#
- name: check stig_rhel6_v1r18 v_38687
  set_fact: stig_rhel6_v1r18_results['v_38687'] = 'fail'
  when: '"v_38687" in stig_rhel6_v1r18_checks'


# Vuln ID: V-72817
# Severity: medium
# Group Title: RHEL-06-000293
# Rule ID: SV-87461r1_rule
# STIG ID: RHEL-06-000293
# Rule Title: Wireless network adapters must be disabled.
# Discussion: The use of wireless networking can introduce many different attack vectors into the organization’s network. Common attack vectors such as malicious association and ad hoc networks will allow an attacker to spoof a wireless access point (AP), allowing validated systems to connect to the malicious AP and enabling the attacker to monitor and record network traffic. These malicious APs can also serve to create a man-in-the-middle attack or be used to create a denial of service to valid network resources.
# IA Controls:
# Check Content: This is N/A for systems that do not have wireless network adapters.
#
# Verify that there are no wireless interfaces configured on the system:
#
# # ifconfig -a
#
#
# eth0      Link encap:Ethernet  HWaddr b8:ac:6f:65:31:e5
#           inet addr:192.168.2.100  Bcast:192.168.2.255  Mask:255.255.255.0
#           inet6 addr: fe80::baac:6fff:fe65:31e5/64 Scope:Link
#           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
#           RX packets:2697529 errors:0 dropped:0 overruns:0 frame:0
#           TX packets:2630541 errors:0 dropped:0 overruns:0 carrier:0
#           collisions:0 txqueuelen:1000
#           RX bytes:2159382827 (2.0 GiB)  TX bytes:1389552776 (1.2 GiB)
#           Interrupt:17
#
# lo        Link encap:Local Loopback
#           inet addr:127.0.0.1  Mask:255.0.0.0
#           inet6 addr: ::1/128 Scope:Host
#           UP LOOPBACK RUNNING  MTU:16436  Metric:1
#           RX packets:2849 errors:0 dropped:0 overruns:0 frame:0
#           TX packets:2849 errors:0 dropped:0 overruns:0 carrier:0
#           collisions:0 txqueuelen:0
#           RX bytes:2778290 (2.6 MiB)  TX bytes:2778290 (2.6 MiB)
#
#
# If a wireless interface is configured, it must be documented and approved by the local Authorizing Official.
#
# If a wireless interface is configured and has not been documented and approved, this is a finding.
#
# Fix Text: Configure the system to disable all wireless network interfaces.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001443
# The information system protects wireless access to the system using authentication of users and/or devices.
# NIST SP 800-53 :: AC-18 (1)
# NIST SP 800-53A :: AC-18 (1).1
# NIST SP 800-53 Revision 4 :: AC-18 (1)
#
# CCI-001444
# The information system protects wireless access to the system using encryption.
# NIST SP 800-53 :: AC-18 (1)
# NIST SP 800-53A :: AC-18 (1).1
# NIST SP 800-53 Revision 4 :: AC-18 (1)
#
# CCI-002418
# The information system protects the confidentiality and/or integrity of transmitted information.
# NIST SP 800-53 Revision 4 :: SC-8
#
#
- name: check stig_rhel6_v1r18 v_72817
  set_fact: stig_rhel6_v1r18_results['v_72817'] = 'fail'
  when: '"v_72817" in stig_rhel6_v1r18_checks'
