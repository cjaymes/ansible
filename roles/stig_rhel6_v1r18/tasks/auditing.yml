# Vuln ID: V-38445
# Severity: medium
# Group Title: SRG-OS-000057
# Rule ID: SV-50245r2_rule
# STIG ID: RHEL-06-000522
# Rule Title: Audit log files must be group-owned by root.
# Discussion: If non-privileged users can write to audit logs, audit trails can be modified or destroyed.
# IA Controls:
# Check Content: Run the following command to check the group owner of the system audit logs:
#
# grep "^log_file" /etc/audit/auditd.conf|sed s/^[^\/]*//|xargs stat -c %G:%n
#
# Audit logs must be group-owned by root.
# If they are not, this is a finding.
# Fix Text: Change the group owner of the audit log files with the following command:
#
# # chgrp root [audit_file]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000162
# The information system protects audit information from unauthorized access.
# NIST SP 800-53 :: AU-9
# NIST SP 800-53A :: AU-9.1
# NIST SP 800-53 Revision 4 :: AU-9
#
#
# - name: fail stig_rhel6_v1r18 v_38445
#   set_fact:
#     stig_rhel6_v1r18_v_38445_result: 'fail'
#   when:
#     - "'v_38445' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38445_result != 'pass'


# Vuln ID: V-38464
# Severity: medium
# Group Title: SRG-OS-000047
# Rule ID: SV-50264r1_rule
# STIG ID: RHEL-06-000511
# Rule Title: The audit system must take appropriate action when there are disk errors on the audit storage volume.
# Discussion: Taking appropriate action in case of disk errors will minimize the possibility of losing audit records.
# IA Controls:
# Check Content: Inspect "/etc/audit/auditd.conf" and locate the following line to determine if the system is configured to take appropriate action when disk errors occur:
#
# # grep disk_error_action /etc/audit/auditd.conf
# disk_error_action = [ACTION]
#
#
# If the system is configured to "suspend" when disk errors occur or "ignore" them, this is a finding.
# Fix Text: Edit the file "/etc/audit/auditd.conf". Modify the following line, substituting [ACTION] appropriately:
#
# disk_error_action = [ACTION]
#
# Possible values for [ACTION] are described in the "auditd.conf" man page. These include:
#
# "ignore"
# "syslog"
# "exec"
# "suspend"
# "single"
# "halt"
#
#
# Set this to "syslog", "exec", "single", or "halt".
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000140
# The information system takes organization-defined actions upon audit failure (e.g., shut down information system, overwrite oldest audit records, stop generating audit records).
# NIST SP 800-53 :: AU-5 b
# NIST SP 800-53A :: AU-5.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-5 b
#
#
# - name: fail stig_rhel6_v1r18 v_38464
#   set_fact:
#     stig_rhel6_v1r18_v_38464_result: 'fail'
#   when:
#     - "'v_38464' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38464_result != 'pass'


# Vuln ID: V-38468
# Severity: medium
# Group Title: SRG-OS-000047
# Rule ID: SV-50268r1_rule
# STIG ID: RHEL-06-000510
# Rule Title: The audit system must take appropriate action when the audit storage volume is full.
# Discussion: Taking appropriate action in case of a filled audit storage volume will minimize the possibility of losing audit records.
# IA Controls:
# Check Content: Inspect "/etc/audit/auditd.conf" and locate the following line to determine if the system is configured to take appropriate action when the audit storage volume is full:
#
# # grep disk_full_action /etc/audit/auditd.conf
# disk_full_action = [ACTION]
#
#
# If the system is configured to "suspend" when the volume is full or "ignore" that it is full, this is a finding.
# Fix Text: The "auditd" service can be configured to take an action when disk space starts to run low. Edit the file "/etc/audit/auditd.conf". Modify the following line, substituting [ACTION] appropriately:
#
# disk_full_action = [ACTION]
#
# Possible values for [ACTION] are described in the "auditd.conf" man page. These include:
#
# "ignore"
# "syslog"
# "exec"
# "suspend"
# "single"
# "halt"
#
#
# Set this to "syslog", "exec", "single", or "halt".
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000140
# The information system takes organization-defined actions upon audit failure (e.g., shut down information system, overwrite oldest audit records, stop generating audit records).
# NIST SP 800-53 :: AU-5 b
# NIST SP 800-53A :: AU-5.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-5 b
#
#
# - name: fail stig_rhel6_v1r18 v_38468
#   set_fact:
#     stig_rhel6_v1r18_v_38468_result: 'fail'
#   when:
#     - "'v_38468' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38468_result != 'pass'


# Vuln ID: V-38470
# Severity: medium
# Group Title: SRG-OS-000045
# Rule ID: SV-50270r2_rule
# STIG ID: RHEL-06-000005
# Rule Title: The audit system must alert designated staff members when the audit storage volume approaches capacity.
# Discussion: Notifying administrators of an impending disk space problem may allow them to take corrective action prior to any disruption.
# IA Controls:
# Check Content: Inspect "/etc/audit/auditd.conf" and locate the following line to determine if the system is configured to email the administrator when disk space is starting to run low:
#
# # grep space_left_action /etc/audit/auditd.conf
# space_left_action = email
#
#
# If the system is not configured to send an email to the system administrator when disk space is starting to run low, this is a finding.  The "syslog" option is acceptable when it can be demonstrated that the local log management infrastructure notifies an appropriate administrator in a timely manner.
# Fix Text: The "auditd" service can be configured to take an action when disk space starts to run low. Edit the file "/etc/audit/auditd.conf". Modify the following line, substituting [ACTION] appropriately:
#
# space_left_action = [ACTION]
#
# Possible values for [ACTION] are described in the "auditd.conf" man page. These include:
#
# "ignore"
# "syslog"
# "email"
# "exec"
# "suspend"
# "single"
# "halt"
#
#
# Set this to "email" (instead of the default, which is "suspend") as it is more likely to get prompt attention.  The "syslog" option is acceptable, provided the local log management infrastructure notifies an appropriate administrator in a timely manner.
#
# RHEL-06-000521 ensures that the email generated through the operation "space_left_action" will be sent to an administrator.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# Classification: Unclass
# VMS Asset Posture:
#  CCI: CCI-000138
# The organization configures auditing to reduce the likelihood of storage capacity being exceeded.
# NIST SP 800-53 :: AU-4
# NIST SP 800-53A :: AU-4.1 (ii)
#
#
# - name: fail stig_rhel6_v1r18 v_38470
#   set_fact:
#     stig_rhel6_v1r18_v_38470_result: 'fail'
#   when:
#     - "'v_38470' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38470_result != 'pass'


# Vuln ID: V-38471
# Severity: low
# Group Title: SRG-OS-000043
# Rule ID: SV-50271r1_rule
# STIG ID: RHEL-06-000509
# Rule Title: The system must forward audit records to the syslog service.
# Discussion: The auditd service does not include the ability to send audit records to a centralized server for management directly.  It does, however, include an audit event multiplexor plugin (audispd) to pass audit records to the local syslog server.
# IA Controls:
# Check Content: Verify the audispd plugin is active:
#
# # grep active /etc/audisp/plugins.d/syslog.conf
#
# If the "active" setting is missing or set to "no", this is a finding.
# Fix Text: Set the "active" line in "/etc/audisp/plugins.d/syslog.conf" to "yes".  Restart the auditd process.
#
# # service auditd restart
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000136
# The organization centrally manages the content of audit records generated by organization defined information system components.
# NIST SP 800-53 :: AU-3 (2)
# NIST SP 800-53A :: AU-3 (2).1 (ii)
#
#
# - name: fail stig_rhel6_v1r18 v_38471
#   set_fact:
#     stig_rhel6_v1r18_v_38471_result: 'fail'
#   when:
#     - "'v_38471' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38471_result != 'pass'


# Vuln ID: V-38493
# Severity: medium
# Group Title: SRG-OS-000059
# Rule ID: SV-50294r1_rule
# STIG ID: RHEL-06-000385
# Rule Title: Audit log directories must have mode 0755 or less permissive.
# Discussion: If users can delete audit logs, audit trails can be modified or destroyed.
# IA Controls:
# Check Content: Run the following command to check the mode of the system audit directories:
#
# grep "^log_file" /etc/audit/auditd.conf|sed 's/^[^/]*//; s/[^/]*$//'|xargs stat -c %a:%n
#
# Audit directories must be mode 0755 or less permissive.
# If any are more permissive, this is a finding.
# Fix Text: Change the mode of the audit log directories with the following command:
#
# # chmod go-w [audit_directory]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000164
# The information system protects audit information from unauthorized deletion.
# NIST SP 800-53 :: AU-9
# NIST SP 800-53A :: AU-9.1
# NIST SP 800-53 Revision 4 :: AU-9
#
#
# - name: fail stig_rhel6_v1r18 v_38493
#   set_fact:
#     stig_rhel6_v1r18_v_38493_result: 'fail'
#   when:
#     - "'v_38493' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38493_result != 'pass'


# Vuln ID: V-38495
# Severity: medium
# Group Title: SRG-OS-000057
# Rule ID: SV-50296r1_rule
# STIG ID: RHEL-06-000384
# Rule Title: Audit log files must be owned by root.
# Discussion: If non-privileged users can write to audit logs, audit trails can be modified or destroyed.
# IA Controls:
# Check Content: Run the following command to check the owner of the system audit logs:
#
# grep "^log_file" /etc/audit/auditd.conf|sed s/^[^\/]*//|xargs stat -c %U:%n
#
# Audit logs must be owned by root.
# If they are not, this is a finding.
# Fix Text: Change the owner of the audit log files with the following command:
#
# # chown root [audit_file]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000162
# The information system protects audit information from unauthorized access.
# NIST SP 800-53 :: AU-9
# NIST SP 800-53A :: AU-9.1
# NIST SP 800-53 Revision 4 :: AU-9
#
#
# - name: fail stig_rhel6_v1r18 v_38495
#   set_fact:
#     stig_rhel6_v1r18_v_38495_result: 'fail'
#   when:
#     - "'v_38495' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38495_result != 'pass'


# Vuln ID: V-38498
# Severity: medium
# Group Title: SRG-OS-000058
# Rule ID: SV-50299r1_rule
# STIG ID: RHEL-06-000383
# Rule Title: Audit log files must have mode 0640 or less permissive.
# Discussion: If users can write to audit logs, audit trails can be modified or destroyed.
# IA Controls:
# Check Content: Run the following command to check the mode of the system audit logs:
#
# grep "^log_file" /etc/audit/auditd.conf|sed s/^[^\/]*//|xargs stat -c %a:%n
#
# Audit logs must be mode 0640 or less permissive.
# If any are more permissive, this is a finding.
# Fix Text: Change the mode of the audit log files with the following command:
#
# # chmod 0640 [audit_file]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000163
# The information system protects audit information from unauthorized modification.
# NIST SP 800-53 :: AU-9
# NIST SP 800-53A :: AU-9.1
# NIST SP 800-53 Revision 4 :: AU-9
#
#
# - name: fail stig_rhel6_v1r18 v_38498
#   set_fact:
#     stig_rhel6_v1r18_v_38498_result: 'fail'
#   when:
#     - "'v_38498' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38498_result != 'pass'


# Vuln ID: V-38522
# Severity: low
# Group Title: SRG-OS-000062
# Rule ID: SV-50323r3_rule
# STIG ID: RHEL-06-000167
# Rule Title: The audit system must be configured to audit all attempts to alter system time through settimeofday.
# Discussion: Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "settimeofday" system call, run the following command:
#
# $ sudo grep -w "settimeofday" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line.
#
# If the system is not configured to audit time changes, this is a finding.
# Fix Text: On a 32-bit system, add the following to "/etc/audit/audit.rules":
#
# # audit_time_rules
# -a always,exit -F arch=b32 -S settimeofday -k audit_time_rules
#
# On a 64-bit system, add the following to "/etc/audit/audit.rules":
#
# # audit_time_rules
# -a always,exit -F arch=b64 -S settimeofday -k audit_time_rules
#
# The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport. Multiple system calls can be defined on the same line to save space if desired, but is not required. See an example of multiple combined syscalls:
#
# -a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -k audit_time_rules
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000169
# The information system provides audit record generation capability for the auditable events defined in AU-2 a at organization-defined information system components.
# NIST SP 800-53 :: AU-12 a
# NIST SP 800-53A :: AU-12.1 (ii)
# NIST SP 800-53 Revision 4 :: AU-12 a
#
#
# - name: fail stig_rhel6_v1r18 v_38522
#   set_fact:
#     stig_rhel6_v1r18_v_38522_result: 'fail'
#   when:
#     - "'v_38522' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38522_result != 'pass'


# Vuln ID: V-38525
# Severity: low
# Group Title: SRG-OS-000062
# Rule ID: SV-50326r4_rule
# STIG ID: RHEL-06-000169
# Rule Title: The audit system must be configured to audit all attempts to alter system time through stime.
# Discussion: Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.
# IA Controls:
# Check Content: If the system is 64-bit only, this is not applicable.
#
# To determine if the system is configured to audit calls to the "stime" system call, run the following command:
#
# $ sudo grep -w "stime" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line.
#
# If the system is not configured to audit time changes, this is a finding.
# Fix Text: On a 32-bit system, add the following to "/etc/audit/audit.rules":
#
# # audit_time_rules
# -a always,exit -F arch=b32 -S stime -k audit_time_rules
#
# On a 64-bit system, the "-S stime" is not necessary. The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport. Multiple system calls can be defined on the same line to save space if desired, but is not required. See an example of multiple combined syscalls:
#
# -a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -k audit_time_rules
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000169
# The information system provides audit record generation capability for the auditable events defined in AU-2 a at organization-defined information system components.
# NIST SP 800-53 :: AU-12 a
# NIST SP 800-53A :: AU-12.1 (ii)
# NIST SP 800-53 Revision 4 :: AU-12 a
#
#
# - name: fail stig_rhel6_v1r18 v_38525
#   set_fact:
#     stig_rhel6_v1r18_v_38525_result: 'fail'
#   when:
#     - "'v_38525' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38525_result != 'pass'


# Vuln ID: V-38527
# Severity: low
# Group Title: SRG-OS-000062
# Rule ID: SV-50328r3_rule
# STIG ID: RHEL-06-000171
# Rule Title: The audit system must be configured to audit all attempts to alter system time through clock_settime.
# Discussion: Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "clock_settime" system call, run the following command:
#
# $ sudo grep -w "clock_settime" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line.
#
# If the system is not configured to audit time changes, this is a finding.
# Fix Text: On a 32-bit system, add the following to "/etc/audit/audit.rules":
#
# # audit_time_rules
# -a always,exit -F arch=b32 -S clock_settime -k audit_time_rules
#
# On a 64-bit system, add the following to "/etc/audit/audit.rules":
#
# # audit_time_rules
# -a always,exit -F arch=b64 -S clock_settime -k audit_time_rules
#
# The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport. Multiple system calls can be defined on the same line to save space if desired, but is not required. See an example of multiple combined syscalls:
#
# -a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -k audit_time_rules
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000169
# The information system provides audit record generation capability for the auditable events defined in AU-2 a at organization-defined information system components.
# NIST SP 800-53 :: AU-12 a
# NIST SP 800-53A :: AU-12.1 (ii)
# NIST SP 800-53 Revision 4 :: AU-12 a
#
#
# - name: fail stig_rhel6_v1r18 v_38527
#   set_fact:
#     stig_rhel6_v1r18_v_38527_result: 'fail'
#   when:
#     - "'v_38527' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38527_result != 'pass'


# Vuln ID: V-38530
# Severity: low
# Group Title: SRG-OS-000062
# Rule ID: SV-50331r2_rule
# STIG ID: RHEL-06-000173
# Rule Title: The audit system must be configured to audit all attempts to alter system time through /etc/localtime.
# Discussion: Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.
# IA Controls:
# Check Content: To determine if the system is configured to audit attempts to alter time via the /etc/localtime file, run the following command:
#
# $ sudo grep -w "/etc/localtime" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line.
#
# If the system is not configured to audit time changes, this is a finding.
# Fix Text: Add the following to "/etc/audit/audit.rules":
#
# -w /etc/localtime -p wa -k audit_time_rules
#
# The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport and should always be used.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000169
# The information system provides audit record generation capability for the auditable events defined in AU-2 a at organization-defined information system components.
# NIST SP 800-53 :: AU-12 a
# NIST SP 800-53A :: AU-12.1 (ii)
# NIST SP 800-53 Revision 4 :: AU-12 a
#
#
# - name: fail stig_rhel6_v1r18 v_38530
#   set_fact:
#     stig_rhel6_v1r18_v_38530_result: 'fail'
#   when:
#     - "'v_38530' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38530_result != 'pass'


# Vuln ID: V-38531
# Severity: low
# Group Title: SRG-OS-000004
# Rule ID: SV-50332r2_rule
# STIG ID: RHEL-06-000174
# Rule Title: The operating system must automatically audit account creation.
# Discussion: In addition to auditing new user and group accounts, these watches will alert the system administrator(s) to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.
# IA Controls:
# Check Content: To determine if the system is configured to audit account changes, run the following command:
#
# $ sudo egrep -w '(/etc/passwd|/etc/shadow|/etc/group|/etc/gshadow|/etc/security/opasswd)' /etc/audit/audit.rules
#
# If the system is configured to watch for account changes, lines should be returned for each file specified (and with "-p wa" for each).
#
# If the system is not configured to audit account changes, this is a finding.
# Fix Text: Add the following to "/etc/audit/audit.rules", in order to capture events that modify account changes:
#
# # audit_account_changes
# -w /etc/group -p wa -k audit_account_changes
# -w /etc/passwd -p wa -k audit_account_changes
# -w /etc/gshadow -p wa -k audit_account_changes
# -w /etc/shadow -p wa -k audit_account_changes
# -w /etc/security/opasswd -p wa -k audit_account_changes
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000018
# The information system automatically audits account creation actions.
# NIST SP 800-53 :: AC-2 (4)
# NIST SP 800-53A :: AC-2 (4).1 (i&ii)
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
#
# - name: fail stig_rhel6_v1r18 v_38531
#   set_fact:
#     stig_rhel6_v1r18_v_38531_result: 'fail'
#   when:
#     - "'v_38531' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38531_result != 'pass'


# Vuln ID: V-38534
# Severity: low
# Group Title: SRG-OS-000239
# Rule ID: SV-50335r2_rule
# STIG ID: RHEL-06-000175
# Rule Title: The operating system must automatically audit account modification.
# Discussion: In addition to auditing new user and group accounts, these watches will alert the system administrator(s) to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.
# IA Controls:
# Check Content: To determine if the system is configured to audit account changes, run the following command:
#
# $sudo egrep -w '(/etc/passwd|/etc/shadow|/etc/group|/etc/gshadow|/etc/security/opasswd)' /etc/audit/audit.rules
#
# If the system is configured to watch for account changes, lines should be returned for each file specified (and with "-p wa" for each).
#
# If the system is not configured to audit account changes, this is a finding.
# Fix Text: Add the following to "/etc/audit/audit.rules", in order to capture events that modify account changes:
#
# # audit_account_changes
# -w /etc/group -p wa -k audit_account_changes
# -w /etc/passwd -p wa -k audit_account_changes
# -w /etc/gshadow -p wa -k audit_account_changes
# -w /etc/shadow -p wa -k audit_account_changes
# -w /etc/security/opasswd -p wa -k audit_account_changes
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001403
# The information system automatically audits account modification actions.
# NIST SP 800-53 :: AC-2 (4)
# NIST SP 800-53A :: AC-2 (4).1 (i&ii)
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
#
# - name: fail stig_rhel6_v1r18 v_38534
#   set_fact:
#     stig_rhel6_v1r18_v_38534_result: 'fail'
#   when:
#     - "'v_38534' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38534_result != 'pass'


# Vuln ID: V-38536
# Severity: low
# Group Title: SRG-OS-000240
# Rule ID: SV-50337r2_rule
# STIG ID: RHEL-06-000176
# Rule Title: The operating system must automatically audit account disabling actions.
# Discussion: In addition to auditing new user and group accounts, these watches will alert the system administrator(s) to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.
# IA Controls:
# Check Content: To determine if the system is configured to audit account changes, run the following command:
#
# $sudo egrep -w '(/etc/passwd|/etc/shadow|/etc/group|/etc/gshadow|/etc/security/opasswd)' /etc/audit/audit.rules
#
# If the system is configured to watch for account changes, lines should be returned for each file specified (and with "-p wa" for each).
#
# If the system is not configured to audit account changes, this is a finding.
# Fix Text: Add the following to "/etc/audit/audit.rules", in order to capture events that modify account changes:
#
# # audit_account_changes
# -w /etc/group -p wa -k audit_account_changes
# -w /etc/passwd -p wa -k audit_account_changes
# -w /etc/gshadow -p wa -k audit_account_changes
# -w /etc/shadow -p wa -k audit_account_changes
# -w /etc/security/opasswd -p wa -k audit_account_changes
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001404
# The information system automatically audits account disabling actions.
# NIST SP 800-53 :: AC-2 (4)
# NIST SP 800-53A :: AC-2 (4).1 (i&ii)
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
#
# - name: fail stig_rhel6_v1r18 v_38536
#   set_fact:
#     stig_rhel6_v1r18_v_38536_result: 'fail'
#   when:
#     - "'v_38536' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38536_result != 'pass'


# Vuln ID: V-38538
# Severity: low
# Group Title: SRG-OS-000241
# Rule ID: SV-50339r2_rule
# STIG ID: RHEL-06-000177
# Rule Title: The operating system must automatically audit account termination.
# Discussion: In addition to auditing new user and group accounts, these watches will alert the system administrator(s) to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.
# IA Controls:
# Check Content: To determine if the system is configured to audit account changes, run the following command:
#
# $sudo egrep -w '(/etc/passwd|/etc/shadow|/etc/group|/etc/gshadow|/etc/security/opasswd)' /etc/audit/audit.rules
#
# If the system is configured to watch for account changes, lines should be returned for each file specified (and with "-p wa" for each).
#
# If the system is not configured to audit account changes, this is a finding.
# Fix Text: Add the following to "/etc/audit/audit.rules", in order to capture events that modify account changes:
#
# # audit_account_changes
# -w /etc/group -p wa -k audit_account_changes
# -w /etc/passwd -p wa -k audit_account_changes
# -w /etc/gshadow -p wa -k audit_account_changes
# -w /etc/shadow -p wa -k audit_account_changes
# -w /etc/security/opasswd -p wa -k audit_account_changes
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001405
# The information system automatically audits account removal actions.
# NIST SP 800-53 :: AC-2 (4)
# NIST SP 800-53A :: AC-2 (4).1 (i&ii)
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
#
# - name: fail stig_rhel6_v1r18 v_38538
#   set_fact:
#     stig_rhel6_v1r18_v_38538_result: 'fail'
#   when:
#     - "'v_38538' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38538_result != 'pass'


# Vuln ID: V-38540
# Severity: low
# Group Title: SRG-OS-999999
# Rule ID: SV-50341r4_rule
# STIG ID: RHEL-06-000182
# Rule Title: The audit system must be configured to audit modifications to the systems network configuration.
# Discussion: The network environment should not be modified by anything other than administrator action. Any change to network parameters should be audited.
# IA Controls:
# Check Content: If you are running x86_64 architecture, determine the values for sethostname:
# $ uname -m; ausyscall i386 sethostname; ausyscall x86_64 sethostname
#
# If the values returned are not identical verify that the system is configured to monitor network configuration changes for the i386 and x86_64 architectures:
#
# $ sudo egrep -w '(sethostname|setdomainname|/etc/issue|/etc/issue.net|/etc/hosts|/etc/sysconfig/network)' /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S sethostname -S setdomainname -k audit_network_modifications
# -w /etc/issue -p wa -k audit_network_modifications
# -w /etc/issue.net -p wa -k audit_network_modifications
# -w /etc/hosts -p wa -k audit_network_modifications
# -w /etc/sysconfig/network -p wa -k audit_network_modifications
#
# -a always,exit -F arch=b64 -S sethostname -S setdomainname -k audit_network_modifications
# -w /etc/issue -p wa -k audit_network_modifications
# -w /etc/issue.net -p wa -k audit_network_modifications
# -w /etc/hosts -p wa -k audit_network_modifications
# -w /etc/sysconfig/network -p wa -k audit_network_modifications
#
# If the system is configured to watch for network configuration changes, a line should be returned for each file specified for both (and "-p wa" should be indicated for each).
#
# If the system is not configured to audit changes of the network configuration, this is a finding.
#
# Fix Text: Add the following to "/etc/audit/audit.rules", setting ARCH to either b32 or b64 as appropriate for your system:
#
# # audit_network_modifications
# -a always,exit -F arch=ARCH -S sethostname -S setdomainname -k audit_network_modifications
# -w /etc/issue -p wa -k audit_network_modifications
# -w /etc/issue.net -p wa -k audit_network_modifications
# -w /etc/hosts -p wa -k audit_network_modifications
# -w /etc/sysconfig/network -p wa -k audit_network_modifications
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
# - name: fail stig_rhel6_v1r18 v_38540
#   set_fact:
#     stig_rhel6_v1r18_v_38540_result: 'fail'
#   when:
#     - "'v_38540' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38540_result != 'pass'


# Vuln ID: V-38541
# Severity: low
# Group Title: SRG-OS-999999
# Rule ID: SV-50342r2_rule
# STIG ID: RHEL-06-000183
# Rule Title: The audit system must be configured to audit modifications to the systems Mandatory Access Control (MAC) configuration (SELinux).
# Discussion: The system's mandatory access policy (SELinux) should not be arbitrarily changed by anything other than administrator action. All changes to MAC policy should be audited.
# IA Controls:
# Check Content: To determine if the system is configured to audit changes to its SELinux configuration files, run the following command:
#
# $ sudo grep -w "/etc/selinux" /etc/audit/audit.rules
#
# If the system is configured to watch for changes to its SELinux configuration, a line should be returned (including "-p wa" indicating permissions that are watched).
#
# If the system is not configured to audit attempts to change the MAC policy, this is a finding.
# Fix Text: Add the following to "/etc/audit/audit.rules":
#
# -w /etc/selinux/ -p wa -k MAC-policy
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
# - name: fail stig_rhel6_v1r18 v_38541
#   set_fact:
#     stig_rhel6_v1r18_v_38541_result: 'fail'
#   when:
#     - "'v_38541' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38541_result != 'pass'


# Vuln ID: V-38543
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50344r3_rule
# STIG ID: RHEL-06-000184
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using chmod.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "chmod" system call, run the following command:
#
# $ sudo grep -w "chmod" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If the system is not configured to audit permission changes, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S chmod -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S chmod -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S chmod -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S chmod -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel6_v1r18 v_38543
#   set_fact:
#     stig_rhel6_v1r18_v_38543_result: 'fail'
#   when:
#     - "'v_38543' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38543_result != 'pass'


# Vuln ID: V-38545
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50346r3_rule
# STIG ID: RHEL-06-000185
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using chown.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "chown" system call, run the following command:
#
# $ sudo grep -w "chown" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S chown -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S chown -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S chown -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S chown -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel6_v1r18 v_38545
#   set_fact:
#     stig_rhel6_v1r18_v_38545_result: 'fail'
#   when:
#     - "'v_38545' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38545_result != 'pass'


# Vuln ID: V-38547
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50348r3_rule
# STIG ID: RHEL-06-000186
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using fchmod.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "fchmod" system call, run the following command:
#
# $ sudo grep -w "fchmod" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S fchmod -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S fchmod -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S fchmod -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S fchmod -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel6_v1r18 v_38547
#   set_fact:
#     stig_rhel6_v1r18_v_38547_result: 'fail'
#   when:
#     - "'v_38547' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38547_result != 'pass'


# Vuln ID: V-38550
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50351r3_rule
# STIG ID: RHEL-06-000187
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using fchmodat.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "fchmodat" system call, run the following command:
#
# $ sudo grep -w "fchmodat" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S fchmodat -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S fchmodat -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S fchmodat -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S fchmodat -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel6_v1r18 v_38550
#   set_fact:
#     stig_rhel6_v1r18_v_38550_result: 'fail'
#   when:
#     - "'v_38550' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38550_result != 'pass'


# Vuln ID: V-38552
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50353r3_rule
# STIG ID: RHEL-06-000188
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using fchown.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "fchown" system call, run the following command:
#
# $ sudo grep -w "fchown" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S fchown -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S fchown -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S fchown -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S fchown -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel6_v1r18 v_38552
#   set_fact:
#     stig_rhel6_v1r18_v_38552_result: 'fail'
#   when:
#     - "'v_38552' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38552_result != 'pass'


# Severity: low
# Vuln ID: V-38554
# Group Title: SRG-OS-000064
# Rule ID: SV-50355r3_rule
# STIG ID: RHEL-06-000189
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using fchownat.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "fchownat" system call, run the following command:
#
# $ sudo grep -w "fchownat" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S fchownat -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S fchownat -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S fchownat -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S fchownat -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel6_v1r18 v_38554
#   set_fact:
#     stig_rhel6_v1r18_v_38554_result: 'fail'
#   when:
#     - "'v_38554' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38554_result != 'pass'


# Vuln ID: V-38556
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50357r3_rule
# STIG ID: RHEL-06-000190
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using fremovexattr.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "fremovexattr" system call, run the following command:
#
# $ sudo grep -w "fremovexattr" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S fremovexattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S fremovexattr -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S fremovexattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S fremovexattr -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel6_v1r18 v_38556
#   set_fact:
#     stig_rhel6_v1r18_v_38556_result: 'fail'
#   when:
#     - "'v_38556' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38556_result != 'pass'


# Vuln ID: V-38557
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50358r3_rule
# STIG ID: RHEL-06-000191
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using fsetxattr.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "fsetxattr" system call, run the following command:
#
# $ sudo grep -w "fsetxattr" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S fsetxattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S fsetxattr -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S fsetxattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S fsetxattr -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel6_v1r18 v_38557
#   set_fact:
#     stig_rhel6_v1r18_v_38557_result: 'fail'
#   when:
#     - "'v_38557' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38557_result != 'pass'


# Vuln ID: V-38558
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50359r3_rule
# STIG ID: RHEL-06-000192
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using lchown.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "lchown" system call, run the following command:
#
# $ sudo grep -w "lchown" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S lchown -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S lchown -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S lchown -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S lchown -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel6_v1r18 v_38558
#   set_fact:
#     stig_rhel6_v1r18_v_38558_result: 'fail'
#   when:
#     - "'v_38558' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38558_result != 'pass'


# Vuln ID: V-38559
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50360r3_rule
# STIG ID: RHEL-06-000193
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using lremovexattr.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "lremovexattr" system call, run the following command:
#
# $ sudo grep -w "lremovexattr" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S lremovexattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S lremovexattr -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S lremovexattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S lremovexattr -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel6_v1r18 v_38559
#   set_fact:
#     stig_rhel6_v1r18_v_38559_result: 'fail'
#   when:
#     - "'v_38559' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38559_result != 'pass'


# Vuln ID: V-38561
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50362r3_rule
# STIG ID: RHEL-06-000194
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using lsetxattr.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "lsetxattr" system call, run the following command:
#
# $ sudo grep -w "lsetxattr" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S lsetxattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S lsetxattr -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S lsetxattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S lsetxattr -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel6_v1r18 v_38561
#   set_fact:
#     stig_rhel6_v1r18_v_38561_result: 'fail'
#   when:
#     - "'v_38561' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38561_result != 'pass'


# Vuln ID: V-38563
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50364r3_rule
# STIG ID: RHEL-06-000195
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using removexattr.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "removexattr" system call, run the following command:
#
# $ sudo grep -w "removexattr" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S removexattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S removexattr -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S removexattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S removexattr -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel6_v1r18 v_38563
#   set_fact:
#     stig_rhel6_v1r18_v_38563_result: 'fail'
#   when:
#     - "'v_38563' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38563_result != 'pass'


# Vuln ID: V-38565
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50366r3_rule
# STIG ID: RHEL-06-000196
# Rule Title: The audit system must be configured to audit all discretionary access control permission modifications using setxattr.
# Discussion: The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "setxattr" system call, run the following command:
#
# $ sudo grep -w "setxattr" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -a always,exit -F arch=b32 -S setxattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b32 -S setxattr -F auid=0 -k perm_mod
#
# If the system is 64-bit, then also add the following:
#
# -a always,exit -F arch=b64 -S setxattr -F auid>=500 -F auid!=4294967295 \
# -k perm_mod
# -a always,exit -F arch=b64 -S setxattr -F auid=0 -k perm_mod
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel6_v1r18 v_38565
#   set_fact:
#     stig_rhel6_v1r18_v_38565_result: 'fail'
#   when:
#     - "'v_38565' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38565_result != 'pass'


# Vuln ID: V-38566
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50367r2_rule
# STIG ID: RHEL-06-000197
# Rule Title: The audit system must be configured to audit failed attempts to access files and programs.
# Discussion: Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.
# IA Controls:
# Check Content: To verify that the audit system collects unauthorized file accesses, run the following commands:
#
# # grep EACCES /etc/audit/audit.rules
#
#
#
# # grep EPERM /etc/audit/audit.rules
#
#
# If either command lacks output, this is a finding.
# Fix Text: At a minimum, the audit system should collect unauthorized file accesses for all users and root. Add the following to "/etc/audit/audit.rules", setting ARCH to either b32 or b64 as appropriate for your system:
#
# -a always,exit -F arch=ARCH -S creat -S open -S openat -S truncate \
# -S ftruncate -F exit=-EACCES -F auid>=500 -F auid!=4294967295 -k access
# -a always,exit -F arch=ARCH -S creat -S open -S openat -S truncate \
# -S ftruncate -F exit=-EPERM -F auid>=500 -F auid!=4294967295 -k access
# -a always,exit -F arch=ARCH -S creat -S open -S openat -S truncate \
# -S ftruncate -F exit=-EACCES -F auid=0 -k access
# -a always,exit -F arch=ARCH -S creat -S open -S openat -S truncate \
# -S ftruncate -F exit=-EPERM -F auid=0 -k access
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel6_v1r18 v_38566
#   set_fact:
#     stig_rhel6_v1r18_v_38566_result: 'fail'
#   when:
#     - "'v_38566' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38566_result != 'pass'


# Vuln ID: V-38567
# Severity: low
# Group Title: SRG-OS-000020
# Rule ID: SV-50368r4_rule
# STIG ID: RHEL-06-000198
# Rule Title: The audit system must be configured to audit all use of setuid and setgid programs.
# Discussion: Privileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.
# IA Controls:
# Check Content: To verify that auditing of privileged command use is configured, run the following command once for each local partition [PART] to find relevant setuid / setgid programs:
#
# $ sudo find [PART] -xdev -type f -perm /6000 2>/dev/null
#
# Run the following command to verify entries in the audit rules for all programs found with the previous command:
#
# $ sudo grep path /etc/audit/audit.rules
#
# It should be the case that all relevant setuid / setgid programs have a line in the audit rules. If that is not the case, this is a finding.
# Fix Text: At a minimum, the audit system should collect the execution of privileged commands for all users and root. To find the relevant setuid / setgid programs, run the following command for each local partition [PART]:
#
# $ sudo find [PART] -xdev -type f -perm /6000 2>/dev/null
#
# Then, for each setuid / setgid program on the system, add a line of the following form to "/etc/audit/audit.rules", where [SETUID_PROG_PATH] is the full path to each setuid / setgid program in the list:
#
# -a always,exit -F path=[SETUID_PROG_PATH] -F perm=x -F auid>=500 -F auid!=4294967295 -k privileged
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000040
# The organization audits any use of privileged accounts, or roles, with access to organization defined security functions or security-relevant information, when accessing other system functions.
# NIST SP 800-53 :: AC-6 (2)
# NIST SP 800-53A :: AC-6 (2).1 (iii)
#
#
# - name: fail stig_rhel6_v1r18 v_38567
#   set_fact:
#     stig_rhel6_v1r18_v_38567_result: 'fail'
#   when:
#     - "'v_38567' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38567_result != 'pass'


# Vuln ID: V-38568
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50369r3_rule
# STIG ID: RHEL-06-000199
# Rule Title: The audit system must be configured to audit successful file system mounts.
# Discussion: The unauthorized exportation of data to external media could result in an information leak where classified information, Privacy Act information, and intellectual property could be lost. An audit trail should be created each time a filesystem is mounted to help identify and guard against information loss.
# IA Controls:
# Check Content: To verify that auditing is configured for all media exportation events, run the following command:
#
# $ sudo grep -w "mount" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return several lines.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect media exportation events for all users and root. Add the following to "/etc/audit/audit.rules", setting ARCH to either b32 or b64 as appropriate for your system:
#
# -a always,exit -F arch=ARCH -S mount -F auid>=500 -F auid!=4294967295 -k export
# -a always,exit -F arch=ARCH -S mount -F auid=0 -k export
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel6_v1r18 v_38568
#   set_fact:
#     stig_rhel6_v1r18_v_38568_result: 'fail'
#   when:
#     - "'v_38568' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38568_result != 'pass'


# Vuln ID: V-38575
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50376r4_rule
# STIG ID: RHEL-06-000200
# Rule Title: The audit system must be configured to audit user deletions of files and programs.
# Discussion: Auditing file deletions will create an audit trail for files that are removed from the system. The audit trail could aid in system troubleshooting, as well as detecting malicious processes that attempt to delete log files to conceal their presence.
# IA Controls:
# Check Content: To determine if the system is configured to audit calls to the "rmdir" system call, run the following command:
#
# $ sudo grep -w "rmdir" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line. To determine if the system is configured to audit calls to the "unlink" system call, run the following command:
#
# $ sudo grep -w "unlink" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line. To determine if the system is configured to audit calls to the "unlinkat" system call, run the following command:
#
# $ sudo grep -w "unlinkat" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line. To determine if the system is configured to audit calls to the "rename" system call, run the following command:
#
# $ sudo grep -w "rename" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line. To determine if the system is configured to audit calls to the "renameat" system call, run the following command:
#
# $ sudo grep -w "renameat" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line.
#
# If no line is returned, this is a finding.
# Fix Text: At a minimum, the audit system should collect file deletion events for all users and root. Add the following (or equivalent) to "/etc/audit/audit.rules", setting ARCH to either b32 or b64 as appropriate for your system:
#
# -a always,exit -F arch=ARCH -S rmdir -S unlink -S unlinkat -S rename -S renameat -F auid>=500 -F auid!=4294967295 -k delete
# -a always,exit -F arch=ARCH -S rmdir -S unlink -S unlinkat -S rename -S renameat -F auid=0 -k delete
#
#
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel6_v1r18 v_38575
#   set_fact:
#     stig_rhel6_v1r18_v_38575_result: 'fail'
#   when:
#     - "'v_38575' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38575_result != 'pass'


# Vuln ID: V-38578
# Severity: low
# Group Title: SRG-OS-000064
# Rule ID: SV-50379r2_rule
# STIG ID: RHEL-06-000201
# Rule Title: The audit system must be configured to audit changes to the /etc/sudoers file.
# Discussion: The actions taken by system administrators should be audited to keep a record of what was executed on the system, as well as, for accountability purposes.
# IA Controls:
# Check Content: To verify that auditing is configured for system administrator actions, run the following command:
#
# $ sudo grep -w "/etc/sudoers" /etc/audit/audit.rules
#
# If the system is configured to watch for changes to its sudoers configuration, a line should be returned (including "-p wa" indicating permissions that are watched).
#
# If there is no output, this is a finding.
# Fix Text: At a minimum, the audit system should collect administrator actions for all users and root. Add the following to "/etc/audit/audit.rules":
#
# -w /etc/sudoers -p wa -k actions
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel6_v1r18 v_38578
#   set_fact:
#     stig_rhel6_v1r18_v_38578_result: 'fail'
#   when:
#     - "'v_38578' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38578_result != 'pass'


# Vuln ID: V-38580
# Severity: medium
# Group Title: SRG-OS-000064
# Rule ID: SV-50381r2_rule
# STIG ID: RHEL-06-000202
# Rule Title: The audit system must be configured to audit the loading and unloading of dynamic kernel modules.
# Discussion: The addition/removal of kernel modules can be used to alter the behavior of the kernel and potentially introduce malicious code into kernel space. It is important to have an audit trail of modules that have been introduced into the kernel.
# IA Controls:
# Check Content: To determine if the system is configured to audit execution of module management programs, run the following commands:
#
# $ sudo egrep -e "(-w |-F path=)/sbin/insmod" /etc/audit/audit.rules
# $ sudo egrep -e "(-w |-F path=)/sbin/rmmod" /etc/audit/audit.rules
# $ sudo egrep -e "(-w |-F path=)/sbin/modprobe" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line.
#
# To determine if the system is configured to audit calls to the "init_module" system call, run the following command:
#
# $ sudo grep -w "init_module" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line.
#
# To determine if the system is configured to audit calls to the "delete_module" system call, run the following command:
#
# $ sudo grep -w "delete_module" /etc/audit/audit.rules
#
# If the system is configured to audit this activity, it will return a line.
#
# If no line is returned for any of these commands, this is a finding.
# Fix Text: Add the following to "/etc/audit/audit.rules" in order to capture kernel module loading and unloading events, setting ARCH to either b32 or b64 as appropriate for your system:
#
# -w /sbin/insmod -p x -k modules
# -w /sbin/rmmod -p x -k modules
# -w /sbin/modprobe -p x -k modules
# -a always,exit -F arch=[ARCH] -S init_module -S delete_module -k modules
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel6_v1r18 v_38580
#   set_fact:
#     stig_rhel6_v1r18_v_38580_result: 'fail'
#   when:
#     - "'v_38580' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38580_result != 'pass'


# Vuln ID: V-38628
# Severity: medium
# Group Title: SRG-OS-000255
# Rule ID: SV-50429r2_rule
# STIG ID: RHEL-06-000145
# Rule Title: The operating system must produce audit records containing sufficient information to establish the identity of any user/subject associated with the event.
# Discussion: Ensuring the "auditd" service is active ensures audit records generated by the kernel can be written to disk, or that appropriate actions will be taken if other obstacles exist.
# IA Controls:
# Check Content: Run the following command to determine the current status of the "auditd" service:
#
# # service auditd status
#
# If the service is enabled, it should return the following:
#
# auditd is running...
#
#
# If the service is not running, this is a finding.
# Fix Text: The "auditd" service is an essential userspace component of the Linux Auditing System, as it is responsible for writing audit records to disk. The "auditd" service can be enabled with the following commands:
#
# # chkconfig auditd on
# # service auditd start
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001487
# The information system generates audit records containing information that establishes the identity of any individuals or subjects associated with the event.
# NIST SP 800-53 :: AU-3
# NIST SP 800-53A :: AU-3.1
# NIST SP 800-53 Revision 4 :: AU-3
#
#
# - name: fail stig_rhel6_v1r18 v_38628
#   set_fact:
#     stig_rhel6_v1r18_v_38628_result: 'fail'
#   when:
#     - "'v_38628' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38628_result != 'pass'


# Vuln ID: V-38631
# Severity: medium
# Group Title: SRG-OS-000032
# Rule ID: SV-50432r2_rule
# STIG ID: RHEL-06-000148
# Rule Title: The operating system must employ automated mechanisms to facilitate the monitoring and control of remote access methods.
# Discussion: Ensuring the "auditd" service is active ensures audit records generated by the kernel can be written to disk, or that appropriate actions will be taken if other obstacles exist.
# IA Controls:
# Check Content: Run the following command to determine the current status of the "auditd" service:
#
# # service auditd status
#
# If the service is enabled, it should return the following:
#
# auditd is running...
#
#
# If the service is not running, this is a finding.
# Fix Text: The "auditd" service is an essential userspace component of the Linux Auditing System, as it is responsible for writing audit records to disk. The "auditd" service can be enabled with the following commands:
#
# # chkconfig auditd on
# # service auditd start
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000067
# The information system monitors remote access methods.
# NIST SP 800-53 :: AC-17 (1)
# NIST SP 800-53A :: AC-17 (1).1
# NIST SP 800-53 Revision 4 :: AC-17 (1)
#
#
# - name: fail stig_rhel6_v1r18 v_38631
#   set_fact:
#     stig_rhel6_v1r18_v_38631_result: 'fail'
#   when:
#     - "'v_38631' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38631_result != 'pass'


# Vuln ID: V-38632
# Severity: medium
# Group Title: SRG-OS-000037
# Rule ID: SV-50433r2_rule
# STIG ID: RHEL-06-000154
# Rule Title: The operating system must produce audit records containing sufficient information to establish what type of events occurred.
# Discussion: Ensuring the "auditd" service is active ensures audit records generated by the kernel can be written to disk, or that appropriate actions will be taken if other obstacles exist.
# IA Controls:
# Check Content: Run the following command to determine the current status of the "auditd" service:
#
# # service auditd status
#
# If the service is enabled, it should return the following:
#
# auditd is running...
#
#
# If the service is not running, this is a finding.
# Fix Text: The "auditd" service is an essential userspace component of the Linux Auditing System, as it is responsible for writing audit records to disk. The "auditd" service can be enabled with the following commands:
#
# # chkconfig auditd on
# # service auditd start
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000130
# The information system generates audit records containing information that establishes what type of event occurred.
# NIST SP 800-53 :: AU-3
# NIST SP 800-53A :: AU-3.1
# NIST SP 800-53 Revision 4 :: AU-3
#
#
# - name: fail stig_rhel6_v1r18 v_38632
#   set_fact:
#     stig_rhel6_v1r18_v_38632_result: 'fail'
#   when:
#     - "'v_38632' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38632_result != 'pass'


# Vuln ID: V-38633
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50434r1_rule
# STIG ID: RHEL-06-000160
# Rule Title: The system must set a maximum audit log file size.
# Discussion: The total storage for audit log files must be large enough to retain log information over the period required. This is a function of the maximum log file size and the number of logs retained.
# IA Controls:
# Check Content: Inspect "/etc/audit/auditd.conf" and locate the following line to determine how much data the system will retain in each audit log file: "# grep max_log_file /etc/audit/auditd.conf"
#
# max_log_file = 6
#
#
# If the system audit data threshold hasn't been properly set up, this is a finding.
# Fix Text: Determine the amount of audit data (in megabytes) which should be retained in each log file. Edit the file "/etc/audit/auditd.conf". Add or modify the following line, substituting the correct value for [STOREMB]:
#
# max_log_file = [STOREMB]
#
# Set the value to "6" (MB) or higher for general-purpose systems. Larger values, of course, support retention of even more audit data.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
# - name: fail stig_rhel6_v1r18 v_38633
#   set_fact:
#     stig_rhel6_v1r18_v_38633_result: 'fail'
#   when:
#     - "'v_38633' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38633_result != 'pass'


# Vuln ID: V-38634
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50435r2_rule
# STIG ID: RHEL-06-000161
# Rule Title: The system must rotate audit log files that reach the maximum file size.
# Discussion: Automatically rotating logs (by setting this to "rotate") minimizes the chances of the system unexpectedly running out of disk space by being overwhelmed with log data. However, for systems that must never discard log data, or which use external processes to transfer it and reclaim space, "keep_logs" can be employed.
# IA Controls:
# Check Content: Inspect "/etc/audit/auditd.conf" and locate the following line to determine if the system is configured to rotate logs when they reach their maximum size:
#
# # grep max_log_file_action /etc/audit/auditd.conf
# max_log_file_action = rotate
#
# If the "keep_logs" option is configured for the "max_log_file_action" line in "/etc/audit/auditd.conf" and an alternate process is in place to ensure audit data does not overwhelm local audit storage, this is not a finding.
#
# If the system has not been properly set up to rotate audit logs, this is a finding.
# Fix Text: The default action to take when the logs reach their maximum size is to rotate the log files, discarding the oldest one. To configure the action taken by "auditd", add or correct the line in "/etc/audit/auditd.conf":
#
# max_log_file_action = [ACTION]
#
# Possible values for [ACTION] are described in the "auditd.conf" man page. These include:
#
# "ignore"
# "syslog"
# "suspend"
# "rotate"
# "keep_logs"
#
#
# Set the "[ACTION]" to "rotate" to ensure log rotation occurs. This is the default. The setting is case-insensitive.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
# - name: fail stig_rhel6_v1r18 v_38634
#   set_fact:
#     stig_rhel6_v1r18_v_38634_result: 'fail'
#   when:
#     - "'v_38634' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38634_result != 'pass'


# Vuln ID: V-38636
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50437r1_rule
# STIG ID: RHEL-06-000159
# Rule Title: The system must retain enough rotated audit logs to cover the required log retention period.
# Discussion: The total storage for audit log files must be large enough to retain log information over the period required. This is a function of the maximum log file size and the number of logs retained.
# IA Controls:
# Check Content: Inspect "/etc/audit/auditd.conf" and locate the following line to determine how many logs the system is configured to retain after rotation: "# grep num_logs /etc/audit/auditd.conf"
#
# num_logs = 5
#
#
# If the overall system log file(s) retention hasn't been properly set up, this is a finding.
# Fix Text: Determine how many log files "auditd" should retain when it rotates logs. Edit the file "/etc/audit/auditd.conf". Add or modify the following line, substituting [NUMLOGS] with the correct value:
#
# num_logs = [NUMLOGS]
#
# Set the value to 5 for general-purpose systems. Note that values less than 2 result in no log rotation.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
# - name: fail stig_rhel6_v1r18 v_38636
#   set_fact:
#     stig_rhel6_v1r18_v_38636_result: 'fail'
#   when:
#     - "'v_38636' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38636_result != 'pass'


# Vuln ID: V-38637
# Severity: medium
# Group Title: SRG-OS-000278
# Rule ID: SV-50438r2_rule
# STIG ID: RHEL-06-000281
# Rule Title: The system package management tool must verify contents of all files associated with the audit package.
# Discussion: The hash on important files like audit system executables should match the information given by the RPM database. Audit executables  with erroneous hashes could be a sign of nefarious activity on the system.
# IA Controls:
# Check Content: The following command will list which audit files on the system have file hashes different from what is expected by the RPM database.
#
# # rpm -V audit | awk '$1 ~ /..5/ && $2 != "c"'
#
#
# If there is output, this is a finding.
# Fix Text: The RPM package management system can check the hashes of audit system package files. Run the following command to list which audit files on the system have hashes that differ from what is expected by the RPM database:
#
# # rpm -V audit | grep '^..5'
#
# A "c" in the second column indicates that a file is a configuration file, which may appropriately be expected to change. If the file that has changed was not expected to then refresh from distribution media or online repositories.
#
# rpm -Uvh [affected_package]
#
# OR
#
# yum reinstall [affected_package]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001496
# The information system implements cryptographic mechanisms to protect the integrity of audit tools.
# NIST SP 800-53 :: AU-9 (3)
# NIST SP 800-53A :: AU-9 (3).1
# NIST SP 800-53 Revision 4 :: AU-9 (3)
#
#
# - name: fail stig_rhel6_v1r18 v_38637
#   set_fact:
#     stig_rhel6_v1r18_v_38637_result: 'fail'
#   when:
#     - "'v_38637' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38637_result != 'pass'


# Vuln ID: V-38663
# Severity: medium
# Group Title: SRG-OS-000256
# Rule ID: SV-50464r1_rule
# STIG ID: RHEL-06-000278
# Rule Title: The system package management tool must verify permissions on all files and directories associated with the audit package.
# Discussion: Permissions on audit binaries and configuration files that are too generous could allow an unauthorized user to gain privileges that they should not have. The permissions set by the vendor should be maintained. Any deviations from this baseline should be investigated.
# IA Controls:
# Check Content: The following command will list which audit files on the system have permissions different from what is expected by the RPM database:
#
# # rpm -V audit | grep '^.M'
#
# If there is any output, for each file or directory found, compare the RPM-expected permissions with the permissions on the file or directory:
#
# # rpm -q --queryformat "[%{FILENAMES} %{FILEMODES:perms}\n]" audit | grep  [filename]
# # ls -lL [filename]
#
# If the existing permissions are more permissive than those expected by RPM, this is a finding.
# Fix Text: The RPM package management system can restore file access permissions of the audit package files and directories. The following command will update audit files with permissions different from what is expected by the RPM database:
#
# # rpm --setperms audit
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001493
# The information system protects audit tools from unauthorized access.
# NIST SP 800-53 :: AU-9
# NIST SP 800-53A :: AU-9.1
# NIST SP 800-53 Revision 4 :: AU-9
#
#
# - name: fail stig_rhel6_v1r18 v_38663
#   set_fact:
#     stig_rhel6_v1r18_v_38663_result: 'fail'
#   when:
#     - "'v_38663' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38663_result != 'pass'


# Vuln ID: V-38664
# Severity: medium
# Group Title: SRG-OS-000257
# Rule ID: SV-50465r1_rule
# STIG ID: RHEL-06-000279
# Rule Title: The system package management tool must verify ownership on all files and directories associated with the audit package.
# Discussion: Ownership of audit binaries and configuration files that is incorrect could allow an unauthorized user to gain privileges that they should not have. The ownership set by the vendor should be maintained. Any deviations from this baseline should be investigated.
# IA Controls:
# Check Content: The following command will list which audit files on the system have ownership different from what is expected by the RPM database:
#
# # rpm -V audit | grep '^.....U'
#
#
# If there is output, this is a finding.
# Fix Text: The RPM package management system can restore file ownership of the audit package files and directories. The following command will update audit files with ownership different from what is expected by the RPM database:
#
# # rpm --setugids audit
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001494
# The information system protects audit tools from unauthorized modification.
# NIST SP 800-53 :: AU-9
# NIST SP 800-53A :: AU-9.1
# NIST SP 800-53 Revision 4 :: AU-9
#
#
# - name: fail stig_rhel6_v1r18 v_38664
#   set_fact:
#     stig_rhel6_v1r18_v_38664_result: 'fail'
#   when:
#     - "'v_38664' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38664_result != 'pass'


# Vuln ID: V-38665
# Severity: medium
# Group Title: SRG-OS-000258
# Rule ID: SV-50466r1_rule
# STIG ID: RHEL-06-000280
# Rule Title: The system package management tool must verify group-ownership on all files and directories associated with the audit package.
# Discussion: Group-ownership of audit binaries and configuration files that is incorrect could allow an unauthorized user to gain privileges that they should not have. The group-ownership set by the vendor should be maintained. Any deviations from this baseline should be investigated.
# IA Controls:
# Check Content: The following command will list which audit files on the system have group-ownership different from what is expected by the RPM database:
#
# # rpm -V audit | grep '^......G'
#
#
# If there is output, this is a finding.
# Fix Text: The RPM package management system can restore file group-ownership of the audit package files and directories. The following command will update audit files with group-ownership different from what is expected by the RPM database:
#
# # rpm --setugids audit
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001495
# The information system protects audit tools from unauthorized deletion.
# NIST SP 800-53 :: AU-9
# NIST SP 800-53A :: AU-9.1
# NIST SP 800-53 Revision 4 :: AU-9
#
#
# - name: fail stig_rhel6_v1r18 v_38665
#   set_fact:
#     stig_rhel6_v1r18_v_38665_result: 'fail'
#   when:
#     - "'v_38665' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38665_result != 'pass'


# Vuln ID: V-38678
# Severity: medium
# Group Title: SRG-OS-000048
# Rule ID: SV-50479r2_rule
# STIG ID: RHEL-06-000311
# Rule Title: The audit system must provide a warning when allocated audit record storage volume reaches a documented percentage of maximum audit record storage capacity.
# Discussion: Notifying administrators of an impending disk space problem may allow them to take corrective action prior to any disruption.
# IA Controls:
# Check Content: Inspect "/etc/audit/auditd.conf" and locate the following line to determine whether the system is configured to email the administrator when disk space is starting to run low:
#
# # grep space_left /etc/audit/auditd.conf
#
# space_left = [num_megabytes]
#
#
# If the "num_megabytes" value does not correspond to a documented value for remaining audit partition capacity or if there is no locally documented value for remaining audit partition capacity, this is a finding.
# Fix Text: The "auditd" service can be configured to take an action when disk space starts to run low. Edit the file "/etc/audit/auditd.conf". Modify the following line, substituting [num_megabytes] appropriately:
#
# space_left = [num_megabytes]
#
# The "num_megabytes" value should be set to a fraction of the total audit storage capacity available that will allow a system administrator to be notified with enough time to respond to the situation causing the capacity issues.  This value must also be documented locally.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000143
# The information system provides a warning when allocated audit record storage volume reaches an organization defined percentage of maximum audit record storage capacity.
# NIST SP 800-53 :: AU-5 (1)
# NIST SP 800-53A :: AU-5 (1).1 (ii)
#
#
# - name: fail stig_rhel6_v1r18 v_38678
#   set_fact:
#     stig_rhel6_v1r18_v_38678_result: 'fail'
#   when:
#     - "'v_38678' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38678_result != 'pass'


# Vuln ID: V-38680
# Severity: medium
# Group Title: SRG-OS-000046
# Rule ID: SV-50481r1_rule
# STIG ID: RHEL-06-000313
# Rule Title: The audit system must identify staff members to receive notifications of audit log storage volume capacity issues.
# Discussion: Email sent to the root account is typically aliased to the administrators of the system, who can take appropriate action.
# IA Controls:
# Check Content: Inspect "/etc/audit/auditd.conf" and locate the following line to determine if the system is configured to send email to an account when it needs to notify an administrator:
#
# action_mail_acct = root
#
#
# If auditd is not configured to send emails per identified actions, this is a finding.
# Fix Text: The "auditd" service can be configured to send email to a designated account in certain situations. Add or correct the following line in "/etc/audit/auditd.conf" to ensure that administrators are notified via email for those situations:
#
# action_mail_acct = root
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000139
# The information system alerts designated organization-defined personnel or roles in the event of an audit processing failure.
# NIST SP 800-53 :: AU-5 a
# NIST SP 800-53A :: AU-5.1 (ii)
# NIST SP 800-53 Revision 4 :: AU-5 a
#
#
# - name: fail stig_rhel6_v1r18 v_38680
#   set_fact:
#     stig_rhel6_v1r18_v_38680_result: 'fail'
#   when:
#     - "'v_38680' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_38680_result != 'pass'


# Vuln ID: V-54381
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-68627r3_rule
# STIG ID: RHEL-06-000163
# Rule Title: The audit system must switch the system to single-user mode when available audit storage volume becomes dangerously low.
# Discussion: Administrators should be made aware of an inability to record audit records. If a separate partition or logical volume of adequate size is used, running low on space for audit records should never occur.
# IA Controls:
# Check Content: Inspect "/etc/audit/auditd.conf" and locate the following line to determine if the system is configured to either suspend, switch to single-user mode, or halt when disk space has run low:
#
# admin_space_left_action = single
#
# If the system is not configured to switch to single-user mode, suspend, or halt for corrective action, this is a finding.
# Fix Text: The "auditd" service can be configured to take an action when disk space is running low but prior to running out of space completely. Edit the file "/etc/audit/auditd.conf". Add or modify the following line, substituting [ACTION] appropriately:
#
# admin_space_left_action = [ACTION]
#
# Set this value to "single" to cause the system to switch to single-user mode for corrective action. Acceptable values also include "suspend" and "halt". For certain systems, the need for availability outweighs the need to log all actions, and a different setting should be determined. Details regarding all possible values for [ACTION] are described in the "auditd.conf" man page.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
# - name: fail stig_rhel6_v1r18 v_54381
#   set_fact:
#     stig_rhel6_v1r18_v_54381_result: 'fail'
#   when:
#     - "'v_54381' in stig_rhel6_v1r18_checks"
#     - stig_rhel6_v1r18_v_54381_result != 'pass'
