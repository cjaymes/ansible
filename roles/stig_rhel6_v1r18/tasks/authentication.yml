# Vuln ID: V-38439
# Severity: medium
# Group Title: SRG-OS-000001
# Rule ID: SV-50239r1_rule
# STIG ID: RHEL-06-000524
# Rule Title: The system must provide automated support for account management functions.
# Discussion: A comprehensive account management process that includes automation helps to ensure the accounts designated as requiring attention are consistently and promptly addressed. Enterprise environments make user account management challenging and complex. A user management process requiring administrators to manually address account management functions adds risk of potential oversight.
# IA Controls:
# Check Content: Interview the SA to determine if there is an automated system for managing user accounts, preferably integrated with an existing enterprise user management system.
#
# If there is not, this is a finding.
# Fix Text: Implement an automated system for managing user accounts that minimizes the risk of errors, either intentional or deliberate.  If possible, this system should integrate with an existing enterprise user management system, such as, one based Active Directory or Kerberos.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000015
# The organization employs automated mechanisms to support the information system account management functions.
# NIST SP 800-53 :: AC-2 (1)
# NIST SP 800-53A :: AC-2 (1).1
# NIST SP 800-53 Revision 4 :: AC-2 (1)
#
#
- name: check stig_rhel6_v1r18 v_38439
  when: ['v_38439']|issubset(check_findings)


# Vuln ID: V-38475
# Severity: medium
# Group Title: SRG-OS-000078
# Rule ID: SV-50275r3_rule
# STIG ID: RHEL-06-000050
# Rule Title: The system must require passwords to contain a minimum of 15 characters.
# Discussion: Requiring a minimum password length makes password cracking attacks more difficult by ensuring a larger search space. However, any security benefit from an onerous requirement must be carefully weighed against usability problems, support costs, or counterproductive behavior that may result.
#
# While it does not negate the password length requirement, it is preferable to migrate from a password-based authentication scheme to a stronger one based on PKI (public key infrastructure).
# IA Controls:
# Check Content: To check the minimum password length, run the command:
#
# $ grep PASS_MIN_LEN /etc/login.defs
#
# The DoD requirement is "15".
#
# If it is not set to the required value, this is a finding.
#
# $ grep –E ‘pam_cracklib.so.*minlen’ /etc/pam.d/*
#
# If no results are returned, this is not a finding.
#
# If any results are returned and are not set to “15” or greater, this is a finding.
#
# Fix Text: To specify password length requirements for new accounts, edit the file "/etc/login.defs" and add or correct the following lines:
#
# PASS_MIN_LEN 15
#
# The DoD requirement is "15". If a program consults "/etc/login.defs" and also another PAM module (such as "pam_cracklib") during a password change operation, then the most restrictive must be satisfied.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000205
# The information system enforces minimum password length.
# NIST SP 800-53 :: IA-5 (1) (a)
# NIST SP 800-53A :: IA-5 (1).1 (i)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (a)
#
#
- name: check stig_rhel6_v1r18 v_38475
  when: ['v_38475']|issubset(check_findings)


# Vuln ID: V-38477
# Severity: medium
# Group Title: SRG-OS-000075
# Rule ID: SV-50277r1_rule
# STIG ID: RHEL-06-000051
# Rule Title: Users must not be able to change passwords more than once every 24 hours.
# Discussion: Setting the minimum password age protects against users cycling back to a favorite password after satisfying the password reuse requirement.
# IA Controls:
# Check Content: To check the minimum password age, run the command:
#
# $ grep PASS_MIN_DAYS /etc/login.defs
#
# The DoD requirement is 1.
# If it is not set to the required value, this is a finding.
# Fix Text: To specify password minimum age for new accounts, edit the file "/etc/login.defs" and add or correct the following line, replacing [DAYS] appropriately:
#
# PASS_MIN_DAYS [DAYS]
#
# A value of 1 day is considered sufficient for many environments. The DoD requirement is 1.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000198
# The information system enforces minimum password lifetime restrictions.
# NIST SP 800-53 :: IA-5 (1) (d)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (d)
#
#
- name: check stig_rhel6_v1r18 v_38477
  when: ['v_38477']|issubset(check_findings)


# Vuln ID: V-38479
# Severity: medium
# Group Title: SRG-OS-000076
# Rule ID: SV-50279r1_rule
# STIG ID: RHEL-06-000053
# Rule Title: User passwords must be changed at least every 60 days.
# Discussion: Setting the password maximum age ensures users are required to periodically change their passwords. This could possibly decrease the utility of a stolen password. Requiring shorter password lifetimes increases the risk of users writing down the password in a convenient location subject to physical compromise.
# IA Controls:
# Check Content: To check the maximum password age, run the command:
#
# $ grep PASS_MAX_DAYS /etc/login.defs
#
# The DoD requirement is 60.
# If it is not set to the required value, this is a finding.
# Fix Text: To specify password maximum age for new accounts, edit the file "/etc/login.defs" and add or correct the following line, replacing [DAYS] appropriately:
#
# PASS_MAX_DAYS [DAYS]
#
# The DoD requirement is 60.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000199
# The information system enforces maximum password lifetime restrictions.
# NIST SP 800-53 :: IA-5 (1) (d)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (d)
#
#
- name: check stig_rhel6_v1r18 v_38479
  when: ['v_38479']|issubset(check_findings)


# Vuln ID: V-38480
# Severity: low
# Group Title: SRG-OS-999999
# Rule ID: SV-50280r1_rule
# STIG ID: RHEL-06-000054
# Rule Title: Users must be warned 7 days in advance of password expiration.
# Discussion: Setting the password warning age enables users to make the change at a practical time.
# IA Controls:
# Check Content: To check the password warning age, run the command:
#
# $ grep PASS_WARN_AGE /etc/login.defs
#
# The DoD requirement is 7.
# If it is not set to the required value, this is a finding.
# Fix Text: To specify how many days prior to password expiration that a warning will be issued to users, edit the file "/etc/login.defs" and add or correct the following line, replacing [DAYS] appropriately:
#
# PASS_WARN_AGE [DAYS]
#
# The DoD requirement is 7.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38480
  when: ['v_38480']|issubset(check_findings)


# Vuln ID: V-38482
# Severity: low
# Group Title: SRG-OS-000071
# Rule ID: SV-50282r1_rule
# STIG ID: RHEL-06-000056
# Rule Title: The system must require passwords to contain at least one numeric character.
# Discussion: Requiring digits makes password guessing attacks more difficult by ensuring a larger search space.
# IA Controls:
# Check Content: To check how many digits are required in a password, run the following command:
#
# $ grep pam_cracklib /etc/pam.d/system-auth
#
# The "dcredit" parameter (as a negative number) will indicate how many digits are required. The DoD requires at least one digit in a password. This would appear as "dcredit=-1".
# If dcredit is not found or not set to the required value, this is a finding.
# Fix Text: The pam_cracklib module's "dcredit" parameter controls requirements for usage of digits in a password. When set to a negative number, any password will be required to contain that many digits. When set to a positive number, pam_cracklib will grant +1 additional length credit for each digit. Add "dcredit=-1" after pam_cracklib.so to require use of a digit in passwords.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000194
# The information system enforces password complexity by the minimum number of numeric characters used.
# NIST SP 800-53 :: IA-5 (1) (a)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (a)
#
#
- name: check stig_rhel6_v1r18 v_38482
  when: ['v_38482']|issubset(check_findings)


# Vuln ID: V-38492
# Severity: medium
# Group Title: SRG-OS-000109
# Rule ID: SV-50293r1_rule
# STIG ID: RHEL-06-000027
# Rule Title: The system must prevent the root account from logging in from virtual consoles.
# Discussion: Preventing direct root login to virtual console devices helps ensure accountability for actions taken on the system using the root account.
# IA Controls:
# Check Content: To check for virtual console entries which permit root login, run the following command:
#
# # grep '^vc/[0-9]' /etc/securetty
#
# If any output is returned, then root logins over virtual console devices is permitted.
# If root login over virtual console devices is permitted, this is a finding.
# Fix Text: To restrict root logins through the (deprecated) virtual console devices, ensure lines of this form do not appear in "/etc/securetty":
#
# vc/1
# vc/2
# vc/3
# vc/4
#
# Note:  Virtual console entries are not limited to those listed above.  Any lines starting with "vc/" followed by numerals should be removed.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000770
# The organization requires individuals to be authenticated with an individual authenticator when a group authenticator is employed.
# NIST SP 800-53 :: IA-2 (5) (b)
# NIST SP 800-53A :: IA-2 (5).2 (ii)
# NIST SP 800-53 Revision 4 :: IA-2 (5)
#
#
- name: check stig_rhel6_v1r18 v_38492
  when: ['v_38492']|issubset(check_findings)


# Vuln ID: V-38494
# Severity: low
# Group Title: SRG-OS-000109
# Rule ID: SV-50295r1_rule
# STIG ID: RHEL-06-000028
# Rule Title: The system must prevent the root account from logging in from serial consoles.
# Discussion: Preventing direct root login to serial port interfaces helps ensure accountability for actions taken on the systems using the root account.
# IA Controls:
# Check Content: To check for serial port entries which permit root login, run the following command:
#
# # grep '^ttyS[0-9]' /etc/securetty
#
# If any output is returned, then root login over serial ports is permitted.
# If root login over serial ports is permitted, this is a finding.
# Fix Text: To restrict root logins on serial ports, ensure lines of this form do not appear in "/etc/securetty":
#
# ttyS0
# ttyS1
#
# Note:  Serial port entries are not limited to those listed above.  Any lines starting with "ttyS" followed by numerals should be removed
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000770
# The organization requires individuals to be authenticated with an individual authenticator when a group authenticator is employed.
# NIST SP 800-53 :: IA-2 (5) (b)
# NIST SP 800-53A :: IA-2 (5).2 (ii)
# NIST SP 800-53 Revision 4 :: IA-2 (5)
#
#
- name: check stig_rhel6_v1r18 v_38494
  when: ['v_38494']|issubset(check_findings)


# Vuln ID: V-38496
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50297r3_rule
# STIG ID: RHEL-06-000029
# Rule Title: Default operating system accounts, other than root, must be locked.
# Discussion: Disabling authentication for default system accounts makes it more difficult for attackers to make use of them to compromise a system.
# IA Controls:
# Check Content: To obtain a listing of all users and the contents of their shadow password field, run the command:
#
# $ awk -F: '$1 !~ /^root$/ && $2 !~ /^[!*]/ {print $1 ":" $2}' /etc/shadow
#
# Identify the operating system accounts from this listing. These will primarily be the accounts with UID numbers less than 500, other than root.
#
# If any default operating system account (other than root) has a valid password hash, this is a finding.
# Fix Text: Some accounts are not associated with a human user of the system, and exist to perform some administrative function. An attacker should not be able to log into these accounts.
#
# Disable logon access to these accounts with the command:
#
# # passwd -l [SYSACCT]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38496
  when: ['v_38496']|issubset(check_findings)


# Vuln ID: V-38497
# Severity: high
# Group Title: SRG-OS-999999
# Rule ID: SV-50298r2_rule
# STIG ID: RHEL-06-000030
# Rule Title: The system must not have accounts configured with blank or null passwords.
# Discussion: If an account has an empty password, anyone could log in and run commands with the privileges of that account. Accounts with empty passwords should never be used in operational environments.
# IA Controls:
# Check Content: To verify that null passwords cannot be used, run the following command:
#
# # grep nullok /etc/pam.d/system-auth
#
# If this produces any output, it may be possible to log into accounts with empty passwords.
# If NULL passwords can be used, this is a finding.
# Fix Text: If an account is configured for password authentication but does not have an assigned password, it may be possible to log onto the account without authentication. Remove any instances of the "nullok" option in "/etc/pam.d/system-auth" to prevent logons with empty passwords.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38497
  when: ['v_38497']|issubset(check_findings)


# Vuln ID: V-38499
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50300r1_rule
# STIG ID: RHEL-06-000031
# Rule Title: The /etc/passwd file must not contain password hashes.
# Discussion: The hashes for all user account passwords should be stored in the file "/etc/shadow" and never in "/etc/passwd", which is readable by all users.
# IA Controls:
# Check Content: To check that no password hashes are stored in "/etc/passwd", run the following command:
#
# # awk -F: '($2 != "x") {print}' /etc/passwd
#
# If it produces any output, then a password hash is stored in "/etc/passwd".
# If any stored hashes are found in /etc/passwd, this is a finding.
# Fix Text: If any password hashes are stored in "/etc/passwd" (in the second field, instead of an "x"), the cause of this misconfiguration should be investigated. The account should have its password reset and the hash should be properly stored, or the account should be deleted entirely.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38499
  when: ['v_38499']|issubset(check_findings)


# Vuln ID: V-38500
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50301r2_rule
# STIG ID: RHEL-06-000032
# Rule Title: The root account must be the only account having a UID of 0.
# Discussion: An account has root authority if it has a UID of 0. Multiple accounts with a UID of 0 afford more opportunity for potential intruders to guess a password for a privileged account. Proper configuration of sudo is recommended to afford multiple system administrators access to root privileges in an accountable manner.
# IA Controls:
# Check Content: To list all password file entries for accounts with UID 0, run the following command:
#
# # awk -F: '($3 == 0) {print}' /etc/passwd
#
# This should print only one line, for the user root.
# If any account other than root has a UID of 0, this is a finding.
# Fix Text: If any account other than root has a UID of 0, this misconfiguration should be investigated and the accounts other than root should be removed or have their UID changed.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38500
  when: ['v_38500']|issubset(check_findings)


# Vuln ID: V-38501
# Severity: medium
# Group Title: SRG-OS-000249
# Rule ID: SV-50302r4_rule
# STIG ID: RHEL-06-000357
# Rule Title: The system must disable accounts after excessive login failures within a 15-minute interval.
# Discussion: Locking out user accounts after a number of incorrect attempts within a specific period of time prevents direct password guessing attacks.
# IA Controls:
# Check Content: To ensure the failed password attempt policy is configured correctly, run the following command:
#
# $ grep pam_faillock /etc/pam.d/system-auth /etc/pam.d/password-auth
#
# For each file, the output should show "fail_interval=<interval-in-seconds>" where "interval-in-seconds" is 900 (15 minutes) or greater. If the "fail_interval" parameter is not set, the default setting of 900 seconds is acceptable. If that is not the case, this is a finding.
# Fix Text: Utilizing "pam_faillock.so", the "fail_interval" directive configures the system to lock out accounts after a number of incorrect logon attempts. Modify the content of both "/etc/pam.d/system-auth" and "/etc/pam.d/password-auth" as follows:
#
# Add the following line immediately before the "pam_unix.so" statement in the "AUTH" section:
#
# auth required pam_faillock.so preauth silent deny=3 unlock_time=604800 fail_interval=900
#
# Add the following line immediately after the "pam_unix.so" statement in the "AUTH" section:
#
# auth [default=die] pam_faillock.so authfail deny=3 unlock_time=604800 fail_interval=900
#
# Add the following line immediately before the "pam_unix.so" statement in the "ACCOUNT" section:
#
# account required pam_faillock.so
#
# Note that any updates made to "/etc/pam.d/system-auth" and "/etc/pam.d/password-auth" may be overwritten by the "authconfig" program.  The "authconfig" program should not be used.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001452
# The information system enforces the organization defined time period during which the limit of consecutive invalid access attempts by a user is counted.
# NIST SP 800-53 :: AC-7 a
# NIST SP 800-53A :: AC-7.1 (ii)
#
#
- name: check stig_rhel6_v1r18 v_38501
  when: ['v_38501']|issubset(check_findings)


# Vuln ID: V-38569
# Severity: low
# Group Title: SRG-OS-000069
# Rule ID: SV-50370r1_rule
# STIG ID: RHEL-06-000057
# Rule Title: The system must require passwords to contain at least one uppercase alphabetic character.
# Discussion: Requiring a minimum number of uppercase characters makes password guessing attacks more difficult by ensuring a larger search space.
# IA Controls:
# Check Content: To check how many uppercase characters are required in a password, run the following command:
#
# $ grep pam_cracklib /etc/pam.d/system-auth
#
# The "ucredit" parameter (as a negative number) will indicate how many uppercase characters are required. The DoD requires at least one uppercase character in a password. This would appear as "ucredit=-1".
# If ucredit is not found or not set to the required value, this is a finding.
# Fix Text: The pam_cracklib module's "ucredit=" parameter controls requirements for usage of uppercase letters in a password. When set to a negative number, any password will be required to contain that many uppercase characters. When set to a positive number, pam_cracklib will grant +1 additional length credit for each uppercase character. Add "ucredit=-1" after pam_cracklib.so to require use of an uppercase character in passwords.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000192
# The information system enforces password complexity by the minimum number of upper case characters used.
# NIST SP 800-53 :: IA-5 (1) (a)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (a)
#
#
- name: check stig_rhel6_v1r18 v_38569
  when: ['v_38569']|issubset(check_findings)


# Vuln ID: V-38570
# Severity: low
# Group Title: SRG-OS-000266
# Rule ID: SV-50371r1_rule
# STIG ID: RHEL-06-000058
# Rule Title: The system must require passwords to contain at least one special character.
# Discussion: Requiring a minimum number of special characters makes password guessing attacks more difficult by ensuring a larger search space.
# IA Controls:
# Check Content: To check how many special characters are required in a password, run the following command:
#
# $ grep pam_cracklib /etc/pam.d/system-auth
#
# The "ocredit" parameter (as a negative number) will indicate how many special characters are required. The DoD requires at least one special character in a password. This would appear as "ocredit=-1".
# If ocredit is not found or not set to the required value, this is a finding.
# Fix Text: The pam_cracklib module's "ocredit=" parameter controls requirements for usage of special (or ``other'') characters in a password. When set to a negative number, any password will be required to contain that many special characters. When set to a positive number, pam_cracklib will grant +1 additional length credit for each special character. Add "ocredit=-1" after pam_cracklib.so to require use of a special character in passwords.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001619
# The information system enforces password complexity by the minimum number of special characters used.
# NIST SP 800-53 :: IA-5 (1) (a)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (a)
#
#
- name: check stig_rhel6_v1r18 v_38570
  when: ['v_38570']|issubset(check_findings)


# Vuln ID: V-38571
# Severity: low
# Group Title: SRG-OS-000070
# Rule ID: SV-50372r2_rule
# STIG ID: RHEL-06-000059
# Rule Title: The system must require passwords to contain at least one lower-case alphabetic character.
# Discussion: Requiring a minimum number of lower-case characters makes password guessing attacks more difficult by ensuring a larger search space.
# IA Controls:
# Check Content: To check how many lower-case characters are required in a password, run the following command:
#
# $ grep pam_cracklib /etc/pam.d/system-auth
#
# The "lcredit" parameter (as a negative number) will indicate how many lower-case characters are required. The DoD requires at least one lower-case character in a password. This would appear as "lcredit=-1".
#
# If lcredit is not found or not set to the required value, this is a finding.
#
# Fix Text: The pam_cracklib module's "lcredit=" parameter controls requirements for usage of lower-case letters in a password. When set to a negative number, any password will be required to contain that many lower-case characters. Add "lcredit=-1" after pam_cracklib.so to require use of a lower-case character in passwords.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000193
# The information system enforces password complexity by the minimum number of lower case characters used.
# NIST SP 800-53 :: IA-5 (1) (a)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (a)
#
#
- name: check stig_rhel6_v1r18 v_38571
  when: ['v_38571']|issubset(check_findings)


# Vuln ID: V-38572
# Severity: low
# Group Title: SRG-OS-000072
# Rule ID: SV-50373r2_rule
# STIG ID: RHEL-06-000060
# Rule Title: The system must require at least eight characters be changed between the old and new passwords during a password change.
# Discussion: Requiring a minimum number of different characters during password changes ensures that newly changed passwords should not resemble previously compromised ones. Note that passwords which are changed on compromised systems will still be compromised, however.
# IA Controls:
# Check Content: To check how many characters must differ during a password change, run the following command:
#
# $ grep pam_cracklib /etc/pam.d/system-auth
#
# The "difok" parameter will indicate how many characters must differ. The DoD requires eight characters differ during a password change. This would appear as "difok=8".
#
# If difok is not found or not set to the required value, this is a finding.
# Fix Text: The pam_cracklib module's "difok" parameter controls requirements for usage of different characters during a password change. Add "difok=[NUM]" after pam_cracklib.so to require differing characters when changing passwords, substituting [NUM] appropriately. The DoD requirement is 8.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000195
# The information system, for password-based authentication, when new passwords are created, enforces that at least an organization-defined number of characters are changed.
# NIST SP 800-53 :: IA-5 (1) (b)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (b)
#
#
- name: check stig_rhel6_v1r18 v_38572
  when: ['v_38572']|issubset(check_findings)


# Vuln ID: V-38573
# Severity: medium
# Group Title: SRG-OS-000021
# Rule ID: SV-50374r4_rule
# STIG ID: RHEL-06-000061
# Rule Title: The system must disable accounts after three consecutive unsuccessful logon attempts.
# Discussion: Locking out user accounts after a number of incorrect attempts prevents direct password guessing attacks.
# IA Controls:
# Check Content: To ensure the failed password attempt policy is configured correctly, run the following command:
#
# # grep pam_faillock /etc/pam.d/system-auth /etc/pam.d/password-auth
#
# The output should show "deny=3" for both files.
# If that is not the case, this is a finding.
# Fix Text: To configure the system to lock out accounts after a number of incorrect logon attempts using "pam_faillock.so", modify the content of both "/etc/pam.d/system-auth" and "/etc/pam.d/password-auth" as follows:
#
# Add the following line immediately before the "pam_unix.so" statement in the "AUTH" section:
#
# auth required pam_faillock.so preauth silent deny=3 unlock_time=604800 fail_interval=900
#
# Add the following line immediately after the "pam_unix.so" statement in the "AUTH" section:
#
# auth [default=die] pam_faillock.so authfail deny=3 unlock_time=604800 fail_interval=900
#
# Add the following line immediately before the "pam_unix.so" statement in the "ACCOUNT" section:
#
# account required pam_faillock.so
#
# Note that any updates made to "/etc/pam.d/system-auth" and "/etc/pam.d/password-auth" may be overwritten by the "authconfig" program.  The "authconfig" program should not be used.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000044
# The information system enforces the organization-defined limit of consecutive invalid logon attempts by a user during the organization-defined time period.
# NIST SP 800-53 :: AC-7 a
# NIST SP 800-53A :: AC-7.1 (ii)
# NIST SP 800-53 Revision 4 :: AC-7 a
#
#
- name: check stig_rhel6_v1r18 v_38573
  when: ['v_38573']|issubset(check_findings)


# Vuln ID: V-38574
# Severity: medium
# Group Title: SRG-OS-000120
# Rule ID: SV-50375r3_rule
# STIG ID: RHEL-06-000062
# Rule Title: The system must use a FIPS 140-2 approved cryptographic hashing algorithm for generating account password hashes (system-auth).
# Discussion: Using a stronger hashing algorithm makes password cracking attacks more difficult.
# IA Controls:
# Check Content: Inspect the "password" section of "/etc/pam.d/system-auth", "/etc/pam.d/system-auth-ac", and other files in "/etc/pam.d" to identify the number of occurrences where the “pam_unix.so” module is used in the “password” section.
# $ grep -E -c 'password.*pam_unix.so' /etc/pam.d/*
#
# /etc/pam.d/atd:0
# /etc/pam.d/config-util:0
# /etc/pam.d/crond:0
# /etc/pam.d/login:0
# /etc/pam.d/other:0
# /etc/pam.d/passwd:0
# /etc/pam.d/password-auth:1
# /etc/pam.d/password-auth-ac:1
# /etc/pam.d/sshd:0
# /etc/pam.d/su:0
# /etc/pam.d/sudo:0
# /etc/pam.d/system-auth:1
# /etc/pam.d/system-auth-ac:1
# /etc/pam.d/vlock:0
#
# Note: The number adjacent to the file name indicates how many occurrences of the “pam_unix.so” module are found in the password section.
#
# If the “pam_unix.so” module is not defined in the “password” section of “/etc/pam.d/system-auth”, “/etc/pam.d/system-auth-ac”, “/etc/pam.d/password-auth”, and “/etc/pam.d/password-auth-ac” at a minimum, this is a finding.
#
# Verify that the “sha512” variable is used with each instance of the “pam_unix.so” module in the “password” section:
#
# $ grep password /etc/pam.d/* | grep pam_unix.so | grep sha512
#
# /etc/pam.d/password-auth:password    	sufficient    pam_unix.so sha512 [other arguments…]
# /etc/pam.d/password-auth-ac:password    sufficient    pam_unix.so sha512 [other arguments…]
# /etc/pam.d/system-auth:password    	sufficient    pam_unix.so sha512 [other arguments…]
# /etc/pam.d/system-auth-ac:password    	sufficient    pam_unix.so sha512 [other arguments…]
#
# If this list of files does not coincide with the previous command, this is a finding.
#
# If any of the identified “pam_unix.so” modules do not use the “sha512” variable, this is a finding.
#
# Fix Text: In "/etc/pam.d/system-auth”, "/etc/pam.d/system-auth-ac", “/etc/pam.d/password-auth”, and “/etc/pam.d/password-auth-ac”, among potentially other files, the "password" section of the files controls which PAM modules execute during a password change. Set the "pam_unix.so" module in the "password" section to include the argument "sha512", as shown below:
#
# password sufficient pam_unix.so sha512 [other arguments...]
#
# This will help ensure when local users change their passwords, hashes for the new passwords will be generated using the SHA-512 algorithm. This is the default.
#
# Note that any updates made to "/etc/pam.d/system-auth" will be overwritten by the "authconfig" program. The "authconfig" program should not be used.
#
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000803
# The information system implements mechanisms for authentication to a cryptographic module that meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance for such authentication.
# NIST SP 800-53 :: IA-7
# NIST SP 800-53A :: IA-7.1
# NIST SP 800-53 Revision 4 :: IA-7
#
#
- name: check stig_rhel6_v1r18 v_38574
  when: ['v_38574']|issubset(check_findings)


# Vuln ID: V-38576
# Severity: medium
# Group Title: SRG-OS-000120
# Rule ID: SV-50377r1_rule
# STIG ID: RHEL-06-000063
# Rule Title: The system must use a FIPS 140-2 approved cryptographic hashing algorithm for generating account password hashes (login.defs).
# Discussion: Using a stronger hashing algorithm makes password cracking attacks more difficult.
# IA Controls:
# Check Content: Inspect "/etc/login.defs" and ensure the following line appears:
#
# ENCRYPT_METHOD SHA512
#
#
# If it does not, this is a finding.
# Fix Text: In "/etc/login.defs", add or correct the following line to ensure the system will use SHA-512 as the hashing algorithm:
#
# ENCRYPT_METHOD SHA512
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000803
# The information system implements mechanisms for authentication to a cryptographic module that meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance for such authentication.
# NIST SP 800-53 :: IA-7
# NIST SP 800-53A :: IA-7.1
# NIST SP 800-53 Revision 4 :: IA-7
#
#
- name: check stig_rhel6_v1r18 v_38576
  when: ['v_38576']|issubset(check_findings)


# Vuln ID: V-38577
# Severity: medium
# Group Title: SRG-OS-000120
# Rule ID: SV-50378r1_rule
# STIG ID: RHEL-06-000064
# Rule Title: The system must use a FIPS 140-2 approved cryptographic hashing algorithm for generating account password hashes (libuser.conf).
# Discussion: Using a stronger hashing algorithm makes password cracking attacks more difficult.
# IA Controls:
# Check Content: Inspect "/etc/libuser.conf" and ensure the following line appears in the "[default]" section:
#
# crypt_style = sha512
#
#
# If it does not, this is a finding.
# Fix Text: In "/etc/libuser.conf", add or correct the following line in its "[defaults]" section to ensure the system will use the SHA-512 algorithm for password hashing:
#
# crypt_style = sha512
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000803
# The information system implements mechanisms for authentication to a cryptographic module that meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance for such authentication.
# NIST SP 800-53 :: IA-7
# NIST SP 800-53A :: IA-7.1
# NIST SP 800-53 Revision 4 :: IA-7
#
#
- name: check stig_rhel6_v1r18 v_38577
  when: ['v_38577']|issubset(check_findings)


# Vuln ID: V-38592
# Severity: medium
# Group Title: SRG-OS-000022
# Rule ID: SV-50393r4_rule
# STIG ID: RHEL-06-000356
# Rule Title: The system must require administrator action to unlock an account locked by excessive failed login attempts.
# Discussion: Locking out user accounts after a number of incorrect attempts prevents direct password guessing attacks. Ensuring that an administrator is involved in unlocking locked accounts draws appropriate attention to such situations.
# IA Controls:
# Check Content: To ensure the failed password attempt policy is configured correctly, run the following command:
#
# # grep pam_faillock /etc/pam.d/system-auth /etc/pam.d/password-auth
#
# The output should show "unlock_time=<some-large-number>"; the largest acceptable value is 604800 seconds (one week).
# If that is not the case, this is a finding.
# Fix Text: To configure the system to lock out accounts after a number of incorrect logon attempts and require an administrator to unlock the account using "pam_faillock.so", modify the content of both "/etc/pam.d/system-auth" and "/etc/pam.d/password-auth" as follows:
#
# Add the following line immediately before the "pam_unix.so" statement in the "AUTH" section:
#
# auth required pam_faillock.so preauth silent deny=3 unlock_time=604800 fail_interval=900
#
# Add the following line immediately after the "pam_unix.so" statement in the "AUTH" section:
#
# auth [default=die] pam_faillock.so authfail deny=3 unlock_time=604800 fail_interval=900
#
# Add the following line immediately before the "pam_unix.so" statement in the "ACCOUNT" section:
#
# account required pam_faillock.so
#
# Note that any updates made to "/etc/pam.d/system-auth" and "/etc/pam.d/password-auth" may be overwritten by the "authconfig" program.  The "authconfig" program should not be used.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000047
# The information system delays next login prompt according to organization defined delay algorithm, when the maximum number of unsuccessful attempts is exceeded, automatically locks the account/node for an organization defined time period or locks the account/node until released by an Administrator IAW organizational policy.
# NIST SP 800-53 :: AC-7 b
# NIST SP 800-53A :: AC-7.1 (iv)
#
#
- name: check stig_rhel6_v1r18 v_38592
  when: ['v_38592']|issubset(check_findings)


# Vuln ID: V-38595
# Severity: medium
# Group Title: SRG-OS-000105
# Rule ID: SV-50396r3_rule
# STIG ID: RHEL-06-000349
# Rule Title: The system must be configured to require the use of a CAC, PIV compliant hardware token, or Alternate Logon Token (ALT) for authentication.
# Discussion: Smart card login provides two-factor authentication stronger than that provided by a username/password combination. Smart cards leverage a PKI (public key infrastructure) in order to provide and verify credentials.
# IA Controls:
# Check Content: Interview the SA to determine if all accounts not exempted by policy are using CAC authentication. For DoD systems, the following systems and accounts are exempt from using smart card (CAC) authentication:
#
# Standalone systems
# Application accounts
# Temporary employee accounts, such as students or interns, who cannot easily receive a CAC or PIV
# Operational tactical locations that are not collocated with RAPIDS workstations to issue CAC or ALT
# Test systems, such as those with an Interim Approval to Test (IATT) and use a separate VPN, firewall, or security measure preventing access to network and system components from outside the protection boundary documented in the IATT.
#
#
#
# If non-exempt accounts are not using CAC authentication, this is a finding.
# Fix Text: To enable smart card authentication, consult the documentation at:
#
# https://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/6/html/Managing_Smart_Cards/enabling-smart-card-login.html
#
# For guidance on enabling SSH to authenticate against a Common Access Card (CAC), consult documentation at:
#
# https://access.redhat.com/solutions/82273
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000765
# The information system implements multifactor authentication for network access to privileged accounts.
# NIST SP 800-53 :: IA-2 (1)
# NIST SP 800-53A :: IA-2 (1).1
# NIST SP 800-53 Revision 4 :: IA-2 (1)
#
#
- name: check stig_rhel6_v1r18 v_38595
  when: ['v_38595']|issubset(check_findings)


# Vuln ID: V-38658
# Severity: medium
# Group Title: SRG-OS-000077
# Rule ID: SV-50459r5_rule
# STIG ID: RHEL-06-000274
# Rule Title: The system must prohibit the reuse of passwords within five iterations.
# Discussion: Preventing reuse of previous passwords helps ensure that a compromised password is not reused by a user.
# IA Controls:
# Check Content: To verify the password reuse setting is compliant, run the following command:
#
# # grep remember /etc/pam.d/system-auth
#
# The output must be a line beginning with "password required pam_pwhistory.so" or "password requisite pam_pwhistory.so" and end with "remember=5".
#
# If the line is commented out, the line does not contain the specified elements, or the value for "remember" is less than 5, this is a finding.
# Fix Text: Do not allow users to reuse recent passwords. This can be accomplished by using the "remember" option for the "pam_pwhistory" PAM module. In the file "/etc/pam.d/system-auth", append "remember=5" to the line which refers to the "pam_pwhistory.so" module, as shown:
#
# password required pam_pwhistory.so [existing_options] remember=5
#
# or
#
# password requisite pam_pwhistory.so [existing_options] remember=5
#
# The DoD requirement is five passwords.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000200
# The information system prohibits password reuse for the organization defined number of generations.
# NIST SP 800-53 :: IA-5 (1) (e)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (e)
#
#
- name: check stig_rhel6_v1r18 v_38658
  when: ['v_38658']|issubset(check_findings)


# Vuln ID: V-38675
# Severity: low
# Group Title: SRG-OS-999999
# Rule ID: SV-50476r2_rule
# STIG ID: RHEL-06-000308
# Rule Title: Process core dumps must be disabled unless needed.
# Discussion: A core dump includes a memory image taken at the time the operating system terminates an application. The memory image could contain sensitive data and is generally useful only for developers trying to debug problems.
# IA Controls:
# Check Content: To verify that core dumps are disabled for all users, run the following command:
#
# $ grep core /etc/security/limits.conf /etc/security/limits.d/*.conf
#
# The output should be:
#
# * hard core 0
#
# If it is not, this is a finding.
# Fix Text: To disable core dumps for all users, add the following line to "/etc/security/limits.conf":
#
# * hard core 0
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38675
  when: ['v_38675']|issubset(check_findings)


# Vuln ID: V-38681
# Severity: low
# Group Title: SRG-OS-999999
# Rule ID: SV-50482r2_rule
# STIG ID: RHEL-06-000294
# Rule Title: All GIDs referenced in /etc/passwd must be defined in /etc/group
# Discussion: Inconsistency in GIDs between /etc/passwd and /etc/group could lead to a user having unintended rights.
# IA Controls:
# Check Content: To ensure all GIDs referenced in /etc/passwd are defined in /etc/group, run the following command:
#
# # pwck -r | grep 'no group'
#
# There should be no output.
# If there is output, this is a finding.
# Fix Text: Add a group to the system for each GID referenced without a corresponding group.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38681
  when: ['v_38681']|issubset(check_findings)


# Vuln ID: V-38683
# Severity: low
# Group Title: SRG-OS-000121
# Rule ID: SV-50484r1_rule
# STIG ID: RHEL-06-000296
# Rule Title: All accounts on the system must have unique user or account names
# Discussion: Unique usernames allow for accountability on the system.
# IA Controls:
# Check Content: Run the following command to check for duplicate account names:
#
# # pwck -rq
#
# If there are no duplicate names, no line will be returned.
# If a line is returned, this is a finding.
# Fix Text: Change usernames, or delete accounts, so each has a unique name.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000804
# The information system uniquely identifies and authenticates non-organizational users (or processes acting on behalf of non-organizational users).
# NIST SP 800-53 :: IA-8
# NIST SP 800-53A :: IA-8.1
# NIST SP 800-53 Revision 4 :: IA-8
#
#
- name: check stig_rhel6_v1r18 v_38683
  when: ['v_38683']|issubset(check_findings)


# Vuln ID: V-38684
# Severity: low
# Group Title: SRG-OS-000027
# Rule ID: SV-50485r2_rule
# STIG ID: RHEL-06-000319
# Rule Title: The system must limit users to 10 simultaneous system logins, or a site-defined number, in accordance with operational requirements.
# Discussion: Limiting simultaneous user logins can insulate the system from denial of service problems caused by excessive logins. Automated login processes operating improperly or maliciously may result in an exceptional number of simultaneous login sessions.
# IA Controls:
# Check Content: Run the following command to ensure the "maxlogins" value is configured for all users on the system:
#
# $ grep "maxlogins" /etc/security/limits.conf /etc/security/limits.d/*.conf
#
# You should receive output similar to the following:
#
# * hard maxlogins 10
#
# If it is not similar, this is a finding.
# Fix Text: Limiting the number of allowed users and sessions per user can limit risks related to denial of service attacks. This addresses concurrent sessions for a single account and does not address concurrent sessions by a single user via multiple accounts. To set the number of concurrent sessions per user add the following line in "/etc/security/limits.conf":
#
# * hard maxlogins 10
#
# A documented site-defined number may be substituted for 10 in the above.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000054
# The information system limits the number of concurrent sessions for each organization-defined account and/or account type to an organization-defined number of sessions.
# NIST SP 800-53 :: AC-10
# NIST SP 800-53A :: AC-10.1 (ii)
# NIST SP 800-53 Revision 4 :: AC-10
#
#
- name: check stig_rhel6_v1r18 v_38684
  when: ['v_38684']|issubset(check_findings)


# Vuln ID: V-38685
# Severity: low
# Group Title: SRG-OS-000002
# Rule ID: SV-50486r1_rule
# STIG ID: RHEL-06-000297
# Rule Title: Temporary accounts must be provisioned with an expiration date.
# Discussion: When temporary accounts are created, there is a risk they may remain in place and active after the need for them no longer exists. Account expiration greatly reduces the risk of accounts being misused or hijacked.
# IA Controls:
# Check Content: For every temporary account, run the following command to obtain its account aging and expiration information:
#
# # chage -l [USER]
#
# Verify each of these accounts has an expiration date set as documented.
# If any temporary accounts have no expiration date set or do not expire within a documented time frame, this is a finding.
# Fix Text: In the event temporary accounts are required, configure the system to terminate them after a documented time period. For every temporary account, run the following command to set an expiration date on it, substituting "[USER]" and "[YYYY-MM-DD]" appropriately:
#
# # chage -E [YYYY-MM-DD] [USER]
#
# "[YYYY-MM-DD]" indicates the documented expiration date for the account.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000016
# The information system automatically removes or disables temporary accounts after an organization-defined time period for each type of account.
# NIST SP 800-53 :: AC-2 (2)
# NIST SP 800-53A :: AC-2 (2).1 (ii)
# NIST SP 800-53 Revision 4 :: AC-2 (2)
#
#
- name: check stig_rhel6_v1r18 v_38685
  when: ['v_38685']|issubset(check_findings)


# Vuln ID: V-38690
# Severity: low
# Group Title: SRG-OS-000123
# Rule ID: SV-50491r1_rule
# STIG ID: RHEL-06-000298
# Rule Title: Emergency accounts must be provisioned with an expiration date.
#
# Discussion: When emergency accounts are created, there is a risk they may remain in place and active after the need for them no longer exists. Account expiration greatly reduces the risk of accounts being misused or hijacked.
# IA Controls:
# Check Content: For every emergency account, run the following command to obtain its account aging and expiration information:
#
# # chage -l [USER]
#
# Verify each of these accounts has an expiration date set as documented.
# If any emergency accounts have no expiration date set or do not expire within a documented time frame, this is a finding.
# Fix Text: In the event emergency accounts are required, configure the system to terminate them after a documented time period. For every emergency account, run the following command to set an expiration date on it, substituting "[USER]" and "[YYYY-MM-DD]" appropriately:
#
# # chage -E [YYYY-MM-DD] [USER]
#
# "[YYYY-MM-DD]" indicates the documented expiration date for the account.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001682
# The information system automatically removes or disables emergency accounts after an organization-defined time period for each type of account.
# NIST SP 800-53 :: AC-2 (2)
# NIST SP 800-53A :: AC-2 (2).1 (ii)
# NIST SP 800-53 Revision 4 :: AC-2 (2)
#
#
- name: check stig_rhel6_v1r18 v_38690
  when: ['v_38690']|issubset(check_findings)


# Vuln ID: V-38692
# Severity: low
# Group Title: GEN006660
# Rule ID: SV-50493r1_rule
# STIG ID: RHEL-06-000334
# Rule Title: Accounts must be locked upon 35 days of inactivity.
# Discussion: Disabling inactive accounts ensures that accounts which may not have been responsibly removed are not available to attackers who may have compromised their credentials.
# IA Controls:
# Check Content: To verify the "INACTIVE" setting, run the following command:
#
# grep "INACTIVE" /etc/default/useradd
#
# The output should indicate the "INACTIVE" configuration option is set to an appropriate integer as shown in the example below:
#
# # grep "INACTIVE" /etc/default/useradd
# INACTIVE=35
#
# If it does not, this is a finding.
# Fix Text: To specify the number of days after a password expires (which signifies inactivity) until an account is permanently disabled, add or correct the following lines in "/etc/default/useradd", substituting "[NUM_DAYS]" appropriately:
#
# INACTIVE=[NUM_DAYS]
#
# A value of 35 is recommended. If a password is currently on the verge of expiration, then 35 days remain until the account is automatically disabled. However, if the password will not expire for another 60 days, then 95 days could elapse until the account would be automatically disabled. See the "useradd" man page for more information. Determining the inactivity timeout must be done with careful consideration of the length of a "normal" period of inactivity for users in the particular environment. Setting the timeout too low incurs support costs and also has the potential to impact availability of the system to legitimate users.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000017
# The information system automatically disables inactive accounts after an organization-defined time period.
# NIST SP 800-53 :: AC-2 (3)
# NIST SP 800-53A :: AC-2 (3).1 (ii)
# NIST SP 800-53 Revision 4 :: AC-2 (3)
#
#
- name: check stig_rhel6_v1r18 v_38692
  when: ['v_38692']|issubset(check_findings)


# Vuln ID: V-38693
# Severity: low
# Group Title: SRG-OS-999999
# Rule ID: SV-50494r2_rule
# STIG ID: RHEL-06-000299
# Rule Title: The system must require passwords to contain no more than three consecutive repeating characters.
# Discussion: Passwords with excessive repeating characters may be more vulnerable to password-guessing attacks.
# IA Controls:
# Check Content: To check the maximum value for consecutive repeating characters, run the following command:
#
# $ grep pam_cracklib /etc/pam.d/system-auth
#
# Look for the value of the "maxrepeat" parameter. The DoD requirement is 3.
# If maxrepeat is not found or not set to the required value, this is a finding.
# Fix Text: The pam_cracklib module's "maxrepeat" parameter controls requirements for consecutive repeating characters. When set to a positive number, it will reject passwords which contain more than that number of consecutive characters. Add "maxrepeat=3" after pam_cracklib.so to prevent a run of (3 + 1) or more identical characters.
#
# password required pam_cracklib.so maxrepeat=3
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38693
  when: ['v_38693']|issubset(check_findings)


# Vuln ID: V-38694
# Severity: low
# Group Title: SRG-OS-000118
# Rule ID: SV-50495r1_rule
# STIG ID: RHEL-06-000335
# Rule Title: The operating system must manage information system identifiers for users and devices by disabling the user identifier after an organization defined time period of inactivity.
# Discussion: Disabling inactive accounts ensures that accounts which may not have been responsibly removed are not available to attackers who may have compromised their credentials.
# IA Controls:
# Check Content: To verify the "INACTIVE" setting, run the following command:
#
# grep "INACTIVE" /etc/default/useradd
#
# The output should indicate the "INACTIVE" configuration option is set to an appropriate integer as shown in the example below:
#
# # grep "INACTIVE" /etc/default/useradd
# INACTIVE=35
#
# If it does not, this is a finding.
# Fix Text: To specify the number of days after a password expires (which signifies inactivity) until an account is permanently disabled, add or correct the following lines in "/etc/default/useradd", substituting "[NUM_DAYS]" appropriately:
#
# INACTIVE=[NUM_DAYS]
#
# A value of 35 is recommended. If a password is currently on the verge of expiration, then 35 days remain until the account is automatically disabled. However, if the password will not expire for another 60 days, then 95 days could elapse until the account would be automatically disabled. See the "useradd" man page for more information. Determining the inactivity timeout must be done with careful consideration of the length of a "normal" period of inactivity for users in the particular environment. Setting the timeout too low incurs support costs and also has the potential to impact availability of the system to legitimate users.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000795
# The organization manages information system identifiers by disabling the identifier after an organization defined time period of inactivity.
# NIST SP 800-53 :: IA-4 e
# NIST SP 800-53A :: IA-4.1 (iii)
# NIST SP 800-53 Revision 4 :: IA-4 e
#
#
- name: check stig_rhel6_v1r18 v_38694
  when: ['v_38694']|issubset(check_findings)


# Vuln ID: V-51875
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-66089r1_rule
# STIG ID: RHEL-06-000372
# Rule Title: The operating system, upon successful logon/access, must display to the user the number of unsuccessful logon/access attempts since the last successful logon/access.
# Discussion: Users need to be aware of activity that occurs regarding their account. Providing users with information regarding the number of unsuccessful attempts that were made to login to their account allows the user to determine if any unauthorized activity has occurred and gives them an opportunity to notify administrators.
# IA Controls:
# Check Content: To ensure that last logon/access notification is configured correctly, run the following command:
#
# # grep pam_lastlog.so /etc/pam.d/system-auth
#
# The output should show output "showfailed". If that is not the case, this is a finding.
# Fix Text: To configure the system to notify users of last logon/access using "pam_lastlog", add the following line immediately after "session required pam_limits.so":
#
# session required pam_lastlog.so showfailed
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_51875
  when: ['v_51875']|issubset(check_findings)


# Vuln ID: V-58901
# Severity: medium
# Group Title: SRG-OS-000373
# Rule ID: SV-73331r2_rule
# STIG ID: RHEL-06-000529
# Rule Title: The sudo command must require authentication.
# Discussion: The "sudo" command allows authorized users to run programs (including shells) as other users, system users, and root. The "/etc/sudoers" file is used to configure authorized "sudo" users as well as the programs they are allowed to run. Some configuration options in the "/etc/sudoers" file allow configured users to run programs without re-authenticating. Use of these configuration options makes it easier for one compromised account to be used to compromise other accounts.
# IA Controls:
# Check Content: If passwords are not being used for authentication, this is Not Applicable.
#
# Verify neither the "NOPASSWD" option nor the "!authenticate" option is configured for use in "/etc/sudoers" and associated files. Note that the "#include" and "#includedir" directives may be used to include configuration data from locations other than the defaults enumerated here.
#
# # egrep '^[^#]*NOPASSWD' /etc/sudoers /etc/sudoers.d/*
# # egrep '^[^#]*!authenticate' /etc/sudoers /etc/sudoers.d/*
#
# If the "NOPASSWD" or "!authenticate" options are configured for use in "/etc/sudoers" or associated files, this is a finding.
# Fix Text: Update the "/etc/sudoers" or other sudo configuration files to remove or comment out lines utilizing the "NOPASSWD" and "!authenticate" options.
#
# # visudo
# # visudo -f [other sudo configuration file]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-002038
# The organization requires users to reauthenticate when organization-defined circumstances or situations requiring reauthentication.
# NIST SP 800-53 Revision 4 :: IA-11
#
#
- name: check stig_rhel6_v1r18 v_58901
  when: ['v_58901']|issubset(check_findings)
