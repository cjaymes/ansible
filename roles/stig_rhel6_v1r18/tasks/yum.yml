# Vuln ID: V-38476
# Severity: high
# Group Title: SRG-OS-000090
# Rule ID: SV-50276r3_rule
# STIG ID: RHEL-06-000008
# Rule Title: Vendor-provided cryptographic certificates must be installed to verify the integrity of system software.
# Discussion: The Red Hat GPG keys are necessary to cryptographically verify packages are from Red Hat.
# IA Controls:
# Check Content: To ensure that the GPG keys are installed, run:
#
# $ rpm -q gpg-pubkey
#
# The command should return the strings below:
#
# gpg-pubkey-fd431d51-4ae0493b
# gpg-pubkey-2fa658e0-45700c69
#
# If the Red Hat GPG Keys are not installed, this is a finding.
# Fix Text: To ensure the system can cryptographically verify base software packages come from Red Hat (and to connect to the Red Hat Network to receive them), the Red Hat GPG keys must be installed properly. To install the Red Hat GPG keys, run:
#
# # rhn_register
#
# If the system is not connected to the Internet or an RHN Satellite, then install the Red Hat GPG keys from trusted media such as the Red Hat installation CD-ROM or DVD. Assuming the disc is mounted in "/media/cdrom", use the following command as the root user to import them into the keyring:
#
# # rpm --import /media/cdrom/RPM-GPG-KEY
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000352
# The information system prevents the installation of organization defined critical software programs that are not signed with a certificate that is recognized and approved by the organization.
# NIST SP 800-53 :: CM-5 (3)
# NIST SP 800-53A :: CM-5 (3).1 (ii)
#
#
- name: check stig_rhel6_v1r18 v_38476
  set_fact:
    stig_rhel6_v1r18_v_38476_result: 'fail'
  when: '"v_38476" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38483
# Severity: medium
# Group Title: SRG-OS-000103
# Rule ID: SV-50283r1_rule
# STIG ID: RHEL-06-000013
# Rule Title: The system package management tool must cryptographically verify the authenticity of system software packages during installation.
# Discussion: Ensuring the validity of packages' cryptographic signatures prior to installation ensures the provenance of the software and protects against malicious tampering.
# IA Controls:
# Check Content: To determine whether "yum" is configured to use "gpgcheck", inspect "/etc/yum.conf" and ensure the following appears in the "[main]" section:
#
# gpgcheck=1
#
# A value of "1" indicates that "gpgcheck" is enabled. Absence of a "gpgcheck" line or a setting of "0" indicates that it is disabled.
# If GPG checking is not enabled, this is a finding.
#
# If the "yum" system package management tool is not used to update the system, verify with the SA that installed packages are cryptographically signed.
# Fix Text: The "gpgcheck" option should be used to ensure checking of an RPM package's signature always occurs prior to its installation. To configure yum to check package signatures before installing them, ensure the following line appears in "/etc/yum.conf" in the "[main]" section:
#
# gpgcheck=1
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000663
# The organization (or information system) enforces explicit rules governing the installation of software by users.
# NIST SP 800-53 :: SA-7
# NIST SP 800-53A :: SA-7.1 (ii)
#
#
- name: check stig_rhel6_v1r18 v_38483
  set_fact:
    stig_rhel6_v1r18_v_38483_result: 'fail'
  when: '"v_38483" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38487
# Severity: low
# Group Title: SRG-OS-000103
# Rule ID: SV-50288r1_rule
# STIG ID: RHEL-06-000015
# Rule Title: The system package management tool must cryptographically verify the authenticity of all software packages during installation.
# Discussion: Ensuring all packages' cryptographic signatures are valid prior to installation ensures the provenance of the software and protects against malicious tampering.
# IA Controls:
# Check Content: To determine whether "yum" has been configured to disable "gpgcheck" for any repos, inspect all files in "/etc/yum.repos.d" and ensure the following does not appear in any sections:
#
# gpgcheck=0
#
# A value of "0" indicates that "gpgcheck" has been disabled for that repo.
# If GPG checking is disabled, this is a finding.
#
# If the "yum" system package management tool is not used to update the system, verify with the SA that installed packages are cryptographically signed.
# Fix Text: To ensure signature checking is not disabled for any repos, remove any lines from files in "/etc/yum.repos.d" of the form:
#
# gpgcheck=0
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000663
# The organization (or information system) enforces explicit rules governing the installation of software by users.
# NIST SP 800-53 :: SA-7
# NIST SP 800-53A :: SA-7.1 (ii)
#
#
- name: check stig_rhel6_v1r18 v_38487
  set_fact:
    stig_rhel6_v1r18_v_38487_result: 'fail'
  when: '"v_38487" in stig_rhel6_v1r18_checks'
