# Vuln ID: V-38446
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50246r2_rule
# STIG ID: RHEL-06-000521
# Rule Title: The mail system must forward all mail for root to one or more system administrators.
# Discussion: A number of system services utilize email messages sent to the root user to notify system administrators of active or impending issues.  These messages must be forwarded to at least one monitored email address.
# IA Controls:
# Check Content: Find the list of alias maps used by the Postfix mail server:
#
# # postconf alias_maps
#
# Query the Postfix alias maps for an alias for "root":
#
# # postmap -q root hash:/etc/aliases
#
# If there are no aliases configured for root that forward to a monitored email address, this is a finding.
# Fix Text: Set up an alias for root that forwards to a monitored email address:
#
# # echo "root: <system.administrator>@mail.mil" >> /etc/aliases
# # newaliases
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38446
  set_fact: stig_rhel6_v1r18_v_38446_result = 'fail'
  when: '"v_38446" in check_findings'


# Vuln ID: V-38622
# Severity: medium
# Group Title: SRG-OS-000096
# Rule ID: SV-50423r2_rule
# STIG ID: RHEL-06-000249
# Rule Title: Mail relaying must be restricted.
# Discussion: This ensures "postfix" accepts mail messages (such as cron job reports) from the local system only, and not from the network, which protects it from network attack.
# IA Controls:
# Check Content: If the system is an authorized mail relay host, this is not applicable.
#
# Run the following command to ensure postfix accepts mail messages from only the local system:
#
# $ grep inet_interfaces /etc/postfix/main.cf
#
# If properly configured, the output should show only "localhost".
# If it does not, this is a finding.
# Fix Text: Edit the file "/etc/postfix/main.cf" to ensure that only the following "inet_interfaces" line appears:
#
# inet_interfaces = localhost
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000382
# The organization configures the information system to prohibit or restrict the use of organization defined functions, ports, protocols, and/or services.
# NIST SP 800-53 :: CM-7
# NIST SP 800-53A :: CM-7.1 (iii)
# NIST SP 800-53 Revision 4 :: CM-7 b
#
#
- name: check stig_rhel6_v1r18 v_38622
  set_fact: stig_rhel6_v1r18_v_38622_result = 'fail'
  when: '"v_38622" in check_findings'


# Vuln ID: V-38669
# Severity: low
# Group Title: SRG-OS-999999
# Rule ID: SV-50470r1_rule
# STIG ID: RHEL-06-000287
# Rule Title: The postfix service must be enabled for mail delivery.
# Discussion: Local mail delivery is essential to some system maintenance and notification tasks.
# IA Controls:
# Check Content: Run the following command to determine the current status of the "postfix" service:
#
# # service postfix status
#
# If the service is enabled, it should return the following:
#
# postfix is running...
#
# If the service is not enabled, this is a finding.
# Fix Text: The Postfix mail transfer agent is used for local mail delivery within the system. The default configuration only listens for connections to the default SMTP port (port 25) on the loopback interface (127.0.0.1). It is recommended to leave this service enabled for local mail delivery. The "postfix" service can be enabled with the following command:
#
# # chkconfig postfix on
# # service postfix start
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38669
  set_fact: stig_rhel6_v1r18_v_38669_result = 'fail'
  when: '"v_38669" in check_findings'
