# Vuln ID: V-38447
# Severity: low
# Group Title: SRG-OS-999999
# Rule ID: SV-50247r4_rule
# STIG ID: RHEL-06-000519
# Rule Title: The system package management tool must verify contents of all files associated with packages.
# Discussion: The hash on important files like system executables should match the information given by the RPM database. Executables with erroneous hashes could be a sign of nefarious activity on the system.
# IA Controls:
# Check Content: The following command will list which files on the system have file hashes different from what is expected by the RPM database:
#
# # rpm -Va | awk '$1 ~ /..5/ && $2 != "c"'
#
# If there is any output from the command for system binaries, verify that the changes were due to STIG application and have been documented with the ISSO.
#
# If there are changes to system binaries and they are not documented with the ISSO, this is a finding.
#
# Fix Text: The RPM package management system can check the hashes of installed software packages, including many that are important to system security. Run the following command to list which files on the system have hashes that differ from what is expected by the RPM database:
#
# # rpm -Va | awk '$1 ~ /..5/ && $2 != "c"'
#
# If the file that has changed was not expected to, refresh from distribution media or online repositories.
#
# rpm -Uvh [affected_package]
#
# OR
#
# yum reinstall [affected_package]
#
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38447
  set_fact:
    stig_rhel6_v1r18_v_38447_result: 'fail'
  when: '"v_38447" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38452
# Severity: low
# Group Title: SRG-OS-999999
# Rule ID: SV-50252r2_rule
# STIG ID: RHEL-06-000518
# Rule Title: The system package management tool must verify permissions on all files and directories associated with packages.
# Discussion: Permissions on system binaries and configuration files that are too generous could allow an unauthorized user to gain privileges that they should not have. The permissions set by the vendor should be maintained. Any deviations from this baseline should be investigated.
# IA Controls:
# Check Content: The following command will list which files and directories on the system have permissions different from what is expected by the RPM database:
#
# # rpm -Va  | grep '^.M'
#
# If there is any output, for each file or directory found, find the associated RPM package and compare the RPM-expected permissions with the actual permissions on the file or directory:
#
# # rpm -qf [file or directory name]
# # rpm -q --queryformat "[%{FILENAMES} %{FILEMODES:perms}\n]" [package] | grep  [filename]
# # ls -dlL [filename]
#
# If the existing permissions are more permissive than those expected by RPM, this is a finding.
# Fix Text: The RPM package management system can restore file access permissions of package files and directories. The following command will update permissions on files and directories with permissions different from what is expected by the RPM database:
#
# # rpm --setperms [package]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38452
  set_fact:
    stig_rhel6_v1r18_v_38452_result: 'fail'
  when: '"v_38452" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38453
# Severity: low
# Group Title: SRG-OS-999999
# Rule ID: SV-50253r2_rule
# STIG ID: RHEL-06-000517
# Rule Title: The system package management tool must verify group-ownership on all files and directories associated with packages.
# Discussion: Group-ownership of system binaries and configuration files that is incorrect could allow an unauthorized user to gain privileges that they should not have. The group-ownership set by the vendor should be maintained. Any deviations from this baseline should be investigated.
# IA Controls:
# Check Content: The following command will list which files on the system have group-ownership different from what is expected by the RPM database:
#
# # rpm -Va | grep '^......G'
#
#
# If any output is produced, verify that the changes were due to STIG application and have been documented with the ISSO.
#
# If any output has not been documented with the ISSO, this is a finding.
#
# Fix Text: The RPM package management system can restore group-ownership of the package files and directories. The following command will update files and directories with group-ownership different from what is expected by the RPM database:
#
# # rpm -qf [file or directory name]
# # rpm --setugids [package]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38453
  set_fact:
    stig_rhel6_v1r18_v_38453_result: 'fail'
  when: '"v_38453" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38454
# Severity: low
# Group Title: SRG-OS-999999
# Rule ID: SV-50254r2_rule
# STIG ID: RHEL-06-000516
# Rule Title: The system package management tool must verify ownership on all files and directories associated with packages.
# Discussion: Ownership of system binaries and configuration files that is incorrect could allow an unauthorized user to gain privileges that they should not have. The ownership set by the vendor should be maintained. Any deviations from this baseline should be investigated.
# IA Controls:
# Check Content: The following command will list which files on the system have ownership different from what is expected by the RPM database:
#
# # rpm -Va | grep '^.....U'
#
#
# If any output is produced, verify that the changes were due to STIG application and have been documented with the ISSO.
#
# If any output has not been documented with the ISSO, this is a finding.
#
# Fix Text: The RPM package management system can restore ownership of package files and directories. The following command will update files and directories with ownership different from what is expected by the RPM database:
#
# # rpm -qf [file or directory name]
# # rpm --setugids [package]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38454
  set_fact:
    stig_rhel6_v1r18_v_38454_result: 'fail'
  when: '"v_38454" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38465
# Severity: medium
# Group Title: SRG-OS-000259
# Rule ID: SV-50265r3_rule
# STIG ID: RHEL-06-000045
# Rule Title: Library files must have mode 0755 or less permissive.
# Discussion: Files from shared library directories are loaded into the address space of processes (including privileged ones) or of the kernel itself at runtime. Restrictive permissions are necessary to protect the integrity of the system.
# IA Controls:
# Check Content: System-wide shared library files, which are linked to executables during process load time or run time, are stored in the following directories by default:
#
# /lib
# /lib64
# /usr/lib
# /usr/lib64
#
#
# Kernel modules, which can be added to the kernel during runtime, are stored in "/lib/modules". All files in these directories should not be group-writable or world-writable. To find shared libraries that are group-writable or world-writable, run the following command for each directory [DIR] which contains shared libraries:
#
# $ find -L [DIR] -perm /022 -type f
#
#
# If any of these files (excluding broken symlinks) are group-writable or world-writable, this is a finding.
# Fix Text: System-wide shared library files, which are linked to executables during process load time or run time, are stored in the following directories by default:
#
# /lib
# /lib64
# /usr/lib
# /usr/lib64
#
# If any file in these directories is found to be group-writable or world-writable, correct its permission with the following command:
#
# # chmod go-w [FILE]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001499
# The organization limits privileges to change software resident within software libraries.
# NIST SP 800-53 :: CM-5 (6)
# NIST SP 800-53A :: CM-5 (6).1
# NIST SP 800-53 Revision 4 :: CM-5 (6)
#
#
- name: check stig_rhel6_v1r18 v_38465
  set_fact:
    stig_rhel6_v1r18_v_38465_result: 'fail'
  when: '"v_38465" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38466
# Severity: medium
# Group Title: SRG-OS-000259
# Rule ID: SV-50266r4_rule
# STIG ID: RHEL-06-000046
# Rule Title: Library files must be owned by a system account.
# Discussion: Files from shared library directories are loaded into the address space of processes (including privileged ones) or of the kernel itself at runtime. Proper ownership is necessary to protect the integrity of the system.
# IA Controls:
# Check Content: System-wide shared library files, which are linked to executables during process load time or run time, are stored in the following directories by default:
#
# /lib
# /lib64
# /usr/lib
# /usr/lib64
# /usr/local/lib
# /usr/local/lib64
#
# Kernel modules, which can be added to the kernel during runtime, are stored in "/lib/modules". All files in these directories should not be group-writable or world-writable.  To find shared libraries that are not owned by "root" and do not match what is expected by the RPM, run the following command:
#
# for i in /lib /lib64 /usr/lib /usr/lib64
# do
#   for j in `find -L $i \! -user root`
#   do
#     rpm -V -f $j | grep '^.....U'
#   done
# done
#
#
# If the command returns any results, this is a finding.
# Fix Text: System-wide shared library files, which are linked to executables during process load time or run time, are stored in the following directories by default:
#
# /lib
# /lib64
# /usr/lib
# /usr/lib64
# /usr/local/lib
# /usr/local/lib64
#
# If any file in these directories is found to be owned by a user other than “root” and does not match what is expected by the RPM, correct its ownership by running one of the following commands:
#
#
# # rpm --setugids [PACKAGE_NAME]
#
# Or
#
# # chown root [FILE]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001499
# The organization limits privileges to change software resident within software libraries.
# NIST SP 800-53 :: CM-5 (6)
# NIST SP 800-53A :: CM-5 (6).1
# NIST SP 800-53 Revision 4 :: CM-5 (6)
#
#
- name: check stig_rhel6_v1r18 v_38466
  set_fact:
    stig_rhel6_v1r18_v_38466_result: 'fail'
  when: '"v_38466" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38469
# Severity: medium
# Group Title: SRG-OS-000259
# Rule ID: SV-50269r3_rule
# STIG ID: RHEL-06-000047
# Rule Title: All system command files must have mode 755 or less permissive.
# Discussion: System binaries are executed by privileged users, as well as system services, and restrictive permissions are necessary to ensure execution of these programs cannot be co-opted.
# IA Controls:
# Check Content: System executables are stored in the following directories by default:
#
# /bin
# /usr/bin
# /usr/local/bin
# /sbin
# /usr/sbin
# /usr/local/sbin
#
# All files in these directories should not be group-writable or world-writable. To find system executables that are group-writable or world-writable, run the following command for each directory [DIR] which contains system executables:
#
# $ find -L [DIR] -perm /022 -type f
#
# If any system executables are found to be group-writable or world-writable, this is a finding.
# Fix Text: System executables are stored in the following directories by default:
#
# /bin
# /usr/bin
# /usr/local/bin
# /sbin
# /usr/sbin
# /usr/local/sbin
#
# If any file in these directories is found to be group-writable or world-writable, correct its permission with the following command:
#
# # chmod go-w [FILE]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001499
# The organization limits privileges to change software resident within software libraries.
# NIST SP 800-53 :: CM-5 (6)
# NIST SP 800-53A :: CM-5 (6).1
# NIST SP 800-53 Revision 4 :: CM-5 (6)
#
#
- name: check stig_rhel6_v1r18 v_38469
  set_fact:
    stig_rhel6_v1r18_v_38469_result: 'fail'
  when: '"v_38469" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38472
# Severity: medium
# Group Title: SRG-OS-000259
# Rule ID: SV-50272r1_rule
# STIG ID: RHEL-06-000048
# Rule Title: All system command files must be owned by root.
# Discussion: System binaries are executed by privileged users as well as system services, and restrictive permissions are necessary to ensure that their execution of these programs cannot be co-opted.
# IA Controls:
# Check Content: System executables are stored in the following directories by default:
#
# /bin
# /usr/bin
# /usr/local/bin
# /sbin
# /usr/sbin
# /usr/local/sbin
#
# All files in these directories should not be group-writable or world-writable. To find system executables that are not owned by "root", run the following command for each directory [DIR] which contains system executables:
#
# $ find -L [DIR] \! -user root
#
#
# If any system executables are found to not be owned by root, this is a finding.
# Fix Text: System executables are stored in the following directories by default:
#
# /bin
# /usr/bin
# /usr/local/bin
# /sbin
# /usr/sbin
# /usr/local/sbin
#
# If any file [FILE] in these directories is found to be owned by a user other than root, correct its ownership with the following command:
#
# # chown root [FILE]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001499
# The organization limits privileges to change software resident within software libraries.
# NIST SP 800-53 :: CM-5 (6)
# NIST SP 800-53A :: CM-5 (6).1
# NIST SP 800-53 Revision 4 :: CM-5 (6)
#
#
- name: check stig_rhel6_v1r18 v_38472
  set_fact:
    stig_rhel6_v1r18_v_38472_result: 'fail'
  when: '"v_38472" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38518
# Severity: medium
# Group Title: SRG-OS-000206
# Rule ID: SV-50319r2_rule
# STIG ID: RHEL-06-000133
# Rule Title: All rsyslog-generated log files must be owned by root.
# Discussion: The log files generated by rsyslog contain valuable information regarding system configuration, user authentication, and other such information. Log files should be protected from unauthorized access.
# IA Controls:
# Check Content: The owner of all log files written by "rsyslog" should be root. These log files are determined by the second part of each Rule line in "/etc/rsyslog.conf" and typically all appear in "/var/log". To see the owner of a given log file, run the following command:
#
# $ ls -l [LOGFILE]
#
# Some log files referenced in /etc/rsyslog.conf may be created by other programs and may require exclusion from consideration.
#
# If the owner is not root, this is a finding.
# Fix Text: The owner of all log files written by "rsyslog" should be root. These log files are determined by the second part of each Rule line in "/etc/rsyslog.conf" typically all appear in "/var/log". For each log file [LOGFILE] referenced in "/etc/rsyslog.conf", run the following command to inspect the file's owner:
#
# $ ls -l [LOGFILE]
#
# If the owner is not "root", run the following command to correct this:
#
# # chown root [LOGFILE]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001314
# The information system reveals error messages only to organization-defined personnel or roles.
# NIST SP 800-53 :: SI-11 c
# NIST SP 800-53A :: SI-11.1 (iv)
# NIST SP 800-53 Revision 4 :: SI-11 b
#
#
- name: check stig_rhel6_v1r18 v_38518
  set_fact:
    stig_rhel6_v1r18_v_38518_result: 'fail'
  when: '"v_38518" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38519
# Severity: medium
# Group Title: SRG-OS-000206
# Rule ID: SV-50320r2_rule
# STIG ID: RHEL-06-000134
# Rule Title: All rsyslog-generated log files must be group-owned by root.
# Discussion: The log files generated by rsyslog contain valuable information regarding system configuration, user authentication, and other such information. Log files should be protected from unauthorized access.
# IA Controls:
# Check Content: The group-owner of all log files written by "rsyslog" should be root. These log files are determined by the second part of each Rule line in "/etc/rsyslog.conf" and typically all appear in "/var/log". To see the group-owner of a given log file, run the following command:
#
# $ ls -l [LOGFILE]
#
# Some log files referenced in /etc/rsyslog.conf may be created by other programs and may require exclusion from consideration.
#
# If the group-owner is not root, this is a finding.
# Fix Text: The group-owner of all log files written by "rsyslog" should be root. These log files are determined by the second part of each Rule line in "/etc/rsyslog.conf" and typically all appear in "/var/log". For each log file [LOGFILE] referenced in "/etc/rsyslog.conf", run the following command to inspect the file's group owner:
#
# $ ls -l [LOGFILE]
#
# If the owner is not "root", run the following command to correct this:
#
# # chgrp root [LOGFILE]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001314
# The information system reveals error messages only to organization-defined personnel or roles.
# NIST SP 800-53 :: SI-11 c
# NIST SP 800-53A :: SI-11.1 (iv)
# NIST SP 800-53 Revision 4 :: SI-11 b
#
#
- name: check stig_rhel6_v1r18 v_38519
  set_fact:
    stig_rhel6_v1r18_v_38519_result: 'fail'
  when: '"v_38519" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38623
# Severity: medium
# Group Title: SRG-OS-000206
# Rule ID: SV-50424r2_rule
# STIG ID: RHEL-06-000135
# Rule Title: All rsyslog-generated log files must have mode 0600 or less permissive.
# Discussion: Log files can contain valuable information regarding system configuration. If the system log files are not protected, unauthorized users could change the logged data, eliminating their forensic value.
# IA Controls:
# Check Content: The file permissions for all log files written by rsyslog should be set to 600, or more restrictive. These log files are determined by the second part of each Rule line in "/etc/rsyslog.conf" and typically all appear in "/var/log". For each log file [LOGFILE] referenced in "/etc/rsyslog.conf", run the following command to inspect the file's permissions:
#
# $ ls -l [LOGFILE]
#
# The permissions should be 600, or more restrictive. Some log files referenced in /etc/rsyslog.conf may be created by other programs and may require exclusion from consideration.
#
# If the permissions are not correct, this is a finding.
# Fix Text: The file permissions for all log files written by rsyslog should be set to 600, or more restrictive. These log files are determined by the second part of each Rule line in "/etc/rsyslog.conf" and typically all appear in "/var/log". For each log file [LOGFILE] referenced in "/etc/rsyslog.conf", run the following command to inspect the file's permissions:
#
# $ ls -l [LOGFILE]
#
# If the permissions are not 600 or more restrictive, run the following command to correct this:
#
# # chmod 0600 [LOGFILE]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001314
# The information system reveals error messages only to organization-defined personnel or roles.
# NIST SP 800-53 :: SI-11 c
# NIST SP 800-53A :: SI-11.1 (iv)
# NIST SP 800-53 Revision 4 :: SI-11 b
#
#
- name: check stig_rhel6_v1r18 v_38623
  set_fact:
    stig_rhel6_v1r18_v_38623_result: 'fail'
  when: '"v_38623" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38643
# Severity: medium
# Group Title: SRG-OS-999999
# Rule ID: SV-50444r3_rule
# STIG ID: RHEL-06-000282
# Rule Title: There must be no world-writable files on the system.
# Discussion: Data in world-writable files can be modified by any user on the system. In almost all circumstances, files can be configured using a combination of user and group permissions to support whatever legitimate access is needed without the risk caused by world-writable files.
# IA Controls:
# Check Content: To find world-writable files, run the following command for each local partition [PART], excluding special filesystems such as /selinux, /proc, or /sys:
#
# # find [PART] -xdev -type f -perm -002
#
# If there is output, this is a finding.
# Fix Text: It is generally a good idea to remove global (other) write access to a file when it is discovered. However, check with documentation for specific applications before making changes. Also, monitor for recurring world-writable files, as these may be symptoms of a misconfigured application or user account.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38643
  set_fact:
    stig_rhel6_v1r18_v_38643_result: 'fail'
  when: '"v_38643" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38697
# Severity: low
# Group Title: SRG-OS-999999
# Rule ID: SV-50498r2_rule
# STIG ID: RHEL-06-000336
# Rule Title: The sticky bit must be set on all public directories.
# Discussion: Failing to set the sticky bit on public directories allows unauthorized users to delete files in the directory structure.
#
# The only authorized public directories are those temporary directories supplied with the system, or those designed to be temporary file repositories. The setting is normally reserved for directories used by the system, and by users for temporary file storage - such as /tmp - and for directories requiring global read/write access.
# IA Controls:
# Check Content: To find world-writable directories that lack the sticky bit, run the following command for each local partition [PART]:
#
# # find [PART] -xdev -type d -perm -002 \! -perm -1000
#
#
# If any world-writable directories are missing the sticky bit, this is a finding.
# Fix Text: When the so-called 'sticky bit' is set on a directory, only the owner of a given file may remove that file from the directory. Without the sticky bit, any user with write access to a directory may remove any file in the directory. Setting the sticky bit prevents users from removing each other's files. In cases where there is no reason for a directory to be world-writable, a better solution is to remove that permission rather than to set the sticky bit. However, if a directory is used by a particular application, consult that application's documentation instead of blindly changing modes.
# To set the sticky bit on a world-writable directory [DIR], run the following command:
#
# # chmod +t [DIR]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38697
  set_fact:
    stig_rhel6_v1r18_v_38697_result: 'fail'
  when: '"v_38697" in stig_rhel6_v1r18_checks'


# Vuln ID: V-38699
# Severity: low
# Group Title: SRG-OS-999999
# Rule ID: SV-50500r2_rule
# STIG ID: RHEL-06-000337
# Rule Title: All public directories must be owned by a system account.
# Discussion: Allowing a user account to own a world-writable directory is undesirable because it allows the owner of that directory to remove or replace any files that may be placed in the directory by other users.
# IA Controls:
# Check Content: The following command will discover and print world-writable directories that are not owned by a system account, given the assumption that only system accounts have a uid lower than 500. Run it once for each local partition [PART]:
#
# # find [PART] -xdev -type d -perm -0002 -uid +499 -print
#
#
# If there is output, this is a finding.
# Fix Text: All directories in local partitions which are world-writable should be owned by root or another system account. If any world-writable directories are not owned by a system account, this should be investigated. Following this, the files should be deleted or assigned to an appropriate group.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 6 Security Technical Implementation Guide :: Release: 18 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel6_v1r18 v_38699
  set_fact:
    stig_rhel6_v1r18_v_38699_result: 'fail'
  when: '"v_38699" in stig_rhel6_v1r18_checks'
