- name: check for /etc/audisp/audisp-remote.conf
  stat:
      path: /etc/audisp/audisp-remote.conf
  register: audisp_remote_conf

- name: audisp_remote_conf
  debug:
    msg: '{{audisp_remote_conf}}'

- name: check for /etc/audit/auditd.conf
  stat:
      path: /etc/audit/auditd.conf
  register: auditd_conf

- name: auditd_conf
  debug:
    msg: '{{auditd_conf}}'


# Vuln ID: V-72079
# Severity: high
# Group Title: SRG-OS-000038-GPOS-00016
# Rule ID: SV-86703r2_rule
# STIG ID: RHEL-07-030000
# Rule Title: Auditing must be configured to produce records containing information to establish what type of events occurred, where the events occurred, the source of the events, and the outcome of the events.
#
# These audit records must also identify individual identities of group account users.
# Discussion: Without establishing what type of events occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.
#
# Audit record content that may be necessary to satisfy this requirement includes, for example, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.
#
# Associating event types with detected events in the operating system audit logs provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured operating system.
#
# Satisfies: SRG-OS-000038-GPOS-00016, SRG-OS-000039-GPOS-00017, SRG-OS-000042-GPOS-00021, SRG-OS-000254-GPOS-00095, SRG-OS-000255-GPOS-00096
# IA Controls:
# Check Content: Verify the operating system produces audit records containing information to establish when (date and time) the events occurred.
#
# Check to see if auditing is active by issuing the following command:
#
# # systemctl is-active auditd.service
# Active: active (running) since Tue 2015-01-27 19:41:23 EST; 22h ago
#
# If the "auditd" status is not active, this is a finding.
# Fix Text: Configure the operating system to produce audit records containing information to establish when (date and time) the events occurred.
#
# Enable the auditd service with the following command:
#
# # systemctl start auditd.service
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000126
# The organization determines that the organization-defined subset of the auditable events defined in AU-2 are to be audited within the information system.
# NIST SP 800-53 :: AU-2 d
# NIST SP 800-53A :: AU-2.1 (v)
# NIST SP 800-53 Revision 4 :: AU-2 d
#
# CCI-000131
# The information system generates audit records containing information that establishes when an event occurred.
# NIST SP 800-53 :: AU-3
# NIST SP 800-53A :: AU-3.1
# NIST SP 800-53 Revision 4 :: AU-3
#
#
- name: systemctl status auditd
  shell: systemctl status auditd || true
  # following is so we don't get an error about using command instead of module
  args:
      warn: false
  # errors are expected; ignore
  ignore_errors: yes
  # this command doesn't actually change anything
  changed_when: false
  register: auditing_auditd_status

- name: auditing_auditd_status
  debug:
    msg: '{{auditing_auditd_status}}'

- name: pass stig_rhel7_v1r4 v_72079
  set_fact:
    stig_rhel7_v1r4_v_72079_result: 'pass'
  when:
    - "'v_72079' in stig_rhel7_v1r4_checks"
    - '"Active: active (running)" in auditing_auditd_status.stdout'

- name: fail stig_rhel7_v1r4 v_72079
  set_fact:
    stig_rhel7_v1r4_v_72079_result: 'fail'
  when:
    - "'v_72079' in stig_rhel7_v1r4_checks"
    - stig_rhel7_v1r4_v_72079_result != 'pass'


# Vuln ID: V-72081
# Severity: medium
# Group Title: SRG-OS-000046-GPOS-00022
# Rule ID: SV-86705r3_rule
# STIG ID: RHEL-07-030010
# Rule Title: The operating system must shut down upon audit processing failure, unless availability is an overriding concern. If availability is a concern, the system must alert the designated staff (System Administrator [SA] and Information System Security Officer [ISSO] at a minimum) in the event of an audit processing failure.
# Discussion: It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without this notification, the security personnel may be unaware of an impending failure of the audit capability, and system operation may be adversely affected.
#
# Audit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded.
#
# This requirement applies to each audit data storage repository (i.e., distinct information system component where audit records are stored), the centralized audit storage capacity of organizations (i.e., all audit data storage repositories combined), or both.
#
# Satisfies: SRG-OS-000046-GPOS-00022, SRG-OS-000047-GPOS-00023
# IA Controls:
# Check Content: Confirm the audit configuration regarding how auditing processing failures are handled.
#
# Check to see what level "auditctl" is set to with following command:
#
# # auditctl -s | grep -i "fail"
#
# failure 2
#
# If the value of "failure" is set to "2", the system is configured to panic (shut down) in the event of an auditing failure.
#
# If the value of "failure" is set to "1", the system is configured to only send information to the kernel log regarding the failure.
#
# If the "failure" setting is not set, this is a CAT I finding.
#
# If the "failure" setting is set to any value other than "1" or "2", this is a CAT II finding.
#
# If the "failure" setting is set to "1" but the availability concern is not documented or there is no monitoring of the kernel log, this is a CAT III finding.
#
# Fix Text: Configure the operating system to shut down in the event of an audit processing failure.
#
# Add or correct the option to shut down the operating system with the following command:
#
# # auditctl -f 2
#
# Edit the "/etc/audit/rules.d/audit.rules" file and add the following line:
#
# -f 2
#
# If availability has been determined to be more important, and this decision is documented with the ISSO, configure the operating system to notify system administration staff and ISSO staff in the event of an audit processing failure with the following command:
#
# # auditctl -f 1
#
# Edit the "/etc/audit/rules.d/audit.rules" file and add the following line:
#
# -f 1
#
# Kernel log monitoring must also be configured to properly alert designated staff.
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000139
# The information system alerts designated organization-defined personnel or roles in the event of an audit processing failure.
# NIST SP 800-53 :: AU-5 a
# NIST SP 800-53A :: AU-5.1 (ii)
# NIST SP 800-53 Revision 4 :: AU-5 a
#
#
- name: auditctl -s | grep -i "fail"
  shell: auditctl -s | grep -i "fail" || true
  # following is so we don't get an error about using command instead of module
  args:
      warn: false
  # errors are expected; ignore
  ignore_errors: yes
  # this command doesn't actually change anything
  changed_when: false
  register: auditing_auditctl_f

- name: auditing_auditctl_f
  debug:
    msg: '{{auditing_auditctl_f}}'

- name: pass stig_rhel7_v1r4 v_72081
  set_fact:
    stig_rhel7_v1r4_v_72081_result: 'pass'
  when:
    - "'v_72081' in stig_rhel7_v1r4_checks"
    - '"failure 2" in auditing_auditctl_f.stdout'

- name: fail stig_rhel7_v1r4 v_72081
  set_fact:
    stig_rhel7_v1r4_v_72081_result: 'fail'
  when:
    - "'v_72081' in stig_rhel7_v1r4_checks"
    - stig_rhel7_v1r4_v_72081_result != 'pass'


# Vuln ID: V-72083
# Severity: medium
# Group Title: SRG-OS-000342-GPOS-00133
# Rule ID: SV-86707r1_rule
# STIG ID: RHEL-07-030300
# Rule Title: The operating system must off-load audit records onto a different system or media from the system being audited.
# Discussion: Information stored in one location is vulnerable to accidental or incidental deletion or alteration.
#
# Off-loading is a common process in information systems with limited audit storage capacity.
#
# Satisfies: SRG-OS-000342-GPOS-00133, SRG-OS-000479-GPOS-00224
# IA Controls:
# Check Content: Verify the operating system off-loads audit records onto a different system or media from the system being audited.
#
# To determine the remote server that the records are being sent to, use the following command:
#
# # grep -i remote_server /etc/audisp/audisp-remote.conf
# remote_server = 10.0.21.1
#
# If a remote server is not configured, or the line is commented out, ask the System Administrator to indicate how the audit logs are off-loaded to a different system or media.
#
# If there is no evidence that the audit logs are being off-loaded to another system or media, this is a finding.
# Fix Text: Configure the operating system to off-load audit records onto a different system or media from the system being audited.
#
# Set the remote server option in "/etc/audisp/audisp-remote.conf" with the IP address of the log aggregation server.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001851
# The information system off-loads audit records per organization-defined frequency onto a different system or media than the system being audited.
# NIST SP 800-53 Revision 4 :: AU-4 (1)
#
#
- name: grep -i '^remote_server' /etc/audisp/audisp-remote.conf
  shell: grep -i '^remote_server' /etc/audisp/audisp-remote.conf || true
  # following is so we don't get an error about using command instead of module
  args:
      warn: false
  # errors are expected; ignore
  ignore_errors: yes
  # this command doesn't actually change anything
  changed_when: false
  register: auditing_remote_server
  when:
      - audisp_remote_conf.stat.exists

- name: auditing_remote_server
  debug:
    msg: '{{auditing_remote_server}}'

- name: pass stig_rhel7_v1r4 v_72083
  set_fact:
    stig_rhel7_v1r4_v_72083_result: 'pass'
  when:
    - "'v_72083' in stig_rhel7_v1r4_checks"
    - audisp_remote_conf.stat.exists
    - '"remote_server = " in auditing_remote_server.stdout'

- name: fail stig_rhel7_v1r4 v_72083
  set_fact:
    stig_rhel7_v1r4_v_72083_result: 'fail'
  when:
    - "'v_72083' in stig_rhel7_v1r4_checks"
    - stig_rhel7_v1r4_v_72083_result != 'pass'


# Vuln ID: V-72085
# Severity: medium
# Group Title: SRG-OS-000342-GPOS-00133
# Rule ID: SV-86709r1_rule
# STIG ID: RHEL-07-030310
# Rule Title: The operating system must encrypt the transfer of audit records off-loaded onto a different system or media from the system being audited.
# Discussion: Information stored in one location is vulnerable to accidental or incidental deletion or alteration.
#
# Off-loading is a common process in information systems with limited audit storage capacity.
#
# Satisfies: SRG-OS-000342-GPOS-00133, SRG-OS-000479-GPOS-00224
# IA Controls:
# Check Content: Verify the operating system encrypts audit records off-loaded onto a different system or media from the system being audited.
#
# To determine if the transfer is encrypted, use the following command:
#
# # grep -i enable_krb5 /etc/audisp/audisp-remote.conf
# enable_krb5 = yes
#
# If the value of the "enable_krb5" option is not set to "yes" or the line is commented out, ask the System Administrator to indicate how the audit logs are off-loaded to a different system or media.
#
# If there is no evidence that the transfer of the audit logs being off-loaded to another system or media is encrypted, this is a finding.
# Fix Text: Configure the operating system to encrypt the transfer of off-loaded audit records onto a different system or media from the system being audited.
#
# Uncomment the "enable_krb5" option in "/etc/audisp/audisp-remote.conf" and set it with the following line:
#
# enable_krb5 = yes
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001851
# The information system off-loads audit records per organization-defined frequency onto a different system or media than the system being audited.
# NIST SP 800-53 Revision 4 :: AU-4 (1)
#
#
- name: grep -i '^enable_krb5' /etc/audisp/audisp-remote.conf
  shell: grep -i '^enable_krb5' /etc/audisp/audisp-remote.conf || true
  # following is so we don't get an error about using command instead of module
  args:
      warn: false
  # errors are expected; ignore
  ignore_errors: yes
  # this command doesn't actually change anything
  changed_when: false
  register: auditing_enable_krb5
  when:
      - audisp_remote_conf.stat.exists

- name: auditing_enable_krb5
  debug:
    msg: '{{auditing_enable_krb5}}'

- name: pass stig_rhel7_v1r4 v_72085
  set_fact:
    stig_rhel7_v1r4_v_72085_result: 'pass'
  when:
    - "'v_72085' in stig_rhel7_v1r4_checks"
    - audisp_remote_conf.stat.exists
    - '"enable_krb5 = yes" in auditing_enable_krb5.stdout'

- name: fail stig_rhel7_v1r4 v_72085
  set_fact:
    stig_rhel7_v1r4_v_72085_result: 'fail'
  when:
    - "'v_72085' in stig_rhel7_v1r4_checks"
    - stig_rhel7_v1r4_v_72085_result != 'pass'


# Vuln ID: V-72087
# Severity: medium
# Group Title: SRG-OS-000342-GPOS-00133
# Rule ID: SV-86711r2_rule
# STIG ID: RHEL-07-030320
# Rule Title: The audit system must take appropriate action when the audit storage volume is full.
# Discussion: Taking appropriate action in case of a filled audit storage volume will minimize the possibility of losing audit records.
# IA Controls:
# Check Content: Verify the action the operating system takes if the disk the audit records are written to becomes full.
#
# To determine the action that takes place if the disk is full on the remote server, use the following command:
#
# # grep -i disk_full_action /etc/audisp/audisp-remote.conf
# disk_full_action = single
#
# To determine the action that takes place if the network connection fails, use the following command:
#
# # grep -i network_failure_action /etc/audisp/audisp-remote.conf
# network_failure_action = stop
#
# If the value of the "network_failure_action" option is not "syslog", "single", or "halt", or the line is commented out, this is a finding.
#
# If the value of the "disk_full_action" option is not "syslog", "single", or "halt", or the line is commented out, this is a finding.
# Fix Text: Configure the action the operating system takes if the disk the audit records are written to becomes full.
#
# Uncomment or edit the "disk_full_action" option in "/etc/audisp/audisp-remote.conf" and set it to "syslog", "single", or "halt", such as the following line:
#
# disk_full_action = single
#
# Uncomment the "network_failure_action" option in "/etc/audisp/audisp-remote.conf" and set it to "syslog", "single", or "halt".
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001851
# The information system off-loads audit records per organization-defined frequency onto a different system or media than the system being audited.
# NIST SP 800-53 Revision 4 :: AU-4 (1)
#
#
- name: grep -i '^disk_full_action' /etc/audisp/audisp-remote.conf
  shell: grep -i '^disk_full_action' /etc/audisp/audisp-remote.conf || true
  # following is so we don't get an error about using command instead of module
  args:
      warn: false
  # errors are expected; ignore
  ignore_errors: yes
  # this command doesn't actually change anything
  changed_when: false
  register: auditing_disk_full_action
  when:
      - audisp_remote_conf.stat.exists

- name: auditing_disk_full_action
  debug:
    msg: '{{auditing_disk_full_action}}'

- name: grep -i '^network_failure_action' /etc/audisp/audisp-remote.conf
  shell: grep -i '^network_failure_action' /etc/audisp/audisp-remote.conf || true
  # following is so we don't get an error about using command instead of module
  args:
      warn: false
  # errors are expected; ignore
  ignore_errors: yes
  # this command doesn't actually change anything
  changed_when: false
  register: auditing_network_failure_action
  when:
      - audisp_remote_conf.stat.exists

- name: auditing_network_failure_action
  debug:
    msg: '{{auditing_network_failure_action}}'

- name: pass stig_rhel7_v1r4 v_72087
  set_fact:
    stig_rhel7_v1r4_v_72087_result: 'pass'
  when:
    - "'v_72087' in stig_rhel7_v1r4_checks"
    - audisp_remote_conf.stat.exists
    - '"disk_full_action = syslog" in auditing_disk_full_action.stdout or "disk_full_action = single" in auditing_disk_full_action.stdout or "disk_full_action = halt" in auditing_disk_full_action.stdout'
    - '"network_failure_action = syslog" in auditing_network_failure_action.stdout or "network_failure_action = single" in auditing_network_failure_action.stdout or "network_failure_action = halt" in auditing_network_failure_action.stdout'

- name: fail stig_rhel7_v1r4 v_72087
  set_fact:
    stig_rhel7_v1r4_v_72087_result: 'fail'
  when:
    - "'v_72087' in stig_rhel7_v1r4_checks"
    - stig_rhel7_v1r4_v_72087_result != 'pass'


# Vuln ID: V-72089
# Severity: medium
# Group Title: SRG-OS-000343-GPOS-00134
# Rule ID: SV-86713r1_rule
# STIG ID: RHEL-07-030330
# Rule Title: The operating system must immediately notify the System Administrator (SA) and Information System Security Officer ISSO (at a minimum) when allocated audit record storage volume reaches 75% of the repository maximum audit record storage capacity.
# Discussion: If security personnel are not notified immediately when storage volume reaches 75 percent utilization, they are unable to plan for audit record storage capacity expansion.
# IA Controls:
# Check Content: Verify the operating system immediately notifies the SA and ISSO (at a minimum) when allocated audit record storage volume reaches 75 percent of the repository maximum audit record storage capacity.
#
# Check the system configuration to determine the partition the audit records are being written to with the following command:
#
# # grep log_file /etc/audit/auditd.conf
# log_file = /var/log/audit/audit.log
#
# Check the size of the partition that audit records are written to (with the example being "/var/log/audit/"):
#
# # df -h /var/log/audit/
# 0.9G /var/log/audit
#
# If the audit records are not being written to a partition specifically created for audit records (in this example "/var/log/audit" is a separate partition), determine the amount of space other files in the partition are currently occupying with the following command:
#
# # du -sh <partition>
# 1.8G /var
#
# Determine what the threshold is for the system to take action when 75 percent of the repository maximum audit record storage capacity is reached:
#
# # grep -i space_left /etc/audit/auditd.conf
# space_left = 225
#
# If the value of the "space_left" keyword is not set to 25 percent of the total partition size, this is a finding.
# Fix Text: Configure the operating system to immediately notify the SA and ISSO (at a minimum) when allocated audit record storage volume reaches 75 percent of the repository maximum audit record storage capacity.
#
# Check the system configuration to determine the partition the audit records are being written to:
#
# # grep log_file /etc/audit/auditd.conf
#
# Determine the size of the partition that audit records are written to (with the example being "/var/log/audit/"):
#
# # df -h /var/log/audit/
#
# Set the value of the "space_left" keyword in "/etc/audit/auditd.conf" to 75 percent of the partition size.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001855
# The information system provides a warning to organization-defined personnel, roles, and/or locations within organization-defined time period when allocated audit record storage volume reaches organization-defined percentage of repository maximum audit record storage capacity.
# NIST SP 800-53 Revision 4 :: AU-5 (1)
#
#
- name: grep -i '^log_file' /etc/audit/auditd.conf | awk '{print $3}'
  shell: grep -i '^log_file' /etc/audit/auditd.conf | awk '{print $3}' || true
  # following is so we don't get an error about using command instead of module
  args:
      warn: false
  # errors are expected; ignore
  ignore_errors: yes
  # this command doesn't actually change anything
  changed_when: false
  register: auditing_log_file
  when:
      - auditd_conf.stat.exists

- name: auditing_log_file
  debug:
    msg: '{{auditing_log_file}}'

- name: df /var/log/audit/audit.log | tail -n 1 | awk '{print $2}'
  shell: df /var/log/audit/audit.log | tail -n 1 | awk '{print $2}' || true
  # following is so we don't get an error about using command instead of module
  args:
      warn: false
  # errors are expected; ignore
  ignore_errors: yes
  # this command doesn't actually change anything
  changed_when: false
  register: auditing_log_partition_size
  when:
      - auditd_conf.stat.exists

- name: auditing_log_partition_size
  debug:
    msg: '{{auditing_log_partition_size}}'

- name: calculate space_left size; 75% of auditing_log_partition_size
  set_fact:
      auditing_log_partition_75: '{{ ( ( auditing_log_partition_size.stdout|int / 1024 ) * 0.75 )|int }}'

- name: auditing_log_partition_75
  debug:
    msg: '{{auditing_log_partition_75}}'

- name: grep -i '^space_left ' /etc/audit/auditd.conf | awk '{print $3}'
  shell: grep -i '^space_left ' /etc/audit/auditd.conf | awk '{print $3}' || true
  # following is so we don't get an error about using command instead of module
  args:
      warn: false
  # errors are expected; ignore
  ignore_errors: yes
  # this command doesn't actually change anything
  changed_when: false
  register: auditing_space_left
  when:
      - auditd_conf.stat.exists

- name: pass stig_rhel7_v1r4 v_72089
  set_fact:
    stig_rhel7_v1r4_v_72089_result: 'pass'
  when:
    - "'v_72089' in stig_rhel7_v1r4_checks"
    - auditd_conf.stat.exists
    - auditing_space_left.stdout|int == auditing_log_partition_75

- name: fail stig_rhel7_v1r4 v_72089
  set_fact:
    stig_rhel7_v1r4_v_72089_result: 'fail'
  when:
    - "'v_72089' in stig_rhel7_v1r4_checks"
    - stig_rhel7_v1r4_v_72089_result != 'pass'


# Vuln ID: V-72091
# Severity: medium
# Group Title: SRG-OS-000343-GPOS-00134
# Rule ID: SV-86715r1_rule
# STIG ID: RHEL-07-030340
# Rule Title: The operating system must immediately notify the System Administrator (SA) and Information System Security Officer (ISSO) (at a minimum) via email when the threshold for the repository maximum audit record storage capacity is reached.
# Discussion: If security personnel are not notified immediately when the threshold for the repository maximum audit record storage capacity is reached, they are unable to expand the audit record storage capacity before records are lost.
# IA Controls:
# Check Content: Verify the operating system immediately notifies the SA and ISSO (at a minimum) via email when the allocated audit record storage volume reaches 75 percent of the repository maximum audit record storage capacity.
#
# Check what action the operating system takes when the threshold for the repository maximum audit record storage capacity is reached with the following command:
#
# # grep -i space_left_action  /etc/audit/auditd.conf
# space_left_action = email
#
# If the value of the "space_left_action" keyword is not set to "email", this is a finding.
# Fix Text: Configure the operating system to immediately notify the SA and ISSO (at a minimum) when the threshold for the repository maximum audit record storage capacity is reached.
#
# Uncomment or edit the "space_left_action" keyword in "/etc/audit/auditd.conf" and set it to "email".
#
# space_left_action = email
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001855
# The information system provides a warning to organization-defined personnel, roles, and/or locations within organization-defined time period when allocated audit record storage volume reaches organization-defined percentage of repository maximum audit record storage capacity.
# NIST SP 800-53 Revision 4 :: AU-5 (1)
#
#
- name: grep -i '^space_left_action' /etc/audit/auditd.conf | awk '{print $3}'
  shell: grep -i '^space_left_action' /etc/audit/auditd.conf | awk '{print $3}' || true
  # following is so we don't get an error about using command instead of module
  args:
      warn: false
  # errors are expected; ignore
  ignore_errors: yes
  # this command doesn't actually change anything
  changed_when: false
  register: auditing_space_left_action
  when:
      - auditd_conf.stat.exists

- name: auditing_space_left_action
  debug:
    msg: '{{auditing_space_left_action}}'

- name: pass stig_rhel7_v1r4 v_72091
  set_fact:
    stig_rhel7_v1r4_v_72091_result: 'pass'
  when:
    - "'v_72091' in stig_rhel7_v1r4_checks"
    - auditd_conf.stat.exists
    - auditing_space_left_action.stdout == 'email'

- name: fail stig_rhel7_v1r4 v_72091
  set_fact:
    stig_rhel7_v1r4_v_72091_result: 'fail'
  when:
    - "'v_72091' in stig_rhel7_v1r4_checks"
    - stig_rhel7_v1r4_v_72091_result != 'pass'


# Vuln ID: V-72093
# Severity: medium
# Group Title: SRG-OS-000343-GPOS-00134
# Rule ID: SV-86717r2_rule
# STIG ID: RHEL-07-030350
# Rule Title: The operating system must immediately notify the System Administrator (SA) and Information System Security Officer (ISSO) (at a minimum) when the threshold for the repository maximum audit record storage capacity is reached.
# Discussion: If security personnel are not notified immediately when the threshold for the repository maximum audit record storage capacity is reached, they are unable to expand the audit record storage capacity before records are lost.
# IA Controls:
# Check Content: Verify the operating system immediately notifies the SA and ISSO (at a minimum) via email when the threshold for the repository maximum audit record storage capacity is reached.
#
# Check what account the operating system emails when the threshold for the repository maximum audit record storage capacity is reached with the following command:
#
# # grep -i action_mail_acct  /etc/audit/auditd.conf
# action_mail_acct = root
#
# If the value of the "action_mail_acct" keyword is not set to "root" and other accounts for security personnel, this is a finding.
# Fix Text: Configure the operating system to immediately notify the SA and ISSO (at a minimum) when the threshold for the repository maximum audit record storage capacity is reached.
#
# Uncomment or edit the "action_mail_acct" keyword in "/etc/audit/auditd.conf" and set it to root and any other accounts associated with security personnel.
#
# action_mail_acct = root
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001855
# The information system provides a warning to organization-defined personnel, roles, and/or locations within organization-defined time period when allocated audit record storage volume reaches organization-defined percentage of repository maximum audit record storage capacity.
# NIST SP 800-53 Revision 4 :: AU-5 (1)
#
#
- name: grep -i '^action_mail_acct' /etc/audit/auditd.conf | awk '{print $3}'
  shell: grep -i '^action_mail_acct' /etc/audit/auditd.conf | awk '{print $3}' || true
  # following is so we don't get an error about using command instead of module
  args:
      warn: false
  # errors are expected; ignore
  ignore_errors: yes
  # this command doesn't actually change anything
  changed_when: false
  register: auditing_action_mail_acct
  when:
      - auditd_conf.stat.exists

- name: auditing_action_mail_acct
  debug:
    msg: '{{auditing_action_mail_acct}}'

- name: pass stig_rhel7_v1r4 v_72093
  set_fact:
    stig_rhel7_v1r4_v_72093_result: 'pass'
  when:
    - "'v_72093' in stig_rhel7_v1r4_checks"
    - auditd_conf.stat.exists
    - auditing_action_mail_acct.stdout == auditing_email

- name: fail stig_rhel7_v1r4 v_72093
  set_fact:
    stig_rhel7_v1r4_v_72093_result: 'fail'
  when:
    - "'v_72093' in stig_rhel7_v1r4_checks"
    - stig_rhel7_v1r4_v_72093_result != 'pass'


# Vuln ID: V-72095
# Severity: medium
# Group Title: SRG-OS-000327-GPOS-00127
# Rule ID: SV-86719r5_rule
# STIG ID: RHEL-07-030360
# Rule Title: All privileged function executions must be audited.
# Discussion: Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider threats and the advanced persistent threat.
# IA Controls:
# Check Content: Verify the operating system audits the execution of privileged functions.
#
# To find relevant setuid and setgid programs, use the following command once for each local partition [PART]:
#
# # find [PART] -xdev -type f \( -perm -4000 -o -perm -2000 \) 2>/dev/null
#
# Run the following command to verify entries in the audit rules for all programs found with the previous command:
#
# # grep -i "<suid_prog_with_full_path>" /etc/audit/audit.rules
# -a always,exit -F path="<suid_prog_with_full_path>" -F perm=x -F auid>=1000 -F auid!=4294967295 -k setuid/setgid
#
# All "setuid" and "setgid" files on the system must have a corresponding audit rule, or must have an audit rule for the (sub) directory that contains the "setuid"/"setgid" file.
#
# If all "setuid"/"setgid" files on the system do not have audit rule coverage, this is a finding.
# Fix Text: Configure the operating system to audit the execution of privileged functions.
#
# To find the relevant "setuid"/"setgid" programs, run the following command for each local partition [PART]:
#
# # find [PART] -xdev -type f \( -perm -4000 -o -perm -2000 \) 2>/dev/null
#
# For each "setuid"/"setgid" program on the system, which is not covered by an audit rule for a (sub) directory (such as "/usr/sbin"), add a line of the following form to "/etc/audit/rules.d/audit.rules", where <suid_prog_with_full_path> is the full path to each "setuid"/"setgid" program in the list:
#
# -a always,exit -F path=<suid_prog_with_full_path> -F perm=x -F auid>=1000 -F auid!=4294967295 -k setuid/setgid
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-002234
# The information system audits the execution of privileged functions.
# NIST SP 800-53 Revision 4 :: AC-6 (9)
#
#
- name: df | grep -i '^/' | awk '{print $6}'
  shell: df | grep -i '^/' | awk '{print $6}'
  # following is so we don't get an error about using command instead of module
  args:
      warn: false
  # errors are expected; ignore
  ignore_errors: yes
  # this command doesn't actually change anything
  changed_when: false
  register: auditing_local_filesystems
  when:
    - "'v_72095' in stig_rhel7_v1r4_checks"

- name: auditing_local_filesystems
  debug:
    msg: '{{auditing_local_filesystems}}'

- name: find {{item}} -xdev -type f \( -perm -4000 -o -perm -2000 \) 2>/dev/null
  shell: find {{item}} -xdev -type f \( -perm -4000 -o -perm -2000 \) 2>/dev/null
  # following is so we don't get an error about using command instead of module
  args:
      warn: false
  # errors are expected; ignore
  ignore_errors: yes
  # this command doesn't actually change anything
  changed_when: false
  register: auditing_setuid_setgid
  with_items: '{{auditing_local_filesystems.stdout_lines}}'
  when:
    - "'v_72095' in stig_rhel7_v1r4_checks"

- name: auditing_setuid_setgid
  debug:
    msg: '{{auditing_setuid_setgid}}'

- set_fact:
    auditing_setuid_setgid_combined: []

- name: combine auditing_setuid_setgid results
  set_fact:
      auditing_setuid_setgid_combined: '{{auditing_setuid_setgid_combined}} + {{item.stdout_lines}}'
  with_items: '{{auditing_setuid_setgid.results}}'
  when:
    - "'v_72095' in stig_rhel7_v1r4_checks"

- name: auditing_setuid_setgid_combined
  debug:
    msg: '{{auditing_setuid_setgid_combined}}'

# - name: grep -i '{{item}}' /etc/audit/audit.rules
#   shell: find {{item}} -xdev -type f \( -perm -4000 -o -perm -2000 \) 2>/dev/null
#   # following is so we don't get an error about using command instead of module
#   args:
#       warn: false
#   # errors are expected; ignore
#   ignore_errors: yes
#   # this command doesn't actually change anything
#   changed_when: false
#   register: auditing_setuid_setgid
#   with_items: '{{auditing_local_filesystems.stdoutlines}}'
#   when:
#     - "'v_72095' in stig_rhel7_v1r4_checks"
#
# - name: fail stig_rhel7_v1r4 v_72095
#   set_fact:
#     stig_rhel7_v1r4_v_72095_result: 'fail'
#   when:
#     - "'v_72095' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72095_result != 'pass'


# Vuln ID: V-72097
# Severity: medium
# Group Title: SRG-OS-000064-GPOS-00033
# Rule ID: SV-86721r3_rule
# STIG ID: RHEL-07-030370
# Rule Title: All uses of the chown command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000392-GPOS-00172, SRG-OS-000458-GPOS-00203, SRG-OS-000474-GPOS-00219
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "chown" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw chown /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S chown -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S chown -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# If there are no audit rules defined for the "chown" command, this is a finding.
#
# Fix Text: Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S chown -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S chown -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# The audit daemon must be restarted for the changes to take effect.
#
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000126
# The organization determines that the organization-defined subset of the auditable events defined in AU-2 are to be audited within the information system.
# NIST SP 800-53 :: AU-2 d
# NIST SP 800-53A :: AU-2.1 (v)
# NIST SP 800-53 Revision 4 :: AU-2 d
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel7_v1r4 v_72097
#   set_fact:
#     stig_rhel7_v1r4_v_72097_result: 'fail'
#   when:
#     - "'v_72097' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72097_result != 'pass'


# Vuln ID: V-72099
# Severity: medium
# Group Title: SRG-OS-000064-GPOS-00033
# Rule ID: SV-86723r3_rule
# STIG ID: RHEL-07-030380
# Rule Title: All uses of the fchown command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000392-GPOS-00172, SRG-OS-000458-GPOS-00203, SRG-OS-000474-GPOS-00219
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "fchown" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw fchown /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S fchown -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S fchown -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# If there are no audit rules defined for the "fchown" command, this is a finding.
#
# Fix Text: Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S fchown -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S fchown -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# The audit daemon must be restarted for the changes to take effect.
#
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000126
# The organization determines that the organization-defined subset of the auditable events defined in AU-2 are to be audited within the information system.
# NIST SP 800-53 :: AU-2 d
# NIST SP 800-53A :: AU-2.1 (v)
# NIST SP 800-53 Revision 4 :: AU-2 d
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel7_v1r4 v_72099
#   set_fact:
#     stig_rhel7_v1r4_v_72099_result: 'fail'
#   when:
#     - "'v_72099' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72099_result != 'pass'


# Vuln ID: V-72101
# Severity: medium
# Group Title: SRG-OS-000064-GPOS-00033
# Rule ID: SV-86725r3_rule
# STIG ID: RHEL-07-030390
# Rule Title: All uses of the lchown command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000392-GPOS-00172, SRG-OS-000458-GPOS-00203, SRG-OS-000474-GPOS-00219
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "lchown" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw lchown /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S lchown -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S lchown -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# If there are no audit rules defined for the "lchown" command, this is a finding.
# Fix Text: Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S lchown -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S lchown -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000126
# The organization determines that the organization-defined subset of the auditable events defined in AU-2 are to be audited within the information system.
# NIST SP 800-53 :: AU-2 d
# NIST SP 800-53A :: AU-2.1 (v)
# NIST SP 800-53 Revision 4 :: AU-2 d
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel7_v1r4 v_72101
#   set_fact:
#     stig_rhel7_v1r4_v_72101_result: 'fail'
#   when:
#     - "'v_72101' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72101_result != 'pass'


# Vuln ID: V-72103
# Severity: medium
# Group Title: SRG-OS-000064-GPOS-00033
# Rule ID: SV-86727r3_rule
# STIG ID: RHEL-07-030400
# Rule Title: All uses of the fchownat command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000392-GPOS-00172, SRG-OS-000458-GPOS-00203, SRG-OS-000474-GPOS-00219
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "fchownat" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw fchownat /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S fchownat -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S fchownat -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# If there are no audit rules defined for the "fchownat" command, this is a finding.
#
# Fix Text: Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S fchownat -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S fchownat -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# The audit daemon must be restarted for the changes to take effect.
#
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000126
# The organization determines that the organization-defined subset of the auditable events defined in AU-2 are to be audited within the information system.
# NIST SP 800-53 :: AU-2 d
# NIST SP 800-53A :: AU-2.1 (v)
# NIST SP 800-53 Revision 4 :: AU-2 d
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel7_v1r4 v_72103
#   set_fact:
#     stig_rhel7_v1r4_v_72103_result: 'fail'
#   when:
#     - "'v_72103' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72103_result != 'pass'


# Vuln ID: V-72105
# Severity: medium
# Group Title: SRG-OS-000458-GPOS-00203
# Rule ID: SV-86729r3_rule
# STIG ID: RHEL-07-030410
# Rule Title: All uses of the chmod command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000458-GPOS-00203, SRG-OS-000392-GPOS-00172, SRG-OS-000064-GPOS-00033
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "chmod" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following command:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw chmod /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S chmod -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S chmod -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# If there are no audit rules defined for the "chmod" command, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "chmod" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S chmod -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S chmod -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel7_v1r4 v_72105
#   set_fact:
#     stig_rhel7_v1r4_v_72105_result: 'fail'
#   when:
#     - "'v_72105' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72105_result != 'pass'


# Vuln ID: V-72107
# Severity: medium
# Group Title: SRG-OS-000458-GPOS-00203
# Rule ID: SV-86731r3_rule
# STIG ID: RHEL-07-030420
# Rule Title: All uses of the fchmod command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000458-GPOS-00203, SRG-OS-000392-GPOS-00172, SRG-OS-000064-GPOS-00033
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "fchmod" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following command:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw fchmod /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S fchmod -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S fchmod -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# If there are no audit rules defined for the "fchmod" command, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "fchmod" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S fchmod -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S fchmod -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel7_v1r4 v_72107
#   set_fact:
#     stig_rhel7_v1r4_v_72107_result: 'fail'
#   when:
#     - "'v_72107' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72107_result != 'pass'


# Vuln ID: V-72109
# Severity: medium
# Group Title: SRG-OS-000458-GPOS-00203
# Rule ID: SV-86733r3_rule
# STIG ID: RHEL-07-030430
# Rule Title: All uses of the fchmodat command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000458-GPOS-00203, SRG-OS-000392-GPOS-00172, SRG-OS-000064-GPOS-00033
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "fchmodat" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following command:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw fchmodat /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# If there are no audit rules defined for the "fchmodat" command, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "fchmodat" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel7_v1r4 v_72109
#   set_fact:
#     stig_rhel7_v1r4_v_72109_result: 'fail'
#   when:
#     - "'v_72109' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72109_result != 'pass'


# Vuln ID: V-72111
# Severity: medium
# Group Title: SRG-OS-000458-GPOS-00203
# Rule ID: SV-86735r3_rule
# STIG ID: RHEL-07-030440
# Rule Title: All uses of the setxattr command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000458-GPOS-00203, SRG-OS-000392-GPOS-00172, SRG-OS-000064-GPOS-00033
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "setxattr" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw setxattr /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S setxattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S setxattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# If there are no audit rules defined for the "setxattr" command, this is a finding.
#
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "setxattr" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S setxattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S setxattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel7_v1r4 v_72111
#   set_fact:
#     stig_rhel7_v1r4_v_72111_result: 'fail'
#   when:
#     - "'v_72111' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72111_result != 'pass'


# Vuln ID: V-72113
# Severity: medium
# Group Title: SRG-OS-000458-GPOS-00203
# Rule ID: SV-86737r3_rule
# STIG ID: RHEL-07-030450
# Rule Title: All uses of the fsetxattr command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000458-GPOS-00203, SRG-OS-000392-GPOS-00172, SRG-OS-000064-GPOS-00033
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "fsetxattr" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw fsetxattr /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S fsetxattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S fsetxattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# If there are no audit rules defined for the "fsetxattr" command, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "fsetxattr" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S fsetxattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S fsetxattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel7_v1r4 v_72113
#   set_fact:
#     stig_rhel7_v1r4_v_72113_result: 'fail'
#   when:
#     - "'v_72113' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72113_result != 'pass'


# Vuln ID: V-72115
# Severity: medium
# Group Title: SRG-OS-000458-GPOS-00203
# Rule ID: SV-86739r3_rule
# STIG ID: RHEL-07-030460
# Rule Title: All uses of the lsetxattr command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000458-GPOS-00203, SRG-OS-000392-GPOS-00172, SRG-OS-000064-GPOS-00033
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "lsetxattr" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw lsetxattr /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S lsetxattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S lsetxattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# If there are no audit rules defined for the "lsetxattr" command, this is a finding.
#
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "lsetxattr" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S lsetxattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S lsetxattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel7_v1r4 v_72115
#   set_fact:
#     stig_rhel7_v1r4_v_72115_result: 'fail'
#   when:
#     - "'v_72115' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72115_result != 'pass'


# Vuln ID: V-72117
# Severity: medium
# Group Title: SRG-OS-000458-GPOS-00203
# Rule ID: SV-86741r3_rule
# STIG ID: RHEL-07-030470
# Rule Title: All uses of the removexattr command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000458-GPOS-00203, SRG-OS-000392-GPOS-00172, SRG-OS-000064-GPOS-00033
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "removexattr" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw removexattr /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S removexattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S removexattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# If there are no audit rules defined for the "removexattr" command, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "removexattr" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S removexattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S removexattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel7_v1r4 v_72117
#   set_fact:
#     stig_rhel7_v1r4_v_72117_result: 'fail'
#   when:
#     - "'v_72117' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72117_result != 'pass'


# Vuln ID: V-72119
# Severity: medium
# Group Title: SRG-OS-000458-GPOS-00203
# Rule ID: SV-86743r3_rule
# STIG ID: RHEL-07-030480
# Rule Title: All uses of the fremovexattr command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000458-GPOS-00203, SRG-OS-000392-GPOS-00172, SRG-OS-000064-GPOS-00033
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "fremovexattr" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw fremovexattr /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S fremovexattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S fremovexattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# If there are no audit rules defined for the "fremovexattr" command, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "fremovexattr" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S fremovexattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S fremovexattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# The audit daemon must be restarted for the changes to take effect.
#
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel7_v1r4 v_72119
#   set_fact:
#     stig_rhel7_v1r4_v_72119_result: 'fail'
#   when:
#     - "'v_72119' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72119_result != 'pass'


# Vuln ID: V-72121
# Severity: medium
# Group Title: SRG-OS-000458-GPOS-00203
# Rule ID: SV-86745r3_rule
# STIG ID: RHEL-07-030490
# Rule Title: All uses of the lremovexattr command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000458-GPOS-00203, SRG-OS-000392-GPOS-00172, SRG-OS-000064-GPOS-00033
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "lremovexattr" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw lremovexattr /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S lremovexattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S lremovexattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# If there are no audit rules defined for the "lremovexattr" command, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "lremovexattr" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S lremovexattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# -a always,exit -F arch=b64 -S lremovexattr -F auid>=1000 -F auid!=4294967295 -k perm_mod
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel7_v1r4 v_72121
#   set_fact:
#     stig_rhel7_v1r4_v_72121_result: 'fail'
#   when:
#     - "'v_72121' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72121_result != 'pass'


# Vuln ID: V-72123
# Severity: medium
# Group Title: SRG-OS-000064-GPOS-00033
# Rule ID: SV-86747r3_rule
# STIG ID: RHEL-07-030500
# Rule Title: All uses of the creat command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000458-GPOS-00203, SRG-OS-000461-GPOS-00205, SRG-OS-000392-GPOS-00172
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "creat" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw creat /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S creat F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# If there are no audit rules defined for the creat command, this is a finding.
#
# If the output does not produce a rule containing -F exit=-EPERM, this is a finding.
#
# If the output does not produce a rule containing -F exit=-EACCES, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "creat" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules:
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# The audit daemon must be restarted for the changes to take effect.
#
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72123
#   set_fact:
#     stig_rhel7_v1r4_v_72123_result: 'fail'
#   when:
#     - "'v_72123' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72123_result != 'pass'


# Vuln ID: V-72125
# Severity: medium
# Group Title: SRG-OS-000064-GPOS-00033
# Rule ID: SV-86749r3_rule
# STIG ID: RHEL-07-030510
# Rule Title: All uses of the open command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000458-GPOS-00203, SRG-OS-000461-GPOS-00205, SRG-OS-000392-GPOS-00172
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "open" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw open /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# If there are no audit rules defined for the open command, this is a finding.
#
# If the output does not produce a rule containing -F exit=-EPERM, this is a finding.
#
# If the output does not produce a rule containing -F exit=-EACCES, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "open" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# The audit daemon must be restarted for the changes to take effect.
#
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72125
#   set_fact:
#     stig_rhel7_v1r4_v_72125_result: 'fail'
#   when:
#     - "'v_72125' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72125_result != 'pass'


# Vuln ID: V-72127
# Severity: medium
# Group Title: SRG-OS-000064-GPOS-00033
# Rule ID: SV-86751r3_rule
# STIG ID: RHEL-07-030520
# Rule Title: All uses of the openat command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000458-GPOS-00203, SRG-OS-000461-GPOS-00205, SRG-OS-000392-GPOS-00172
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "openat" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw openat /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# If there are no audit rules defined for the openat command, this is a finding.
#
# If the output does not produce a rule containing -F exit=-EPERM, this is a finding.
#
# If the output does not produce a rule containing -F exit=-EACCES, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "openat" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72127
#   set_fact:
#     stig_rhel7_v1r4_v_72127_result: 'fail'
#   when:
#     - "'v_72127' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72127_result != 'pass'


# Vuln ID: V-72129
# Severity: medium
# Group Title: SRG-OS-000064-GPOS-00033
# Rule ID: SV-86753r3_rule
# STIG ID: RHEL-07-030530
# Rule Title: All uses of the open_by_handle_at command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000458-GPOS-00203, SRG-OS-000461-GPOS-00205, SRG-OS-000392-GPOS-00172
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "open_by_handle_at" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw open_by_handle_at /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# If there are no audit rules defined for the open_by_handle_at command, this is a finding.
#
# If the output does not produce a rule containing -F exit=-EPERM, this is a finding.
#
# If the output does not produce a rule containing -F exit=-EACCES, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "open_by_handle_at" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# The audit daemon must be restarted for the changes to take effect.
#
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72129
#   set_fact:
#     stig_rhel7_v1r4_v_72129_result: 'fail'
#   when:
#     - "'v_72129' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72129_result != 'pass'


# Vuln ID: V-72131
# Severity: medium
# Group Title: SRG-OS-000064-GPOS-00033
# Rule ID: SV-86755r3_rule
# STIG ID: RHEL-07-030540
# Rule Title: All uses of the truncate command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000458-GPOS-00203, SRG-OS-000461-GPOS-00205, SRG-OS-000392-GPOS-00172
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "truncate" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw truncate /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# If there are no audit rules defined for the truncate command, this is a finding.
#
# If the output does not produce a rule containing -F exit=-EPERM, this is a finding.
#
# If the output does not produce a rule containing -F exit=-EACCES, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "truncate" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72131
#   set_fact:
#     stig_rhel7_v1r4_v_72131_result: 'fail'
#   when:
#     - "'v_72131' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72131_result != 'pass'


# Vuln ID: V-72133
# Severity: medium
# Group Title: SRG-OS-000064-GPOS-00033
# Rule ID: SV-86757r3_rule
# STIG ID: RHEL-07-030550
# Rule Title: All uses of the ftruncate command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000458-GPOS-00203, SRG-OS-000461-GPOS-00205, SRG-OS-000392-GPOS-00172
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "ftruncate" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw ftruncate /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# If there are no audit rules defined for the truncate command, this is a finding.
#
# If the output does not produce a rule containing -F exit=-EPERM, this is a finding.
#
# If the output does not produce a rule containing -F exit=-EACCES, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "ftruncate" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
#
# -a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72133
#   set_fact:
#     stig_rhel7_v1r4_v_72133_result: 'fail'
#   when:
#     - "'v_72133' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72133_result != 'pass'


# Vuln ID: V-72135
# Severity: medium
# Group Title: SRG-OS-000392-GPOS-00172
# Rule ID: SV-86759r3_rule
# STIG ID: RHEL-07-030560
# Rule Title: All uses of the semanage command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000392-GPOS-00172, SRG-OS-000463-GPOS-00207, SRG-OS-000465-GPOS-00209
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "semanage" command occur.
#
# Check the file system rule in "/etc/audit/audit.rules" with the following command:
#
# # grep -i /usr/sbin/semanage /etc/audit/audit.rules
#
# -a always,exit -F path=/usr/sbin/semanage -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "semanage" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -a always,exit -F path=/usr/sbin/semanage -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72135
#   set_fact:
#     stig_rhel7_v1r4_v_72135_result: 'fail'
#   when:
#     - "'v_72135' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72135_result != 'pass'


# Vuln ID: V-72137
# Severity: medium
# Group Title: SRG-OS-000392-GPOS-00172
# Rule ID: SV-86761r3_rule
# STIG ID: RHEL-07-030570
# Rule Title: All uses of the setsebool command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000392-GPOS-00172, SRG-OS-000463-GPOS-00207, SRG-OS-000465-GPOS-00209
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "setsebool" command occur.
#
# Check the file system rule in "/etc/audit/audit.rules" with the following command:
#
# # grep -i /usr/sbin/setsebool /etc/audit/audit.rules
#
# -a always,exit -F path=/usr/sbin/setsebool -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "setsebool" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -a always,exit -F path=/usr/sbin/setsebool -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72137
#   set_fact:
#     stig_rhel7_v1r4_v_72137_result: 'fail'
#   when:
#     - "'v_72137' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72137_result != 'pass'


# Vuln ID: V-72139
# Severity: medium
# Group Title: SRG-OS-000392-GPOS-00172
# Rule ID: SV-86763r3_rule
# STIG ID: RHEL-07-030580
# Rule Title: All uses of the chcon command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000392-GPOS-00172, SRG-OS-000463-GPOS-00207, SRG-OS-000465-GPOS-00209
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "chcon" command occur.
#
# Check the file system rule in "/etc/audit/audit.rules" with the following command:
#
# # grep -i /usr/bin/chcon /etc/audit/audit.rules
#
# -a always,exit -F path=/usr/bin/chcon -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "chcon" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -a always,exit -F path=/usr/bin/chcon -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72139
#   set_fact:
#     stig_rhel7_v1r4_v_72139_result: 'fail'
#   when:
#     - "'v_72139' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72139_result != 'pass'


# Vuln ID: V-72141
# Severity: medium
# Group Title: SRG-OS-000392-GPOS-00172
# Rule ID: SV-86765r4_rule
# STIG ID: RHEL-07-030590
# Rule Title: All uses of the setfiles command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000392-GPOS-00172, SRG-OS-000463-GPOS-00207, SRG-OS-000465-GPOS-00209
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "setfiles" command occur.
#
# Check the file system rule in "/etc/audit/audit.rules" with the following command:
#
# # grep -i /usr/sbin/setfiles /etc/audit/audit.rules
#
# -a always,exit -F path=/usr/sbin/setfiles -F perm=x -F auid>=1000 -F auid!=4294967295 -k -F privileged-priv_change
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "setfiles" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -a always,exit -F path=/usr/sbin/setfiles -F perm=x -F auid>=1000 -F auid!=4294967295 -k -F privileged-priv_change
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72141
#   set_fact:
#     stig_rhel7_v1r4_v_72141_result: 'fail'
#   when:
#     - "'v_72141' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72141_result != 'pass'


# Vuln ID: V-72143
# Severity: medium
# Group Title: SRG-OS-000392-GPOS-00172
# Rule ID: SV-86767r2_rule
# STIG ID: RHEL-07-030600
# Rule Title: The operating system must generate audit records for all successful/unsuccessful account access count events.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000392-GPOS-00172, SRG-OS-000470-GPOS-00214, SRG-OS-000473-GPOS-00218
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful account access count events occur.
#
# Check the file system rule in "/etc/audit/audit.rules" with the following commands:
#
# # grep -i /var/log/tallylog /etc/audit/audit.rules
#
# -w /var/log/tallylog -p wa -k logins
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful account access count events occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -w /var/log/tallylog -p wa -k logins
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000126
# The organization determines that the organization-defined subset of the auditable events defined in AU-2 are to be audited within the information system.
# NIST SP 800-53 :: AU-2 d
# NIST SP 800-53A :: AU-2.1 (v)
# NIST SP 800-53 Revision 4 :: AU-2 d
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72143
#   set_fact:
#     stig_rhel7_v1r4_v_72143_result: 'fail'
#   when:
#     - "'v_72143' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72143_result != 'pass'


# Vuln ID: V-72145
# Severity: medium
# Group Title: SRG-OS-000392-GPOS-00172
# Rule ID: SV-86769r3_rule
# STIG ID: RHEL-07-030610
# Rule Title: The operating system must generate audit records for all unsuccessful account access events.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000392-GPOS-00172, SRG-OS-000470-GPOS-00214, SRG-OS-000473-GPOS-00218
# IA Controls:
# Check Content: Verify the operating system generates audit records when unsuccessful account access events occur.
#
# Check the file system rule in "/etc/audit/audit.rules" with the following commands:
#
# # grep -i /var/run/faillock /etc/audit/audit.rules
#
# -w /var/run/faillock -p wa -k logins
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when unsuccessful account access events occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -w /var/run/faillock -p wa -k logins
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000126
# The organization determines that the organization-defined subset of the auditable events defined in AU-2 are to be audited within the information system.
# NIST SP 800-53 :: AU-2 d
# NIST SP 800-53A :: AU-2.1 (v)
# NIST SP 800-53 Revision 4 :: AU-2 d
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72145
#   set_fact:
#     stig_rhel7_v1r4_v_72145_result: 'fail'
#   when:
#     - "'v_72145' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72145_result != 'pass'


# Vuln ID: V-72147
# Severity: medium
# Group Title: SRG-OS-000392-GPOS-00172
# Rule ID: SV-86771r2_rule
# STIG ID: RHEL-07-030620
# Rule Title: The operating system must generate audit records for all successful account access events.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000392-GPOS-00172, SRG-OS-000470-GPOS-00214, SRG-OS-000473-GPOS-00218
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful account access events occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# # grep -i /var/log/lastlog /etc/audit/audit.rules
#
# -w /var/log/lastlog -p wa -k logins
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful account access events occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -w /var/log/lastlog -p wa -k logins
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000126
# The organization determines that the organization-defined subset of the auditable events defined in AU-2 are to be audited within the information system.
# NIST SP 800-53 :: AU-2 d
# NIST SP 800-53A :: AU-2.1 (v)
# NIST SP 800-53 Revision 4 :: AU-2 d
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72147
#   set_fact:
#     stig_rhel7_v1r4_v_72147_result: 'fail'
#   when:
#     - "'v_72147' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72147_result != 'pass'


# Vuln ID: V-72149
# Severity: medium
# Group Title: SRG-OS-000042-GPOS-00020
# Rule ID: SV-86773r3_rule
# STIG ID: RHEL-07-030630
# Rule Title: All uses of the passwd command must be audited.
# Discussion: Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.
#
# At a minimum, the organization must audit the full-text recording of privileged password commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.
#
# Satisfies: SRG-OS-000042-GPOS-00020, SRG-OS-000392-GPOS-00172, SRG-OS-000471-GPOS-00215
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "passwd" command occur.
#
# Check the file system rule in "/etc/audit/audit.rules" with the following command:
#
# # grep -i /usr/bin/passwd /etc/audit/audit.rules
#
# -a always,exit -F path=/usr/bin/passwd -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-passwd
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "passwd" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -a always,exit -F path=/usr/bin/passwd -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-passwd
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000135
# The information system generates audit records containing the organization-defined additional, more detailed information that is to be included in the audit records.
# NIST SP 800-53 :: AU-3 (1)
# NIST SP 800-53A :: AU-3 (1).1 (ii)
# NIST SP 800-53 Revision 4 :: AU-3 (1)
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72149
#   set_fact:
#     stig_rhel7_v1r4_v_72149_result: 'fail'
#   when:
#     - "'v_72149' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72149_result != 'pass'


# Vuln ID: V-72151
# Severity: medium
# Group Title: SRG-OS-000042-GPOS-00020
# Rule ID: SV-86775r4_rule
# STIG ID: RHEL-07-030640
# Rule Title: All uses of the unix_chkpwd command must be audited.
# Discussion: Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.
#
# At a minimum, the organization must audit the full-text recording of privileged password commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.
#
# Satisfies: SRG-OS-000042-GPOS-00020, SRG-OS-000392-GPOS-00172, SRG-OS-000471-GPOS-00215
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "unix_chkpwd" command occur.
#
# Check the file system rule in "/etc/audit/audit.rules" with the following command:
#
# # grep -i /sbin/unix_chkpwd /etc/audit/audit.rules
#
# -a always,exit -F path=/usr/sbin/unix_chkpwd -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-passwd
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "unix_chkpwd" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -a always,exit -F path=/usr/sbin/unix_chkpwd -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-passwd
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000135
# The information system generates audit records containing the organization-defined additional, more detailed information that is to be included in the audit records.
# NIST SP 800-53 :: AU-3 (1)
# NIST SP 800-53A :: AU-3 (1).1 (ii)
# NIST SP 800-53 Revision 4 :: AU-3 (1)
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72151
#   set_fact:
#     stig_rhel7_v1r4_v_72151_result: 'fail'
#   when:
#     - "'v_72151' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72151_result != 'pass'


# Vuln ID: V-72153
# Severity: medium
# Group Title: SRG-OS-000042-GPOS-00020
# Rule ID: SV-86777r3_rule
# STIG ID: RHEL-07-030650
# Rule Title: All uses of the gpasswd command must be audited.
# Discussion: Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.
#
# At a minimum, the organization must audit the full-text recording of privileged password commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.
#
# Satisfies: SRG-OS-000042-GPOS-00020, SRG-OS-000392-GPOS-00172, SRG-OS-000471-GPOS-00215
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "gpasswd" command occur.
#
# Check the file system rule in "/etc/audit/audit.rules" with the following command:
#
# # grep -i /usr/bin/gpasswd /etc/audit/audit.rules
#
# -a always,exit -F path=/usr/bin/gpasswd -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-passwd
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "gpasswd" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -a always,exit -F path=/usr/bin/gpasswd -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-passwd
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000135
# The information system generates audit records containing the organization-defined additional, more detailed information that is to be included in the audit records.
# NIST SP 800-53 :: AU-3 (1)
# NIST SP 800-53A :: AU-3 (1).1 (ii)
# NIST SP 800-53 Revision 4 :: AU-3 (1)
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72153
#   set_fact:
#     stig_rhel7_v1r4_v_72153_result: 'fail'
#   when:
#     - "'v_72153' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72153_result != 'pass'


# Vuln ID: V-72155
# Severity: medium
# Group Title: SRG-OS-000042-GPOS-00020
# Rule ID: SV-86779r3_rule
# STIG ID: RHEL-07-030660
# Rule Title: All uses of the chage command must be audited.
# Discussion: Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.
#
# At a minimum, the organization must audit the full-text recording of privileged password commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.
#
# Satisfies: SRG-OS-000042-GPOS-00020, SRG-OS-000392-GPOS-00172, SRG-OS-000471-GPOS-00215
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "chage" command occur.
#
# Check the file system rule in "/etc/audit/audit.rules" with the following command:
#
# # grep -i /usr/bin/chage /etc/audit/audit.rules
#
# -a always,exit -F path=/usr/bin/chage -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-passwd
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "chage" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -a always,exit -F path=/usr/bin/chage -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-passwd
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000135
# The information system generates audit records containing the organization-defined additional, more detailed information that is to be included in the audit records.
# NIST SP 800-53 :: AU-3 (1)
# NIST SP 800-53A :: AU-3 (1).1 (ii)
# NIST SP 800-53 Revision 4 :: AU-3 (1)
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72155
#   set_fact:
#     stig_rhel7_v1r4_v_72155_result: 'fail'
#   when:
#     - "'v_72155' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72155_result != 'pass'


# Vuln ID: V-72157
# Severity: medium
# Group Title: SRG-OS-000042-GPOS-00020
# Rule ID: SV-86781r3_rule
# STIG ID: RHEL-07-030670
# Rule Title: All uses of the userhelper command must be audited.
# Discussion: Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.
#
# At a minimum, the organization must audit the full-text recording of privileged password commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.
#
# Satisfies: SRG-OS-000042-GPOS-00020, SRG-OS-000392-GPOS-00172, SRG-OS-000471-GPOS-00215
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "userhelper" command occur.
#
# Check the file system rule in "/etc/audit/audit.rules" with the following command:
#
# # grep -i /usr/sbin/userhelper /etc/audit/audit.rules
#
# -a always,exit -F path=/usr/sbin/userhelper -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-passwd
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "userhelper" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -a always,exit -F path=/usr/sbin/userhelper -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-passwd
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000135
# The information system generates audit records containing the organization-defined additional, more detailed information that is to be included in the audit records.
# NIST SP 800-53 :: AU-3 (1)
# NIST SP 800-53A :: AU-3 (1).1 (ii)
# NIST SP 800-53 Revision 4 :: AU-3 (1)
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72157
#   set_fact:
#     stig_rhel7_v1r4_v_72157_result: 'fail'
#   when:
#     - "'v_72157' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72157_result != 'pass'


# Vuln ID: V-72159
# Severity: medium
# Group Title: SRG-OS-000037-GPOS-00015
# Rule ID: SV-86783r4_rule
# STIG ID: RHEL-07-030680
# Rule Title: All uses of the su command must be audited.
# Discussion: Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.
#
# At a minimum, the organization must audit the full-text recording of privileged access commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.
#
# Satisfies: SRG-OS-000037-GPOS-00015, SRG-OS-000042-GPOS-00020, SRG-OS-000392-GPOS-00172, SRG-OS-000462-GPOS-00206, SRG-OS-000471-GPOS-00215
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "su" command occur.
#
# Check for the following system call being audited by performing the following command to check the file system rules in "/etc/audit/audit.rules":
#
# # grep -i /bin/su /etc/audit/audit.rules
#
# -a always,exit -F path=/usr/bin/su -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "su" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -a always,exit -F path=/usr/bin/su -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000130
# The information system generates audit records containing information that establishes what type of event occurred.
# NIST SP 800-53 :: AU-3
# NIST SP 800-53A :: AU-3.1
# NIST SP 800-53 Revision 4 :: AU-3
#
# CCI-000135
# The information system generates audit records containing the organization-defined additional, more detailed information that is to be included in the audit records.
# NIST SP 800-53 :: AU-3 (1)
# NIST SP 800-53A :: AU-3 (1).1 (ii)
# NIST SP 800-53 Revision 4 :: AU-3 (1)
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72159
#   set_fact:
#     stig_rhel7_v1r4_v_72159_result: 'fail'
#   when:
#     - "'v_72159' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72159_result != 'pass'


# Vuln ID: V-72161
# Severity: medium
# Group Title: SRG-OS-000037-GPOS-00015
# Rule ID: SV-86785r3_rule
# STIG ID: RHEL-07-030690
# Rule Title: All uses of the sudo command must be audited.
# Discussion: Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.
#
# At a minimum, the organization must audit the full-text recording of privileged access commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.
#
# Satisfies: SRG-OS-000037-GPOS-00015, SRG-OS-000042-GPOS-00020, SRG-OS-000392-GPOS-00172, SRG-OS-000462-GPOS-00206, SRG-OS-000471-GPOS-00215
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "sudo" command occur.
#
# Check for the following system calls being audited by performing the following command to check the file system rules in "/etc/audit/audit.rules":
#
# # grep -i /usr/bin/sudo /etc/audit/audit.rules
#
# -a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "sudo" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000130
# The information system generates audit records containing information that establishes what type of event occurred.
# NIST SP 800-53 :: AU-3
# NIST SP 800-53A :: AU-3.1
# NIST SP 800-53 Revision 4 :: AU-3
#
# CCI-000135
# The information system generates audit records containing the organization-defined additional, more detailed information that is to be included in the audit records.
# NIST SP 800-53 :: AU-3 (1)
# NIST SP 800-53A :: AU-3 (1).1 (ii)
# NIST SP 800-53 Revision 4 :: AU-3 (1)
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72161
#   set_fact:
#     stig_rhel7_v1r4_v_72161_result: 'fail'
#   when:
#     - "'v_72161' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72161_result != 'pass'


# Vuln ID: V-72163
# Severity: medium
# Group Title: SRG-OS-000037-GPOS-00015
# Rule ID: SV-86787r4_rule
# STIG ID: RHEL-07-030700
# Rule Title: All uses of the sudoers command must be audited.
# Discussion: Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.
#
# At a minimum, the organization must audit the full-text recording of privileged access commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.
#
# Satisfies: SRG-OS-000037-GPOS-00015, SRG-OS-000042-GPOS-00020, SRG-OS-000392-GPOS-00172, SRG-OS-000462-GPOS-00206, SRG-OS-000471-GPOS-00215
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "sudoer" command occur.
#
# Check for modification of the following files being audited by performing the following commands to check the file system rules in "/etc/audit/audit.rules":
#
# # grep -i "/etc/sudoers" /etc/audit/audit.rules
#
# -w /etc/sudoers -p wa -k privileged-actions
#
# # grep -i "/etc/sudoers.d/" /etc/audit/audit.rules
#
# -w /etc/sudoers.d/ -p wa -k privileged-actions
#
# If the commands do not return output that does not match the examples, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "sudoer" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -w /etc/sudoers -p wa -k privileged-actions
#
# -w /etc/sudoers.d/ -p wa -k privileged-actions
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000130
# The information system generates audit records containing information that establishes what type of event occurred.
# NIST SP 800-53 :: AU-3
# NIST SP 800-53A :: AU-3.1
# NIST SP 800-53 Revision 4 :: AU-3
#
# CCI-000135
# The information system generates audit records containing the organization-defined additional, more detailed information that is to be included in the audit records.
# NIST SP 800-53 :: AU-3 (1)
# NIST SP 800-53A :: AU-3 (1).1 (ii)
# NIST SP 800-53 Revision 4 :: AU-3 (1)
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72163
#   set_fact:
#     stig_rhel7_v1r4_v_72163_result: 'fail'
#   when:
#     - "'v_72163' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72163_result != 'pass'


# Vuln ID: V-72165
# Severity: medium
# Group Title: SRG-OS-000037-GPOS-00015
# Rule ID: SV-86789r3_rule
# STIG ID: RHEL-07-030710
# Rule Title: All uses of the newgrp command must be audited.
# Discussion: Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.
#
# At a minimum, the organization must audit the full-text recording of privileged access commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.
#
# Satisfies: SRG-OS-000037-GPOS-00015, SRG-OS-000042-GPOS-00020, SRG-OS-000392-GPOS-00172, SRG-OS-000462-GPOS-00206, SRG-OS-000471-GPOS-00215
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "newgrp" command occur.
#
# Check for the following system call being audited by performing the following command to check the file system rules in "/etc/audit/audit.rules":
#
# # grep -i /usr/bin/newgrp /etc/audit/audit.rules
#
# -a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "newgrp" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000130
# The information system generates audit records containing information that establishes what type of event occurred.
# NIST SP 800-53 :: AU-3
# NIST SP 800-53A :: AU-3.1
# NIST SP 800-53 Revision 4 :: AU-3
#
# CCI-000135
# The information system generates audit records containing the organization-defined additional, more detailed information that is to be included in the audit records.
# NIST SP 800-53 :: AU-3 (1)
# NIST SP 800-53A :: AU-3 (1).1 (ii)
# NIST SP 800-53 Revision 4 :: AU-3 (1)
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72165
#   set_fact:
#     stig_rhel7_v1r4_v_72165_result: 'fail'
#   when:
#     - "'v_72165' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72165_result != 'pass'


# Vuln ID: V-72167
# Severity: medium
# Group Title: SRG-OS-000037-GPOS-00015
# Rule ID: SV-86791r3_rule
# STIG ID: RHEL-07-030720
# Rule Title: All uses of the chsh command must be audited.
# Discussion: Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.
#
# At a minimum, the organization must audit the full-text recording of privileged access commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.
#
# Satisfies: SRG-OS-000037-GPOS-00015, SRG-OS-000042-GPOS-00020, SRG-OS-000392-GPOS-00172, SRG-OS-000462-GPOS-00206, SRG-OS-000471-GPOS-00215
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "chsh" command occur.
#
# Check for the following system call being audited by performing the following command to check the file system rules in "/etc/audit/audit.rules":
#
# # grep -i /usr/bin/chsh /etc/audit/audit.rules
#
# -a always,exit -F path=/usr/bin/chsh -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "chsh" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -a always,exit -F path=/usr/bin/chsh -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000130
# The information system generates audit records containing information that establishes what type of event occurred.
# NIST SP 800-53 :: AU-3
# NIST SP 800-53A :: AU-3.1
# NIST SP 800-53 Revision 4 :: AU-3
#
# CCI-000135
# The information system generates audit records containing the organization-defined additional, more detailed information that is to be included in the audit records.
# NIST SP 800-53 :: AU-3 (1)
# NIST SP 800-53A :: AU-3 (1).1 (ii)
# NIST SP 800-53 Revision 4 :: AU-3 (1)
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72167
#   set_fact:
#     stig_rhel7_v1r4_v_72167_result: 'fail'
#   when:
#     - "'v_72167' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72167_result != 'pass'


# Vuln ID: V-72169
# Severity: medium
# Group Title: SRG-OS-000037-GPOS-00015
# Rule ID: SV-86793r4_rule
# STIG ID: RHEL-07-030730
# Rule Title: All uses of the sudoedit command must be audited.
# Discussion: Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.
#
# At a minimum, the organization must audit the full-text recording of privileged access commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.
#
# Satisfies: SRG-OS-000037-GPOS-00015, SRG-OS-000042-GPOS-00020, SRG-OS-000392-GPOS-00172, SRG-OS-000462-GPOS-00206, SRG-OS-000471-GPOS-00215
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "sudoedit" command occur.
#
# Check for the following system calls being audited by performing the following command to check the file system rules in "/etc/audit/audit.rules":
#
# # grep -i "/usr/bin/sudoedit" /etc/audit/audit.rules
#
# -a always,exit -F path=/bin/sudoedit -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "sudoedit" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -a always,exit -F path=/bin/sudoedit -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000130
# The information system generates audit records containing information that establishes what type of event occurred.
# NIST SP 800-53 :: AU-3
# NIST SP 800-53A :: AU-3.1
# NIST SP 800-53 Revision 4 :: AU-3
#
# CCI-000135
# The information system generates audit records containing the organization-defined additional, more detailed information that is to be included in the audit records.
# NIST SP 800-53 :: AU-3 (1)
# NIST SP 800-53A :: AU-3 (1).1 (ii)
# NIST SP 800-53 Revision 4 :: AU-3 (1)
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72169
#   set_fact:
#     stig_rhel7_v1r4_v_72169_result: 'fail'
#   when:
#     - "'v_72169' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72169_result != 'pass'


# Vuln ID: V-72171
# Severity: medium
# Group Title: SRG-OS-000042-GPOS-00020
# Rule ID: SV-86795r5_rule
# STIG ID: RHEL-07-030740
# Rule Title: All uses of the mount command must be audited.
# Discussion: Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.
#
# At a minimum, the organization must audit the full-text recording of privileged mount commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.
#
# Satisfies: SRG-OS-000042-GPOS-00020, SRG-OS-000392-GPOS-00172
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "mount" command occur.
#
# Check for the following system calls being audited by performing the following series of commands to check the file system rules in "/etc/audit/audit.rules":
#
# # grep -iw "mount" /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=4294967295 -k privileged-mount
#
# -a always,exit -F arch=b32 -F path=/bin/mount -F auid>=1000 -F auid!=4294967295 -k privileged-mount
#
# -a always,exit -F arch=b32 -F path=/usr/bin/mount -F auid>=1000 -F auid!=4294967295 -k privileged-mount
#
# -a always,exit -F arch=b64 -S mount -F auid>=1000 -F auid!=4294967295 -k privileged-mount
#
# -a always,exit -F arch=b64 -F path=/bin/mount -F auid>=1000 -F auid!=4294967295 -k privileged-mount
#
# -a always,exit -F arch=b64 -F path=/usr/bin/mount -F auid>=1000 -F auid!=4294967295 -k privileged-mount
#
# If all uses of the mount command are not being audited, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "mount" command occur.
#
# Add or update the following rules in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=4294967295 -k privileged-mount
#
# -a always,exit -F arch=b32 -F path=/bin/mount -F auid>=1000 -F auid!=4294967295 -k privileged-mount
#
# -a always,exit -F arch=b32 -F path=/usr/bin/mount -F auid>=1000 -F auid!=4294967295 -k privileged-mount
#
# -a always,exit -F arch=b64 -S mount -F auid>=1000 -F auid!=4294967295 -k privileged-mount
#
# -a always,exit -F arch=b64 -F path=/bin/mount -F auid>=1000 -F auid!=4294967295 -k privileged-mount
#
# -a always,exit -F arch=b64 -F path=/usr/bin/mount -F auid>=1000 -F auid!=4294967295 -k privileged-mount
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000135
# The information system generates audit records containing the organization-defined additional, more detailed information that is to be included in the audit records.
# NIST SP 800-53 :: AU-3 (1)
# NIST SP 800-53A :: AU-3 (1).1 (ii)
# NIST SP 800-53 Revision 4 :: AU-3 (1)
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72171
#   set_fact:
#     stig_rhel7_v1r4_v_72171_result: 'fail'
#   when:
#     - "'v_72171' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72171_result != 'pass'


# Vuln ID: V-72173
# Severity: medium
# Group Title: SRG-OS-000042-GPOS-00020
# Rule ID: SV-86797r4_rule
# STIG ID: RHEL-07-030750
# Rule Title: All uses of the umount command must be audited.
# Discussion: Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.
#
# At a minimum, the organization must audit the full-text recording of privileged mount commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.
#
# Satisfies: SRG-OS-000042-GPOS-00020, SRG-OS-000392-GPOS-00172
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "umount" command occur.
#
# Check for the following system calls being audited by performing the following series of commands to check the file system rules in "/etc/audit/audit.rules":
#
# # grep -i "/bin/umount" /etc/audit/audit.rules
#
# -a always,exit -F path=/bin/umount -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-mount
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "umount" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -a always,exit -F path=/bin/umount -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-mount
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000135
# The information system generates audit records containing the organization-defined additional, more detailed information that is to be included in the audit records.
# NIST SP 800-53 :: AU-3 (1)
# NIST SP 800-53A :: AU-3 (1).1 (ii)
# NIST SP 800-53 Revision 4 :: AU-3 (1)
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72173
#   set_fact:
#     stig_rhel7_v1r4_v_72173_result: 'fail'
#   when:
#     - "'v_72173' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72173_result != 'pass'


# Vuln ID: V-72175
# Severity: medium
# Group Title: SRG-OS-000042-GPOS-00020
# Rule ID: SV-86799r3_rule
# STIG ID: RHEL-07-030760
# Rule Title: All uses of the postdrop command must be audited.
# Discussion: Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.
#
# At a minimum, the organization must audit the full-text recording of privileged postfix commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.
#
# Satisfies: SRG-OS-000042-GPOS-00020, SRG-OS-000392-GPOS-00172
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "postdrop" command occur.
#
# Check for the following system call being audited by performing the following command to check the file system rules in "/etc/audit/audit.rules":
#
# # grep -i /usr/sbin/postdrop /etc/audit/audit.rules
#
# -a always,exit -F path=/usr/sbin/postdrop -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-postfix
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "postdrop" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -a always,exit -F path=/usr/sbin/postdrop -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-postfix
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000135
# The information system generates audit records containing the organization-defined additional, more detailed information that is to be included in the audit records.
# NIST SP 800-53 :: AU-3 (1)
# NIST SP 800-53A :: AU-3 (1).1 (ii)
# NIST SP 800-53 Revision 4 :: AU-3 (1)
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72175
#   set_fact:
#     stig_rhel7_v1r4_v_72175_result: 'fail'
#   when:
#     - "'v_72175' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72175_result != 'pass'


# Vuln ID: V-72177
# Severity: medium
# Group Title: SRG-OS-000042-GPOS-00020
# Rule ID: SV-86801r2_rule
# STIG ID: RHEL-07-030770
# Rule Title: All uses of the postqueue command must be audited.
# Discussion: Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.
#
# At a minimum, the organization must audit the full-text recording of privileged postfix commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.
#
# Satisfies: SRG-OS-000042-GPOS-00020, SRG-OS-000392-GPOS-00172
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "postqueue" command occur.
#
# Check for the following system call being audited by performing the following command to check the file system rules in "/etc/audit/audit.rules":
#
# # grep -i /usr/sbin/postqueue /etc/audit/audit.rules
#
# -a always,exit -F path=/usr/sbin/postqueue -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-postfix
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "postqueue" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -a always,exit -F path=/usr/sbin/postqueue -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-postfix
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000135
# The information system generates audit records containing the organization-defined additional, more detailed information that is to be included in the audit records.
# NIST SP 800-53 :: AU-3 (1)
# NIST SP 800-53A :: AU-3 (1).1 (ii)
# NIST SP 800-53 Revision 4 :: AU-3 (1)
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72177
#   set_fact:
#     stig_rhel7_v1r4_v_72177_result: 'fail'
#   when:
#     - "'v_72177' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72177_result != 'pass'


# Vuln ID: V-72179
# Severity: medium
# Group Title: SRG-OS-000042-GPOS-00020
# Rule ID: SV-86803r2_rule
# STIG ID: RHEL-07-030780
# Rule Title: All uses of the ssh-keysign command must be audited.
# Discussion: Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.
#
# At a minimum, the organization must audit the full-text recording of privileged ssh commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.
#
# Satisfies: SRG-OS-000042-GPOS-00020, SRG-OS-000392-GPOS-00172, SRG-OS-000471-GPOS-00215
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "ssh-keysign" command occur.
#
# Check for the following system call being audited by performing the following command to check the file system rules in "/etc/audit/audit.rules":
#
# # grep -i /usr/libexec/openssh/ssh-keysign /etc/audit/audit.rules
#
# -a always,exit -F path=/usr/libexec/openssh/ssh-keysign -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-ssh
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "ssh-keysign" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -a always,exit -F path=/usr/libexec/openssh/ssh-keysign -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-ssh
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000135
# The information system generates audit records containing the organization-defined additional, more detailed information that is to be included in the audit records.
# NIST SP 800-53 :: AU-3 (1)
# NIST SP 800-53A :: AU-3 (1).1 (ii)
# NIST SP 800-53 Revision 4 :: AU-3 (1)
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72179
#   set_fact:
#     stig_rhel7_v1r4_v_72179_result: 'fail'
#   when:
#     - "'v_72179' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72179_result != 'pass'


# Vuln ID: V-72183
# Severity: medium
# Group Title: SRG-OS-000042-GPOS-00020
# Rule ID: SV-86807r2_rule
# STIG ID: RHEL-07-030800
# Rule Title: All uses of the crontab command must be audited.
# Discussion: Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.
#
# At a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.
#
# Satisfies: SRG-OS-000042-GPOS-00020, SRG-OS-000392-GPOS-00172, SRG-OS-000471-GPOS-00215
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "crontab" command occur.
#
# Check for the following system call being audited by performing the following command to check the file system rules in "/etc/audit/audit.rules":
#
# # grep -i /usr/bin/crontab /etc/audit/audit.rules
#
# -a always,exit -F path=/usr/bin/crontab -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-cron
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "crontab" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -a always,exit -F path=/usr/bin/crontab -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-cron
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000135
# The information system generates audit records containing the organization-defined additional, more detailed information that is to be included in the audit records.
# NIST SP 800-53 :: AU-3 (1)
# NIST SP 800-53A :: AU-3 (1).1 (ii)
# NIST SP 800-53 Revision 4 :: AU-3 (1)
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72183
#   set_fact:
#     stig_rhel7_v1r4_v_72183_result: 'fail'
#   when:
#     - "'v_72183' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72183_result != 'pass'


# Vuln ID: V-72185
# Severity: medium
# Group Title: SRG-OS-000471-GPOS-00215
# Rule ID: SV-86809r3_rule
# STIG ID: RHEL-07-030810
# Rule Title: All uses of the pam_timestamp_check command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "pam_timestamp_check" command occur.
#
# Check the auditing rules in "/etc/audit/audit.rules" with the following command:
#
# # grep -i "/sbin/pam_timestamp_check" /etc/audit/audit.rules
#
# -a always,exit -F path=/sbin/pam_timestamp_check -F perm=x -F auid>=1000 -F auid!=4294967295  -k privileged-pam
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "pam_timestamp_check" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -a always,exit -F path=/sbin/pam_timestamp_check -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-pam
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel7_v1r4 v_72185
#   set_fact:
#     stig_rhel7_v1r4_v_72185_result: 'fail'
#   when:
#     - "'v_72185' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72185_result != 'pass'


# Vuln ID: V-72187
# Severity: medium
# Group Title: SRG-OS-000471-GPOS-00216
# Rule ID: SV-86811r3_rule
# STIG ID: RHEL-07-030820
# Rule Title: All uses of the init_module command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000471-GPOS-00216, SRG-OS-000477-GPOS-00222
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "init_module" command occur.
#
# Check the auditing rules in "/etc/audit/audit.rules" with the following command:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the line appropriate for the system architecture must be present.
#
# # grep -iw init_module /etc/audit/audit.rules
#
# If the command does not return the following output (appropriate to the architecture), this is a finding.
#
# -a always,exit -F arch=b32 -S init_module -k module-change
#
# -a always,exit -F arch=b64 -S init_module -k module-change
#
# If there are no audit rules defined for "init_module", this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "init_module" command occur.
#
# Add or update the following rules in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S init_module -k module-change
#
# -a always,exit -F arch=b64 -S init_module -k module-change
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel7_v1r4 v_72187
#   set_fact:
#     stig_rhel7_v1r4_v_72187_result: 'fail'
#   when:
#     - "'v_72187' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72187_result != 'pass'


# Vuln ID: V-72189
# Severity: medium
# Group Title: SRG-OS-000471-GPOS-00216
# Rule ID: SV-86813r3_rule
# STIG ID: RHEL-07-030830
# Rule Title: All uses of the delete_module command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000471-GPOS-00216, SRG-OS-000477-GPOS-00222
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "delete_module" command occur.
#
# Check the auditing rules in "/etc/audit/audit.rules" with the following command:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the line appropriate for the system architecture must be present.
#
# # grep -iw delete_module /etc/audit/audit.rules
#
# If the command does not return the following output (appropriate to the architecture), this is a finding.
#
# -a always,exit -F arch=b32 -S delete_module -k module-change
#
# -a always,exit -F arch=b64 -S delete_module -k module-change
#
# If there are no audit rules defined for "delete_module", this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "delete_module" command occur.
#
# Add or update the following rules in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S delete_module -k module-change
#
# -a always,exit -F arch=b64 -S delete_module -k module-change
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel7_v1r4 v_72189
#   set_fact:
#     stig_rhel7_v1r4_v_72189_result: 'fail'
#   when:
#     - "'v_72189' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72189_result != 'pass'


# Vuln ID: V-72191
# Severity: medium
# Group Title: SRG-OS-000471-GPOS-00216
# Rule ID: SV-86815r3_rule
# STIG ID: RHEL-07-030840
# Rule Title: All uses of the insmod command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000471-GPOS-00216, SRG-OS-000477-GPOS-00222
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "insmod" command occur.
#
# Check the auditing rules in "/etc/audit/audit.rules" with the following command:
#
# # grep -i insmod /etc/audit/audit.rules
#
# If the command does not return the following output this is a finding.
#
# -w /sbin/insmod -p x -F auid!=4294967295 -k module-change
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "insmod" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -w /sbin/insmod -p x -F auid!=4294967295 -k module-change
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel7_v1r4 v_72191
#   set_fact:
#     stig_rhel7_v1r4_v_72191_result: 'fail'
#   when:
#     - "'v_72191' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72191_result != 'pass'


# Vuln ID: V-72193
# Severity: medium
# Group Title: SRG-OS-000471-GPOS-00216
# Rule ID: SV-86817r3_rule
# STIG ID: RHEL-07-030850
# Rule Title: All uses of the rmmod command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000471-GPOS-00216, SRG-OS-000477-GPOS-00222
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "rmmod" command occur.
#
# Check the auditing rules in "/etc/audit/audit.rules" with the following command:
#
# # grep -i rmmod /etc/audit/audit.rules
#
# If the command does not return the following output, this is a finding.
#
# -w /sbin/rmmod -p x -F auid!=4294967295 -k module-change
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "rmmod" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -w /sbin/rmmod-p x -F auid!=4294967295 -k module-change
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel7_v1r4 v_72193
#   set_fact:
#     stig_rhel7_v1r4_v_72193_result: 'fail'
#   when:
#     - "'v_72193' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72193_result != 'pass'


# Vuln ID: V-72195
# Severity: medium
# Group Title: SRG-OS-000471-GPOS-00216
# Rule ID: SV-86819r3_rule
# STIG ID: RHEL-07-030860
# Rule Title: All uses of the modprobe command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000471-GPOS-00216, SRG-OS-000477-GPOS-00222
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "modprobe" command occur.
#
# Check the auditing rules in "/etc/audit/audit.rules" with the following command:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the line appropriate for the system architecture must be present.
#
# # grep -i modprobe /etc/audit/audit.rules
#
# If the command does not return the following output, this is a finding.
#
# -w /sbin/modprobe -p x -F auid!=4294967295 -k module-change
#
# If the command does not return any output, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "modprobe" command occur.
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -w /sbin/modprobe -p x -F auid!=4294967295 -k module-change
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel7_v1r4 v_72195
#   set_fact:
#     stig_rhel7_v1r4_v_72195_result: 'fail'
#   when:
#     - "'v_72195' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72195_result != 'pass'


# Vuln ID: V-72197
# Severity: medium
# Group Title: SRG-OS-000004-GPOS-00004
# Rule ID: SV-86821r4_rule
# STIG ID: RHEL-07-030870
# Rule Title: The operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/passwd.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000004-GPOS-00004, SRG-OS-000239-GPOS-00089, SRG-OS-000240-GPOS-00090, SRG-OS-000241-GPOS-00091, SRG-OS-000303-GPOS-00120, SRG-OS-000476-GPOS-00221
# IA Controls:
# Check Content: Verify the operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect "/etc/passwd".
#
# Check the auditing rules in "/etc/audit/audit.rules" with the following command:
#
# # grep /etc/passwd /etc/audit/audit.rules
#
# -w /etc/passwd -p wa -k identity
#
# If the command does not return a line, or the line is commented out, this is a finding.
# Fix Text: Configure the operating system to generate audit records for all account creations, modifications, disabling, and termination events that affect "/etc/passwd".
#
# Add or update the following rule "/etc/audit/rules.d/audit.rules":
#
# -w /etc/passwd -p wa -k identity
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000018
# The information system automatically audits account creation actions.
# NIST SP 800-53 :: AC-2 (4)
# NIST SP 800-53A :: AC-2 (4).1 (i&ii)
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-001403
# The information system automatically audits account modification actions.
# NIST SP 800-53 :: AC-2 (4)
# NIST SP 800-53A :: AC-2 (4).1 (i&ii)
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
# CCI-002130
# The information system automatically audits account enabling actions.
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
#
# - name: fail stig_rhel7_v1r4 v_72197
#   set_fact:
#     stig_rhel7_v1r4_v_72197_result: 'fail'
#   when:
#     - "'v_72197' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72197_result != 'pass'


# Vuln ID: V-72199
# Severity: medium
# Group Title: SRG-OS-000466-GPOS-00210
# Rule ID: SV-86823r3_rule
# STIG ID: RHEL-07-030880
# Rule Title: All uses of the rename command must be audited.
# Discussion: If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.
#
# Satisfies: SRG-OS-000466-GPOS-00210, SRG-OS-000467-GPOS-00210, SRG-OS-000468-GPOS-00212, SRG-OS-000392-GPOS-00172
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "rename" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw rename /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S rename -F perm=x -F auid>=1000 -F auid!=4294967295 -k delete
#
# -a always,exit -F arch=b64 -S rename -F perm=x -F auid>=1000 -F auid!=4294967295 -k delete
#
# If there are no audit rules defined for the "rename" command, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "rename" command occur.
#
# Add the following rules in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S rename -F perm=x -F auid>=1000 -F auid!=4294967295 -k delete
#
# -a always,exit -F arch=b64 -S rename -F perm=x -F auid>=1000 -F auid!=4294967295 -k delete
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72199
#   set_fact:
#     stig_rhel7_v1r4_v_72199_result: 'fail'
#   when:
#     - "'v_72199' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72199_result != 'pass'


# Vuln ID: V-72201
# Severity: medium
# Group Title: SRG-OS-000466-GPOS-00210
# Rule ID: SV-86825r3_rule
# STIG ID: RHEL-07-030890
# Rule Title: All uses of the renameat command must be audited.
# Discussion: If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.
#
# Satisfies: SRG-OS-000466-GPOS-00210, SRG-OS-000467-GPOS-00210, SRG-OS-000468-GPOS-00212, SRG-OS-000392-GPOS-00172
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "renameat" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw renameat /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S renameat -F perm=x -F auid>=1000 -F auid!=4294967295 -k delete
#
# -a always,exit -F arch=b64 -S renameat -F perm=x -F auid>=1000 -F auid!=4294967295 -k delete
#
# If there are no audit rules defined for the "renameat" command, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "renameat" command occur.
#
# Add the following rules in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S renameat -F perm=x -F auid>=1000 -F auid!=4294967295 -k delete
#
# -a always,exit -F arch=b64 -S renameat -F perm=x -F auid>=1000 -F auid!=4294967295 -k delete
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72201
#   set_fact:
#     stig_rhel7_v1r4_v_72201_result: 'fail'
#   when:
#     - "'v_72201' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72201_result != 'pass'


# Vuln ID: V-72203
# Severity: medium
# Group Title: SRG-OS-000466-GPOS-00210
# Rule ID: SV-86827r3_rule
# STIG ID: RHEL-07-030900
# Rule Title: All uses of the rmdir command must be audited.
# Discussion: If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.
#
# Satisfies: SRG-OS-000466-GPOS-00210, SRG-OS-000467-GPOS-00210, SRG-OS-000468-GPOS-00212, SRG-OS-000392-GPOS-00172
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "rmdir" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw rmdir /etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S rmdir -F perm=x -F auid>=1000 -F auid!=4294967295 -k delete
#
# -a always,exit -F arch=b64 -S rmdir -F perm=x -F auid>=1000 -F auid!=4294967295 -k delete
#
# If there are no audit rules defined for the "rmdir" command, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "rmdir" command occur.
#
# Add the following rules in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S rmdir -F perm=x -F auid>=1000 -F auid!=4294967295 -k delete
#
# -a always,exit -F arch=b64 -S rmdir -F perm=x -F auid>=1000 -F auid!=4294967295 -k delete
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72203
#   set_fact:
#     stig_rhel7_v1r4_v_72203_result: 'fail'
#   when:
#     - "'v_72203' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72203_result != 'pass'


# Vuln ID: V-72205
# Severity: medium
# Group Title: SRG-OS-000466-GPOS-00210
# Rule ID: SV-86829r3_rule
# STIG ID: RHEL-07-030910
# Rule Title: All uses of the unlink command must be audited.
# Discussion: If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.
#
# Satisfies: SRG-OS-000466-GPOS-00210, SRG-OS-000467-GPOS-00210, SRG-OS-000468-GPOS-00212, SRG-OS-000392-GPOS-00172
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "unlink" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw unlink/etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S unlink -F perm=x -F auid>=1000 -F auid!=4294967295 -k delete
#
# -a always,exit -F arch=b64 -S unlink -F perm=x -F auid>=1000 -F auid!=4294967295 -k delete
#
# If there are no audit rules defined for the "unlink" command, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "unlink" command occur.
#
# Add the following rules in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S unlink -F perm=x -F auid>=1000 -F auid!=4294967295 -k delete
#
# -a always,exit -F arch=b64 -S unlink -F perm=x -F auid>=1000 -F auid!=4294967295 -k delete
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72205
#   set_fact:
#     stig_rhel7_v1r4_v_72205_result: 'fail'
#   when:
#     - "'v_72205' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72205_result != 'pass'


# Vuln ID: V-72207
# Severity: medium
# Group Title: SRG-OS-000466-GPOS-00210
# Rule ID: SV-86831r3_rule
# STIG ID: RHEL-07-030920
# Rule Title: All uses of the unlinkat command must be audited.
# Discussion: If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.
#
# Satisfies: SRG-OS-000466-GPOS-00210, SRG-OS-000467-GPOS-00210, SRG-OS-000468-GPOS-00212, SRG-OS-000392-GPOS-00172
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "unlinkat" command occur.
#
# Check the file system rules in "/etc/audit/audit.rules" with the following commands:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be present.
#
# # grep -iw unlinkat/etc/audit/audit.rules
#
# -a always,exit -F arch=b32 -S unlinkat -F perm=x -F auid>=1000 -F auid!=4294967295 -k delete
#
# -a always,exit -F arch=b64 -S unlinkat -F perm=x -F auid>=1000 -F auid!=4294967295 -k delete
#
# If there are no audit rules defined for the "unlinkat" command, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "unlinkat" command occur.
#
# Add the following rules in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S unlinkat -F perm=x -F auid>=1000 -F auid!=4294967295 -k delete
#
# -a always,exit -F arch=b64 -S unlinkat -F perm=x -F auid>=1000 -F auid!=4294967295 -k delete
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-002884
# The organization audits nonlocal maintenance and diagnostic sessions' organization-defined audit events.
# NIST SP 800-53 Revision 4 :: MA-4 (1) (a)
#
#
# - name: fail stig_rhel7_v1r4 v_72207
#   set_fact:
#     stig_rhel7_v1r4_v_72207_result: 'fail'
#   when:
#     - "'v_72207' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_72207_result != 'pass'


# Vuln ID: V-73163
# Severity: medium
# Group Title: SRG-OS-000342-GPOS-00133
# Rule ID: SV-87815r2_rule
# STIG ID: RHEL-07-030321
# Rule Title: The audit system must take appropriate action when there is an error sending audit records to a remote system.
# Discussion: Taking appropriate action when there is an error sending audit records to a remote system will minimize the possibility of losing audit records.
# IA Controls:
# Check Content: Verify the action the operating system takes if there is an error sending audit records to a remote system.
#
# Check the action that takes place if there is an error sending audit records to a remote system with the following command:
#
# # grep -i network_failure_action /etc/audisp/audisp-remote.conf
# network_failure_action = stop
#
# If the value of the "network_failure_action" option is not "syslog", "single", or "halt", or the line is commented out, this is a finding.
# Fix Text: Configure the action the operating system takes if there is an error sending audit records to a remote system.
#
# Uncomment the "network_failure_action" option in "/etc/audisp/audisp-remote.conf" and set it to "syslog", "single", or "halt".
#
# network_failure_action = single
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001851
# The information system off-loads audit records per organization-defined frequency onto a different system or media than the system being audited.
# NIST SP 800-53 Revision 4 :: AU-4 (1)
#
#
# - name: fail stig_rhel7_v1r4 v_73163
#   set_fact:
#     stig_rhel7_v1r4_v_73163_result: 'fail'
#   when:
#     - "'v_73163' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_73163_result != 'pass'


# Vuln ID: V-73165
# Severity: medium
# Group Title: SRG-OS-000004-GPOS-00004
# Rule ID: SV-87817r2_rule
# STIG ID: RHEL-07-030871
# Rule Title: The operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/group.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
# IA Controls:
# Check Content: Verify the operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect "/etc/group".
#
# Check the auditing rules in "/etc/audit/audit.rules" with the following command:
#
# # grep /etc/group /etc/audit/audit.rules
#
# -w /etc/group -p wa -k audit_rules_usergroup_modification
#
# If the command does not return a line, or the line is commented out, this is a finding.
# Fix Text: Configure the operating system to generate audit records for all account creations, modifications, disabling, and termination events that affect "/etc/group".
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -w /etc/group -p wa -k identity
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000018
# The information system automatically audits account creation actions.
# NIST SP 800-53 :: AC-2 (4)
# NIST SP 800-53A :: AC-2 (4).1 (i&ii)
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-001403
# The information system automatically audits account modification actions.
# NIST SP 800-53 :: AC-2 (4)
# NIST SP 800-53A :: AC-2 (4).1 (i&ii)
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
# CCI-002130
# The information system automatically audits account enabling actions.
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
#
# - name: fail stig_rhel7_v1r4 v_73165
#   set_fact:
#     stig_rhel7_v1r4_v_73165_result: 'fail'
#   when:
#     - "'v_73165' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_73165_result != 'pass'


# Vuln ID: V-73167
# Severity: medium
# Group Title: SRG-OS-000004-GPOS-00004
# Rule ID: SV-87819r3_rule
# STIG ID: RHEL-07-030872
# Rule Title: The operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/gshadow.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
# IA Controls:
# Check Content: Verify the operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect "/etc/gshadow".
#
# Check the auditing rules in "/etc/audit/audit.rules" with the following command:
#
# # grep /etc/gshadow /etc/audit/audit.rules
#
# -w /etc/gshadow -p wa -k identity
#
# If the command does not return a line, or the line is commented out, this is a finding.
# Fix Text: Configure the operating system to generate audit records for all account creations, modifications, disabling, and termination events that affect "/etc/gshadow".
#
# Add or update the following rule in "/etc/audit/rules.d/audit.rules":
#
# -w /etc/gshadow -p wa -k identity
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000018
# The information system automatically audits account creation actions.
# NIST SP 800-53 :: AC-2 (4)
# NIST SP 800-53A :: AC-2 (4).1 (i&ii)
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-001403
# The information system automatically audits account modification actions.
# NIST SP 800-53 :: AC-2 (4)
# NIST SP 800-53A :: AC-2 (4).1 (i&ii)
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
# CCI-002130
# The information system automatically audits account enabling actions.
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
#
# - name: fail stig_rhel7_v1r4 v_73167
#   set_fact:
#     stig_rhel7_v1r4_v_73167_result: 'fail'
#   when:
#     - "'v_73167' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_73167_result != 'pass'


# Vuln ID: V-73171
# Severity: medium
# Group Title: SRG-OS-000004-GPOS-00004
# Rule ID: SV-87823r3_rule
# STIG ID: RHEL-07-030873
# Rule Title: The operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/shadow.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
# IA Controls:
# Check Content: Verify the operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/shadow.
#
# Check the auditing rules in "/etc/audit/audit.rules" with the following command:
#
# # grep /etc/shadow /etc/audit/audit.rules
#
# -w /etc/shadow -p wa -k identity
#
# If the command does not return a line, or the line is commented out, this is a finding.
# Fix Text: Configure the operating system to generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/shadow.
#
# Add or update the following file system rule in "/etc/audit/rules.d/audit.rules":
#
# -w /etc/shadow -p wa -k identity
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000018
# The information system automatically audits account creation actions.
# NIST SP 800-53 :: AC-2 (4)
# NIST SP 800-53A :: AC-2 (4).1 (i&ii)
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-001403
# The information system automatically audits account modification actions.
# NIST SP 800-53 :: AC-2 (4)
# NIST SP 800-53A :: AC-2 (4).1 (i&ii)
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
# CCI-002130
# The information system automatically audits account enabling actions.
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
#
# - name: fail stig_rhel7_v1r4 v_73171
  # set_fact:
  #   stig_rhel7_v1r4_v_73171_result: 'fail'
#   when:
#     - "'v_73171' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_73171_result != 'pass'


# Vuln ID: V-73173
# Severity: medium
# Group Title: SRG-OS-000004-GPOS-00004
# Rule ID: SV-87825r4_rule
# STIG ID: RHEL-07-030874
# Rule Title: The operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/opasswd.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
# IA Controls:
# Check Content: Verify the operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/opasswd.
#
# Check the auditing rules in "/etc/audit/rules.d/audit.rules" with the following command:
#
# # grep /etc/security/opasswd /etc/audit/rules.d/audit.rules
#
# -w /etc/security/opasswd -p wa -k identity
#
# If the command does not return a line, or the line is commented out, this is a finding.
# Fix Text: Configure the operating system to generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/opasswd.
#
# Add or update the following file system rule in "/etc/audit/rules.d/audit.rules":
#
# -w /etc/security/opasswd -p wa -k identity
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000018
# The information system automatically audits account creation actions.
# NIST SP 800-53 :: AC-2 (4)
# NIST SP 800-53A :: AC-2 (4).1 (i&ii)
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
# CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
# CCI-001403
# The information system automatically audits account modification actions.
# NIST SP 800-53 :: AC-2 (4)
# NIST SP 800-53A :: AC-2 (4).1 (i&ii)
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
# CCI-002130
# The information system automatically audits account enabling actions.
# NIST SP 800-53 Revision 4 :: AC-2 (4)
#
#
# - name: fail stig_rhel7_v1r4 v_73173
  # set_fact:
  #   stig_rhel7_v1r4_v_73173_result: 'fail'
#   when:
#     - "'v_73173' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_73173_result != 'pass'


# Vuln ID: V-78999
# Severity: medium
# Group Title: SRG-OS-000471-GPOS-00216
# Rule ID: SV-93705r1_rule
# STIG ID: RHEL-07-030819
# Rule Title: All uses of the create_module command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000471-GPOS-00216, SRG-OS-000477-GPOS-00222
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "create_module" command occur.
#
# Check the auditing rules in "/etc/audit/audit.rules" with the following command:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the line appropriate for the system architecture must be present.
#
# # grep -iw create_module /etc/audit/audit.rules
#
# If the command does not return the following output (appropriate to the architecture), this is a finding.
#
# -a always,exit -F arch=b32 -S create_module -k module-change
#
# -a always,exit -F arch=b64 -S create_module -k module-change
#
# If there are no audit rules defined for create_module, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "create_module" command occur.
#
# Add or update the following rules in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
#
# -a always,exit -F arch=b32 -S create_module -k module-change
#
# -a always,exit -F arch=b64 -S create_module -k module-change
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#
# - name: fail stig_rhel7_v1r4 v_78999
  # set_fact:
  #   stig_rhel7_v1r4_v_78999_result: 'fail'
#   when:
#     - "'v_78999' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_78999_result != 'pass'


# Vuln ID: V-79001
# Severity: medium
# Group Title: SRG-OS-000471-GPOS-00216
# Rule ID: SV-93707r1_rule
# STIG ID: RHEL-07-030821
# Rule Title: All uses of the finit_module command must be audited.
# Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
#
# Audit records can be generated from various components within the information system (e.g., module or policy filter).
#
# Satisfies: SRG-OS-000471-GPOS-00216, SRG-OS-000477-GPOS-00222
# IA Controls:
# Check Content: Verify the operating system generates audit records when successful/unsuccessful attempts to use the "finit_module" command occur.
#
# Check the auditing rules in "/etc/audit/audit.rules" with the following command:
#
# Note: The output lines of the command are duplicated to cover both 32-bit and 64-bit architectures. Only the line appropriate for the system architecture must be present.
#
# # grep -iw finit_module /etc/audit/audit.rules
#
# If the command does not return the following output (appropriate to the architecture), this is a finding.
#
# -a always,exit -F arch=b32 -S finit_module -k module-change
#
# -a always,exit -F arch=b64 -S finit_module -k module-change
#
# If there are no audit rules defined for finit_module, this is a finding.
# Fix Text: Configure the operating system to generate audit records when successful/unsuccessful attempts to use the "finit_module" command occur.
#
# Add or update the following rules in "/etc/audit/rules.d/audit.rules":
#
# Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be configured.
# -a always,exit -F arch=b32 -S finit_module -k module-change
#
# -a always,exit -F arch=b64 -S finit_module -k module-change
#
# The audit daemon must be restarted for the changes to take effect.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000172
# The information system generates audit records for the events defined in AU-2 d with the content defined in AU-3.
# NIST SP 800-53 :: AU-12 c
# NIST SP 800-53A :: AU-12.1 (iv)
# NIST SP 800-53 Revision 4 :: AU-12 c
#
#

# - name: fail stig_rhel7_v1r4 v_79001
  # set_fact:
  #   stig_rhel7_v1r4_v_79001_result: 'fail'
#   when:
#     - "'v_79001' in stig_rhel7_v1r4_checks"
#     - stig_rhel7_v1r4_v_79001_result != 'pass'
