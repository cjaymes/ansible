# Vuln ID: V-72301
# Severity: high
# Group Title: SRG-OS-000480-GPOS-00227
# Rule ID: SV-86925r1_rule
# STIG ID: RHEL-07-040700
# Rule Title: The Trivial File Transfer Protocol (TFTP) server package must not be installed if not required for operational support.
# Discussion: If TFTP is required for operational support (such as the transmission of router configurations) its use must be documented with the Information System Security Officer (ISSO), restricted to only authorized personnel, and have access control rules established.
# IA Controls:
# Check Content: Verify a TFTP server has not been installed on the system.
#
# Check to see if a TFTP server has been installed with the following command:
#
# # yum list installed tftp-server
# tftp-server-0.49-9.el7.x86_64.rpm
#
# If TFTP is installed and the requirement for TFTP is not documented with the ISSO, this is a finding.
# Fix Text: Remove the TFTP package from the system with the following command:
#
# # yum remove tftp
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000318
# The organization audits and reviews activities associated with configuration controlled changes to the system.
# NIST SP 800-53 :: CM-3 e
# NIST SP 800-53A :: CM-3.1 (v)
# NIST SP 800-53 Revision 4 :: CM-3 f
#
# CCI-000368
# The organization documents any deviations from the established configuration settings for organization-defined information system components based on organization-defined operational requirements.
# NIST SP 800-53 :: CM-6 c
# NIST SP 800-53A :: CM-6.1 (v)
# NIST SP 800-53 Revision 4 :: CM-6 c
#
# CCI-001812
# The information system prohibits user installation of software without explicit privileged status.
# NIST SP 800-53 Revision 4 :: CM-11 (2)
#
# CCI-001813
# The information system enforces access restrictions.
# NIST SP 800-53 Revision 4 :: CM-5 (1)
#
# CCI-001814
# The Information system supports auditing of the enforcement actions.
# NIST SP 800-53 Revision 4 :: CM-5 (1)
#
#
- name: check stig_rhel7_v1r4 v_72301
  set_fact:
    stig_rhel7_v1r4_results: "{{stig_rhel7_v1r4_results|combine({'v_72301': 'fail'})}}"
  when: '"v_72301" in stig_rhel7_v1r4_checks'


# Vuln ID: V-72305
# Severity: medium
# Group Title: SRG-OS-000480-GPOS-00227
# Rule ID: SV-86929r2_rule
# STIG ID: RHEL-07-040720
# Rule Title: If the Trivial File Transfer Protocol (TFTP) server is required, the TFTP daemon must be configured to operate in secure mode.
# Discussion: Restricting TFTP to a specific directory prevents remote users from copying, transferring, or overwriting system files.
# IA Controls:
# Check Content: Verify the TFTP daemon is configured to operate in secure mode.
#
# Check to see if a TFTP server has been installed with the following commands:
#
# # yum list installed | grep tftp-server
# tftp-server.x86_64    x.x-x.el7    rhel-7-server-rpms
#
# If a TFTP server is not installed, this is Not Applicable.
#
# If a TFTP server is installed, check for the server arguments with the following command:
#
# # grep server_arge /etc/xinetd.d/tftp
# server_args = -s /var/lib/tftpboot
#
# If the "server_args" line does not have a "-s" option and a subdirectory is not assigned, this is a finding.
# Fix Text: Configure the TFTP daemon to operate in secure mode by adding the following line to "/etc/xinetd.d/tftp" (or modify the line to have the required value):
#
# server_args = -s /var/lib/tftpboot
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel7_v1r4 v_72305
  set_fact:
    stig_rhel7_v1r4_results: "{{stig_rhel7_v1r4_results|combine({'v_72305': 'fail'})}}"
  when: '"v_72305" in stig_rhel7_v1r4_checks'
