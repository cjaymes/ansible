# Vuln ID: V-71919
# Severity: medium
# Group Title: SRG-OS-000073-GPOS-00041
# Rule ID: SV-86543r2_rule
# STIG ID: RHEL-07-010200
# Rule Title: The PAM system service must be configured to store only encrypted representations of passwords.
# Discussion: Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised. Passwords encrypted with a weak algorithm are no more protected than if they are kept in plain text.
# IA Controls:
# Check Content: Verify the PAM system service is configured to store only encrypted representations of passwords. The strength of encryption that must be used to hash passwords for all accounts is SHA512.
#
# Check that the system is configured to create SHA512 hashed passwords with the following command:
#
# # grep password /etc/pam.d/system-auth-ac
# password sufficient pam_unix.so sha512
#
# If the "/etc/pam.d/system-auth-ac" configuration files allow for password hashes other than SHA512 to be used, this is a finding.
# Fix Text: Configure the operating system to store only SHA512 encrypted representations of passwords.
#
# Add the following line in "/etc/pam.d/system-auth-ac":
#
# password sufficient pam_unix.so sha512
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000196
# The information system, for password-based authentication, stores only encrypted representations of passwords.
# NIST SP 800-53 :: IA-5 (1) (c)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (c)
#
#
- name: check stig_rhel7_v1r4 v_71919
  set_fact:
    stig_rhel7_v1r4_v_71919_result: 'fail'
  when: '"v_71919" in stig_rhel7_v1r4_checks'


# Vuln ID: V-71933
# Severity: medium
# Group Title: SRG-OS-000077-GPOS-00045
# Rule ID: SV-86557r2_rule
# STIG ID: RHEL-07-010270
# Rule Title: Passwords must be prohibited from reuse for a minimum of five generations.
# Discussion: Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. If the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the end result is a password that is not changed per policy requirements.
# IA Controls:
# Check Content: Verify the operating system prohibits password reuse for a minimum of five generations.
#
# Check for the value of the "remember" argument in "/etc/pam.d/system-auth-ac" with the following command:
#
# # grep -i remember /etc/pam.d/system-auth-ac
# password sufficient pam_unix.so use_authtok sha512 shadow remember=5
#
# If the line containing the "pam_unix.so" line does not have the "remember" module argument set, or the value of the "remember" module argument is set to less than "5", this is a finding.
# Fix Text: Configure the operating system to prohibit password reuse for a minimum of five generations.
#
# Add the following line in "/etc/pam.d/system-auth-ac" (or modify the line to have the required value):
#
# password sufficient pam_unix.so use_authtok sha512 shadow remember=5
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000200
# The information system prohibits password reuse for the organization defined number of generations.
# NIST SP 800-53 :: IA-5 (1) (e)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (e)
#
#
- name: check stig_rhel7_v1r4 v_71933
  set_fact:
    stig_rhel7_v1r4_v_71933_result: 'fail'
  when: '"v_71933" in stig_rhel7_v1r4_checks'


# Vuln ID: V-71937
# Severity: high
# Group Title: SRG-OS-000480-GPOS-00227
# Rule ID: SV-86561r2_rule
# STIG ID: RHEL-07-010290
# Rule Title: The system must not have accounts configured with blank or null passwords.
# Discussion: If an account has an empty password, anyone could log on and run commands with the privileges of that account. Accounts with empty passwords should never be used in operational environments.
# IA Controls:
# Check Content: To verify that null passwords cannot be used, run the following command:
#
# # grep nullok /etc/pam.d/system-auth-ac
#
# If this produces any output, it may be possible to log on with accounts with empty passwords.
#
# If null passwords can be used, this is a finding.
# Fix Text: If an account is configured for password authentication but does not have an assigned password, it may be possible to log on to the account without authenticating.
#
# Remove any instances of the "nullok" option in "/etc/pam.d/system-auth-ac" to prevent logons with empty passwords.
#
# Note: Any updates made to "/etc/pam.d/system-auth-ac" may be overwritten by the "authconfig" program. The "authconfig" program should not be used.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel7_v1r4 v_71937
  set_fact:
    stig_rhel7_v1r4_v_71937_result: 'fail'
  when: '"v_71937" in stig_rhel7_v1r4_checks'


# Vuln ID: V-71943
# Severity: medium
# Group Title: SRG-OS-000329-GPOS-00128
# Rule ID: SV-86567r3_rule
# STIG ID: RHEL-07-010320
# Rule Title: Accounts subject to three unsuccessful logon attempts within 15 minutes must be locked for the maximum configurable period.
# Discussion: By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced. Limits are imposed by locking the account.
#
# Satisfies: SRG-OS-000329-GPOS-00128, SRG-OS-000021-GPOS-00005
# IA Controls:
# Check Content: Verify the operating system automatically locks an account for the maximum period for which the system can be configured.
#
# Check that the system locks an account for the maximum period after three unsuccessful logon attempts within a period of 15 minutes with the following command:
#
# # grep pam_faillock.so /etc/pam.d/password-auth-ac
# auth        required       pam_faillock.so preauth silent audit deny=3 even_deny_root unlock_time=604800
# auth        [default=die]  pam_faillock.so authfail audit deny=3 even_deny_root unlock_time=604800
# account required pam_faillock.so
#
# If the "unlock_time" setting is greater than "604800" on both lines with the "pam_faillock.so" module name or is missing from a line, this is a finding.
#
# # grep pam_faillock.so /etc/pam.d/system-auth-ac
# auth required pam_faillock.so preauth silent audit deny=3 even_deny_root unlock_time=604800
# auth [default=die] pam_faillock.so authfail audit deny=3 even_deny_root unlock_time=604800
# account required pam_faillock.so
#
# If the "unlock_time" setting is greater than "604800" on both lines with the "pam_faillock.so" module name or is missing from a line, this is a finding.
# Fix Text: Configure the operating system to lock an account for the maximum period when three unsuccessful logon attempts in 15 minutes are made.
#
# Modify the first three lines of the auth section of the "/etc/pam.d/system-auth-ac" and "/etc/pam.d/password-auth-ac" files to match the following lines:
#
# auth        required       pam_faillock.so preauth silent audit deny=3 even_deny_root fail_interval=900 unlock_time=604800
# auth        sufficient     pam_unix.so try_first_pass
# auth        [default=die]  pam_faillock.so authfail audit deny=3 even_deny_root fail_interval=900 unlock_time=604800
# account required pam_faillock.so
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-002238
# The information system automatically locks the account or node for either an organization-defined time period, until the locked account or node is released by an administrator, or delays the next login prompt according to the organization-defined delay algorithm when the maximum number of unsuccessful attempts is exceeded.
# NIST SP 800-53 Revision 4 :: AC-7 b
#
#
- name: check stig_rhel7_v1r4 v_71943
  set_fact:
    stig_rhel7_v1r4_v_71943_result: 'fail'
  when: '"v_71943" in stig_rhel7_v1r4_checks'


# Vuln ID: V-71945
# Severity: medium
# Group Title: SRG-OS-000329-GPOS-00128
# Rule ID: SV-86569r2_rule
# STIG ID: RHEL-07-010330
# Rule Title: If three unsuccessful root logon attempts within 15 minutes occur the associated account must be locked.
# Discussion: By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced. Limits are imposed by locking the account.
#
# Satisfies: SRG-OS-000329-GPOS-00128, SRG-OS-000021-GPOS-00005
# IA Controls:
# Check Content: Verify the operating system automatically locks the root account until it is released by an administrator when three unsuccessful logon attempts in 15 minutes are made.
#
# # grep pam_faillock.so /etc/pam.d/password-auth-ac
# auth required pam_faillock.so preauth silent audit deny=3 even_deny_root unlock_time=604800 fail_interval=900
# auth [default=die] pam_faillock.so authfail audit deny=3 even_deny_root unlock_time=604800 fail_interval=900
# account required pam_faillock.so
#
# If the "even_deny_root" setting is not defined on both lines with the "pam_faillock.so" module name, this is a finding.
#
# # grep pam_faillock.so /etc/pam.d/system-auth-ac
# auth required pam_faillock.so preauth silent audit deny=3 even_deny_root unlock_time=604800 fail_interval=900
# auth [default=die] pam_faillock.so authfail audit deny=3 even_deny_root unlock_time=604800 fail_interval=900
# account required pam_faillock.so
#
# If the "even_deny_root" setting is not defined on both lines with the "pam_faillock.so" module name, this is a finding.
# Fix Text: Configure the operating system to automatically lock the root account until the locked account is released by an administrator when three unsuccessful logon attempts in 15 minutes are made.
#
# Modify the first three lines of the auth section of the "/etc/pam.d/system-auth-ac" and "/etc/pam.d/password-auth-ac" files to match the following lines:
#
# auth        required       pam_faillock.so preauth silent audit deny=3 even_deny_root fail_interval=900 unlock_time=604800
# auth        sufficient     pam_unix.so try_first_pass
# auth        [default=die]  pam_faillock.so authfail audit deny=3 even_deny_root fail_interval=900 unlock_time=604800
# account required pam_faillock.so
#
# Note: Any updates made to "/etc/pam.d/system-auth-ac" and "/etc/pam.d/password-auth-ac" may be overwritten by the "authconfig" program. The "authconfig" program should not be used.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-002238
# The information system automatically locks the account or node for either an organization-defined time period, until the locked account or node is released by an administrator, or delays the next login prompt according to the organization-defined delay algorithm when the maximum number of unsuccessful attempts is exceeded.
# NIST SP 800-53 Revision 4 :: AC-7 b
#
#
- name: check stig_rhel7_v1r4 v_71945
  set_fact:
    stig_rhel7_v1r4_v_71945_result: 'fail'
  when: '"v_71945" in stig_rhel7_v1r4_checks'


# Vuln ID: V-71965
# Severity: medium
# Group Title: SRG-OS-000104-GPOS-00051
# Rule ID: SV-86589r1_rule
# STIG ID: RHEL-07-010500
# Rule Title: The operating system must uniquely identify and must authenticate organizational users (or processes acting on behalf of organizational users) using multifactor authentication.
# Discussion: To assure accountability and prevent unauthenticated access, organizational users must be identified and authenticated to prevent potential misuse and compromise of the system.
#
# Organizational users include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors). Organizational users (and processes acting on behalf of users) must be uniquely identified and authenticated to all accesses, except for the following:
#
# 1) Accesses explicitly identified and documented by the organization. Organizations document specific user actions that can be performed on the information system without identification or authentication;
#
# and
#
# 2) Accesses that occur through authorized use of group authenticators without individual authentication. Organizations may require unique identification of individuals in group accounts (e.g., shared privilege accounts) or for detailed accountability of individual activity.
#
# Satisfies: SRG-OS-000104-GPOS-00051, SRG-OS-000106-GPOS-00053, SRG-OS-000107-GPOS-00054, SRG-OS-000109-GPOS-00056, SRG-OS-000108-GPOS-00055, SRG-OS-000108-GPOS-00057, SRG-OS-000108-GPOS-00058
# IA Controls:
# Check Content: Verify the operating system requires multifactor authentication to uniquely identify organizational users using multifactor authentication.
#
# Check to see if smartcard authentication is enforced on the system:
#
# # authconfig --test | grep -i smartcard
#
# The entry for use only smartcard for logon may be enabled, and the smartcard module and smartcard removal actions must not be blank.
#
# If smartcard authentication is disabled or the smartcard and smartcard removal actions are blank, this is a finding.
# Fix Text: Configure the operating system to require individuals to be authenticated with a multifactor authenticator.
#
# Enable smartcard logons with the following commands:
#
# # authconfig --enablesmartcard --smartcardaction=1 --update
# # authconfig --enablerequiresmartcard -update
#
# Modify the "/etc/pam_pkcs11/pkcs11_eventmgr.conf" file to uncomment the following line:
#
# #/usr/X11R6/bin/xscreensaver-command -lock
#
# Modify the "/etc/pam_pkcs11/pam_pkcs11.conf" file to use the cackey module if required.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000766
# The information system implements multifactor authentication for network access to non-privileged accounts.
# NIST SP 800-53 :: IA-2 (2)
# NIST SP 800-53A :: IA-2 (2).1
# NIST SP 800-53 Revision 4 :: IA-2 (2)
#
#
- name: check stig_rhel7_v1r4 v_71965
  set_fact:
    stig_rhel7_v1r4_v_71965_result: 'fail'
  when: '"v_71965" in stig_rhel7_v1r4_checks'


# Vuln ID: V-72275
# Severity: low
# Group Title: SRG-OS-000480-GPOS-00227
# Rule ID: SV-86899r2_rule
# STIG ID: RHEL-07-040530
# Rule Title: The system must display the date and time of the last successful account logon upon logon.
# Discussion: Providing users with feedback on when account accesses last occurred facilitates user recognition and reporting of unauthorized account use.
# IA Controls:
# Check Content: Verify users are provided with feedback on when account accesses last occurred.
#
# Check that "pam_lastlog" is used and not silent with the following command:
#
# # grep pam_lastlog /etc/pam.d/postlogin-ac
# session required pam_lastlog.so showfailed
#
# If the "silent" option is present with "pam_lastlog" check the sshd configuration file.
#
# # grep -i printlastlog /etc/ssh/sshd_config
# PrintLastLog yes
#
# If "pam_lastlog" is missing from "/etc/pam.d/postlogin-ac" file, or the silent option is present and PrintLastLog is missing from or set to "no" in the "/etc/ssh/sshd_config" file this is a finding.
# Fix Text: Configure the operating system to provide users with feedback on when account accesses last occurred by setting the required configuration options in "/etc/pam.d/postlogin-ac".
#
# Add the following line to the top of "/etc/pam.d/postlogin-ac":
#
# session     required      pam_lastlog.so showfailed
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000366
# The organization implements the security configuration settings.
# NIST SP 800-53 :: CM-6 b
# NIST SP 800-53A :: CM-6.1 (iv)
# NIST SP 800-53 Revision 4 :: CM-6 b
#
#
- name: check stig_rhel7_v1r4 v_72275
  set_fact:
    stig_rhel7_v1r4_v_72275_result: 'fail'
  when: '"v_72275" in stig_rhel7_v1r4_checks'


# Vuln ID: V-72417
# Severity: medium
# Group Title: SRG-OS-000375-GPOS-00160
# Rule ID: SV-87041r2_rule
# STIG ID: RHEL-07-041001
# Rule Title: The operating system must have the required packages for multifactor authentication installed.
# Discussion: Using an authentication device, such as a CAC or token that is separate from the information system, ensures that even if the information system is compromised, that compromise will not affect credentials stored on the authentication device.
#
# Multifactor solutions that require devices separate from information systems gaining access include, for example, hardware tokens providing time-based or challenge-response authenticators and smart cards such as the U.S. Government Personal Identity Verification card and the DoD Common Access Card.
#
# A privileged account is defined as an information system account with authorizations of a privileged user.
#
# Remote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.
#
# This requirement only applies to components where this is specific to the function of the device or has the concept of an organizational user (e.g., VPN, proxy capability). This does not apply to authentication for the purpose of configuring the device itself (management).
#
# Requires further clarification from NIST.
#
# Satisfies: SRG-OS-000375-GPOS-00160, SRG-OS-000375-GPOS-00161, SRG-OS-000375-GPOS-00162
# IA Controls:
# Check Content: Verify the operating system has the packages required for multifactor authentication installed.
#
# Check for the presence of the packages required to support multifactor authentication with the following commands:
#
# # yum list installed esc
# esc-1.1.0-26.el7.noarch.rpm
#
# # yum list installed pam_pkcs11
# pam_pkcs11-0.6.2-14.el7.noarch.rpm
#
# # yum list installed authconfig-gtk
# authconfig-gtk-6.1.12-19.el7.noarch.rpm
#
# If the "esc", "pam_pkcs11", and "authconfig-gtk" packages are not installed, this is a finding.
# Fix Text: Configure the operating system to implement multifactor authentication by installing the required packages.
#
# Install the "esc", "pam_pkcs11", "authconfig", and "authconfig-gtk" packages on the system with the following command:
#
# # yum install esc pam_pkcs11 authconfig-gtk
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001948
# The information system implements multifactor authentication for remote access to privileged accounts such that one of the factors is provided by a device separate from the system gaining access.
# NIST SP 800-53 Revision 4 :: IA-2 (11)
#
# CCI-001953
# The information system accepts Personal Identity Verification (PIV) credentials.
# NIST SP 800-53 Revision 4 :: IA-2 (12)
#
# CCI-001954
# The information system electronically verifies Personal Identity Verification (PIV) credentials.
# NIST SP 800-53 Revision 4 :: IA-2 (12)
#
#
- name: check stig_rhel7_v1r4 v_72417
  set_fact:
    stig_rhel7_v1r4_v_72417_result: 'fail'
  when: '"v_72417" in stig_rhel7_v1r4_checks'


# Vuln ID: V-72433
# Severity: medium
# Group Title: SRG-OS-000375-GPOS-00160
# Rule ID: SV-87057r4_rule
# STIG ID: RHEL-07-041003
# Rule Title: The operating system must implement certificate status checking for PKI authentication.
# Discussion: Using an authentication device, such as a CAC or token that is separate from the information system, ensures that even if the information system is compromised, that compromise will not affect credentials stored on the authentication device.
#
# Multifactor solutions that require devices separate from information systems gaining access include, for example, hardware tokens providing time-based or challenge-response authenticators and smart cards such as the U.S. Government Personal Identity Verification card and the DoD Common Access Card.
#
# A privileged account is defined as an information system account with authorizations of a privileged user.
#
# Remote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.
#
# This requirement only applies to components where this is specific to the function of the device or has the concept of an organizational user (e.g., VPN, proxy capability). This does not apply to authentication for the purpose of configuring the device itself (management).
#
# Requires further clarification from NIST.
#
# Satisfies: SRG-OS-000375-GPOS-00160, SRG-OS-000375-GPOS-00161, SRG-OS-000375-GPOS-00162
# IA Controls:
# Check Content: Verify the operating system implements certificate status checking for PKI authentication.
#
# Check to see if Online Certificate Status Protocol (OCSP) is enabled on the system with the following command:
#
# # grep cert_policy /etc/pam_pkcs11/pam_pkcs11.conf
#
# cert_policy = ca, ocsp_on, signature;
# cert_policy = ca, ocsp_on, signature;
# cert_policy = ca, ocsp_on, signature;
#
#
# There should be at least three lines returned.
#
# If "oscp_on" is not present in all "cert_policy" lines in "/etc/pam_pkcs11/pam_pkcs11.conf", this is a finding.
#
# Fix Text: Configure the operating system to do certificate status checking for PKI authentication.
#
# Modify all of the "cert_policy" lines in "/etc/pam_pkcs11/pam_pkcs11.conf" to include "ocsp_on".
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001948
# The information system implements multifactor authentication for remote access to privileged accounts such that one of the factors is provided by a device separate from the system gaining access.
# NIST SP 800-53 Revision 4 :: IA-2 (11)
#
# CCI-001953
# The information system accepts Personal Identity Verification (PIV) credentials.
# NIST SP 800-53 Revision 4 :: IA-2 (12)
#
# CCI-001954
# The information system electronically verifies Personal Identity Verification (PIV) credentials.
# NIST SP 800-53 Revision 4 :: IA-2 (12)
#
#
- name: check stig_rhel7_v1r4 v_72433
  set_fact:
    stig_rhel7_v1r4_v_72433_result: 'fail'
  when: '"v_72433" in stig_rhel7_v1r4_checks'


# Vuln ID: V-73159
# Severity: medium
# Group Title: SRG-OS-000069-GPOS-00037
# Rule ID: SV-87811r3_rule
# STIG ID: RHEL-07-010119
# Rule Title: When passwords are changed or new passwords are established, pwquality must be used.
# Discussion: Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. “pwquality” enforces complex password construction configuration and has the ability to limit brute-force attacks on the system.
# IA Controls:
# Check Content: Verify the operating system uses "pwquality" to enforce the password complexity rules.
#
# Check for the use of "pwquality" with the following command:
#
# #  cat /etc/pam.d/passwd | grep pam_pwquality
#
# password required pam_pwquality.so retry=3
#
# If the command does not return a line containing the value "pam_pwquality.so", this is a finding.
#
# If the value of “retry” is set to “0” or greater than “3”, this is a finding.
# Fix Text: Configure the operating system to use "pwquality" to enforce password complexity rules.
#
# Add the following line to "/etc/pam.d/passwd" (or modify the line to have the required value):
#
# password    required    pam_pwquality.so retry=3
#
# Note: The value of “retry” should be between “1” and “3”.
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000192
# The information system enforces password complexity by the minimum number of upper case characters used.
# NIST SP 800-53 :: IA-5 (1) (a)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (a)
#
#
- name: check stig_rhel7_v1r4 v_73159
  set_fact:
    stig_rhel7_v1r4_v_73159_result: 'fail'
  when: '"v_73159" in stig_rhel7_v1r4_checks'
