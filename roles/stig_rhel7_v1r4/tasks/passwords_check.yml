# Vuln ID: V-71903
# Severity: medium
# Group Title: SRG-OS-000069-GPOS-00037
# Rule ID: SV-86527r2_rule
# STIG ID: RHEL-07-010120
# Rule Title: When passwords are changed or new passwords are established, the new password must contain at least one upper-case character.
# Discussion: Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.
#
# Password complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.
# IA Controls:
# Check Content: Note: The value to require a number of upper-case characters to be set is expressed as a negative number in "/etc/security/pwquality.conf".
#
# Check the value for "ucredit" in "/etc/security/pwquality.conf" with the following command:
#
# # grep ucredit /etc/security/pwquality.conf
# ucredit = -1
#
# If the value of "ucredit" is not set to a negative value, this is a finding.
# Fix Text: Configure the operating system to enforce password complexity by requiring that at least one upper-case character be used by setting the "ucredit" option.
#
# Add the following line to "/etc/security/pwquality.conf" (or modify the line to have the required value):
#
# ucredit = -1
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000192
# The information system enforces password complexity by the minimum number of upper case characters used.
# NIST SP 800-53 :: IA-5 (1) (a)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (a)
#
#
- name: check stig_rhel7_v1r4 v_71903
  set_fact: stig_rhel7_v1r4_results['v_71903'] = 'fail'
  when: '"v_71903" in stig_rhel7_v1r4_checks'


# Vuln ID: V-71905
# Severity: medium
# Group Title: SRG-OS-000070-GPOS-00038
# Rule ID: SV-86529r4_rule
# STIG ID: RHEL-07-010130
# Rule Title: When passwords are changed or new passwords are established, the new password must contain at least one lower-case character.
# Discussion: Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.
#
# Password complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.
# IA Controls:
# Check Content: Note: The value to require a number of lower-case characters to be set is expressed as a negative number in "/etc/security/pwquality.conf".
#
# Check the value for "lcredit" in "/etc/security/pwquality.conf" with the following command:
#
# # grep lcredit /etc/security/pwquality.conf
# lcredit = -1
#
# If the value of "lcredit" is not set to a negative value, this is a finding.
# Fix Text: Configure the system to require at least one lower-case character when creating or changing a password.
#
# Add or modify the following line
# in "/etc/security/pwquality.conf":
#
# lcredit = -1
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000193
# The information system enforces password complexity by the minimum number of lower case characters used.
# NIST SP 800-53 :: IA-5 (1) (a)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (a)
#
#
- name: check stig_rhel7_v1r4 v_71905
  set_fact: stig_rhel7_v1r4_results['v_71905'] = 'fail'
  when: '"v_71905" in stig_rhel7_v1r4_checks'


# Vuln ID: V-71907
# Severity: medium
# Group Title: SRG-OS-000071-GPOS-00039
# Rule ID: SV-86531r2_rule
# STIG ID: RHEL-07-010140
# Rule Title: When passwords are changed or new passwords are assigned, the new password must contain at least one numeric character.
# Discussion: Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.
#
# Password complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.
# IA Controls:
# Check Content: Note: The value to require a number of numeric characters to be set is expressed as a negative number in "/etc/security/pwquality.conf".
#
# Check the value for "dcredit" in "/etc/security/pwquality.conf" with the following command:
#
# # grep dcredit /etc/security/pwquality.conf
# dcredit = -1
#
# If the value of "dcredit" is not set to a negative value, this is a finding.
# Fix Text: Configure the operating system to enforce password complexity by requiring that at least one numeric character be used by setting the "dcredit" option.
#
# Add the following line to /etc/security/pwquality.conf (or modify the line to have the required value):
#
# dcredit = -1
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000194
# The information system enforces password complexity by the minimum number of numeric characters used.
# NIST SP 800-53 :: IA-5 (1) (a)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (a)
#
#
- name: check stig_rhel7_v1r4 v_71907
  set_fact: stig_rhel7_v1r4_results['v_71907'] = 'fail'
  when: '"v_71907" in stig_rhel7_v1r4_checks'


# Vuln ID: V-71909
# Severity: medium
# Group Title: SRG-OS-000266-GPOS-00101
# Rule ID: SV-86533r1_rule
# STIG ID: RHEL-07-010150
# Rule Title: When passwords are changed or new passwords are assigned, the new password must contain at least one special character.
# Discussion: Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.
#
# Password complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.
# IA Controls:
# Check Content: Verify the operating system enforces password complexity by requiring that at least one special character be used.
#
# Note: The value to require a number of special characters to be set is expressed as a negative number in "/etc/security/pwquality.conf".
#
# Check the value for "ocredit" in "/etc/security/pwquality.conf" with the following command:
#
# # grep ocredit /etc/security/pwquality.conf
# ocredit=-1
#
# If the value of "ocredit" is not set to a negative value, this is a finding.
# Fix Text: Configure the operating system to enforce password complexity by requiring that at least one special character be used by setting the "dcredit" option.
#
# Add the following line to "/etc/security/pwquality.conf" (or modify the line to have the required value):
#
# ocredit = -1
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-001619
# The information system enforces password complexity by the minimum number of special characters used.
# NIST SP 800-53 :: IA-5 (1) (a)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (a)
#
#
- name: check stig_rhel7_v1r4 v_71909
  set_fact: stig_rhel7_v1r4_results['v_71909'] = 'fail'
  when: '"v_71909" in stig_rhel7_v1r4_checks'


# Vuln ID: V-71911
# Severity: medium
# Group Title: SRG-OS-000072-GPOS-00040
# Rule ID: SV-86535r1_rule
# STIG ID: RHEL-07-010160
# Rule Title: When passwords are changed a minimum of eight of the total number of characters must be changed.
# Discussion: Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.
#
# Password complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.
# IA Controls:
# Check Content: The "difok" option sets the number of characters in a password that must not be present in the old password.
#
# Check for the value of the "difok" option in "/etc/security/pwquality.conf" with the following command:
#
# # grep difok /etc/security/pwquality.conf
# difok = 8
#
# If the value of "difok" is set to less than "8", this is a finding.
# Fix Text: Configure the operating system to require the change of at least eight of the total number of characters when passwords are changed by setting the "difok" option.
#
# Add the following line to "/etc/security/pwquality.conf" (or modify the line to have the required value):
#
# difok = 8
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000195
# The information system, for password-based authentication, when new passwords are created, enforces that at least an organization-defined number of characters are changed.
# NIST SP 800-53 :: IA-5 (1) (b)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (b)
#
#
- name: check stig_rhel7_v1r4 v_71911
  set_fact: stig_rhel7_v1r4_results['v_71911'] = 'fail'
  when: '"v_71911" in stig_rhel7_v1r4_checks'


# Vuln ID: V-71913
# Severity: medium
# Group Title: SRG-OS-000072-GPOS-00040
# Rule ID: SV-86537r1_rule
# STIG ID: RHEL-07-010170
# Rule Title: When passwords are changed a minimum of four character classes must be changed.
# Discussion: Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.
#
# Password complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.
# IA Controls:
# Check Content: The "minclass" option sets the minimum number of required classes of characters for the new password (digits, upper-case, lower-case, others).
#
# Check for the value of the "minclass" option in "/etc/security/pwquality.conf" with the following command:
#
# # grep minclass /etc/security/pwquality.conf
# minclass = 4
#
# If the value of "minclass" is set to less than "4", this is a finding.
# Fix Text: Configure the operating system to require the change of at least four character classes when passwords are changed by setting the "minclass" option.
#
# Add the following line to "/etc/security/pwquality.conf conf" (or modify the line to have the required value):
#
# minclass = 4
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000195
# The information system, for password-based authentication, when new passwords are created, enforces that at least an organization-defined number of characters are changed.
# NIST SP 800-53 :: IA-5 (1) (b)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (b)
#
#
- name: check stig_rhel7_v1r4 v_71913
  set_fact: stig_rhel7_v1r4_results['v_71913'] = 'fail'
  when: '"v_71913" in stig_rhel7_v1r4_checks'


# Vuln ID: V-71915
# Severity: medium
# Group Title: SRG-OS-000072-GPOS-00040
# Rule ID: SV-86539r2_rule
# STIG ID: RHEL-07-010180
# Rule Title: When passwords are changed the number of repeating consecutive characters must not be more than three characters.
# Discussion: Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.
#
# Password complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.
# IA Controls:
# Check Content: The "maxrepeat" option sets the maximum number of allowed same consecutive characters in a new password.
#
# Check for the value of the "maxrepeat" option in "/etc/security/pwquality.conf" with the following command:
#
# # grep maxrepeat /etc/security/pwquality.conf
# maxrepeat = 3
#
# If the value of "maxrepeat" is set to more than "3", this is a finding.
# Fix Text: Configure the operating system to require the change of the number of repeating consecutive characters when passwords are changed by setting the "maxrepeat" option.
#
# Add the following line to "/etc/security/pwquality.conf conf" (or modify the line to have the required value):
#
# maxrepeat = 3
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000195
# The information system, for password-based authentication, when new passwords are created, enforces that at least an organization-defined number of characters are changed.
# NIST SP 800-53 :: IA-5 (1) (b)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (b)
#
#
- name: check stig_rhel7_v1r4 v_71915
  set_fact: stig_rhel7_v1r4_results['v_71915'] = 'fail'
  when: '"v_71915" in stig_rhel7_v1r4_checks'


# Vuln ID: V-71917
# Severity: medium
# Group Title: SRG-OS-000072-GPOS-00040
# Rule ID: SV-86541r1_rule
# STIG ID: RHEL-07-010190
# Rule Title: When passwords are changed the number of repeating characters of the same character class must not be more than four characters.
# Discussion: Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.
#
# Password complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.
# IA Controls:
# Check Content: The "maxclassrepeat" option sets the maximum number of allowed same consecutive characters in the same class in the new password.
#
# Check for the value of the "maxclassrepeat" option in "/etc/security/pwquality.conf" with the following command:
#
# # grep maxclassrepeat /etc/security/pwquality.conf
# maxclassrepeat = 4
#
# If the value of "maxclassrepeat" is set to more than "4", this is a finding.
# Fix Text: Configure the operating system to require the change of the number of repeating characters of the same character class when passwords are changed by setting the "maxclassrepeat" option.
#
# Add the following line to "/etc/security/pwquality.conf" conf (or modify the line to have the required value):
#
# maxclassrepeat = 4
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000195
# The information system, for password-based authentication, when new passwords are created, enforces that at least an organization-defined number of characters are changed.
# NIST SP 800-53 :: IA-5 (1) (b)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (b)
#
#
- name: check stig_rhel7_v1r4 v_71917
  set_fact: stig_rhel7_v1r4_results['v_71917'] = 'fail'
  when: '"v_71917" in stig_rhel7_v1r4_checks'


# Vuln ID: V-71921
# Severity: medium
# Group Title: SRG-OS-000073-GPOS-00041
# Rule ID: SV-86545r1_rule
# STIG ID: RHEL-07-010210
# Rule Title: The shadow file must be configured to store only encrypted representations of passwords.
# Discussion: Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised. Passwords encrypted with a weak algorithm are no more protected than if they are kept in plain text.
# IA Controls:
# Check Content: Verify the system's shadow file is configured to store only encrypted representations of passwords. The strength of encryption that must be used to hash passwords for all accounts is SHA512.
#
# Check that the system is configured to create SHA512 hashed passwords with the following command:
#
# # grep -i encrypt /etc/login.defs
# ENCRYPT_METHOD SHA512
#
# If the "/etc/login.defs" configuration file does not exist or allows for password hashes other than SHA512 to be used, this is a finding.
# Fix Text: Configure the operating system to store only SHA512 encrypted representations of passwords.
#
# Add or update the following line in "/etc/login.defs":
#
# ENCRYPT_METHOD SHA512
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000196
# The information system, for password-based authentication, stores only encrypted representations of passwords.
# NIST SP 800-53 :: IA-5 (1) (c)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (c)
#
#
- name: check stig_rhel7_v1r4 v_71921
  set_fact: stig_rhel7_v1r4_results['v_71921'] = 'fail'
  when: '"v_71921" in stig_rhel7_v1r4_checks'


# Vuln ID: V-71923
# Severity: medium
# Group Title: SRG-OS-000073-GPOS-00041
# Rule ID: SV-86547r2_rule
# STIG ID: RHEL-07-010220
# Rule Title: User and group account administration utilities must be configured to store only encrypted representations of passwords.
# Discussion: Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised. Passwords encrypted with a weak algorithm are no more protected than if they are kept in plain text.
# IA Controls:
# Check Content: Verify the user and group account administration utilities are configured to store only encrypted representations of passwords. The strength of encryption that must be used to hash passwords for all accounts is "SHA512".
#
# Check that the system is configured to create "SHA512" hashed passwords with the following command:
#
# # cat /etc/libuser.conf | grep -i sha512
#
# crypt_style = sha512
#
# If the "crypt_style" variable is not set to "sha512", is not in the defaults section, or does not exist, this is a finding.
# Fix Text: Configure the operating system to store only SHA512 encrypted representations of passwords.
#
# Add or update the following line in "/etc/libuser.conf" in the [defaults] section:
#
# crypt_style = sha512
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000196
# The information system, for password-based authentication, stores only encrypted representations of passwords.
# NIST SP 800-53 :: IA-5 (1) (c)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (c)
#
#
- name: check stig_rhel7_v1r4 v_71923
  set_fact: stig_rhel7_v1r4_results['v_71923'] = 'fail'
  when: '"v_71923" in stig_rhel7_v1r4_checks'


# Vuln ID: V-71925
# Severity: medium
# Group Title: SRG-OS-000075-GPOS-00043
# Rule ID: SV-86549r1_rule
# STIG ID: RHEL-07-010230
# Rule Title: Passwords for new users must be restricted to a 24 hours/1 day minimum lifetime.
# Discussion: Enforcing a minimum password lifetime helps to prevent repeated password changes to defeat the password reuse or history enforcement requirement. If users are allowed to immediately and continually change their password, the password could be repeatedly changed in a short period of time to defeat the organization's policy regarding password reuse.
# IA Controls:
# Check Content: Verify the operating system enforces 24 hours/1 day as the minimum password lifetime for new user accounts.
#
# Check for the value of "PASS_MIN_DAYS" in "/etc/login.defs" with the following command:
#
# # grep -i pass_min_days /etc/login.defs
# PASS_MIN_DAYS     1
#
# If the "PASS_MIN_DAYS" parameter value is not "1" or greater, or is commented out, this is a finding.
# Fix Text: Configure the operating system to enforce 24 hours/1 day as the minimum password lifetime.
#
# Add the following line in "/etc/login.defs" (or modify the line to have the required value):
#
# PASS_MIN_DAYS     1
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000198
# The information system enforces minimum password lifetime restrictions.
# NIST SP 800-53 :: IA-5 (1) (d)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (d)
#
#
- name: check stig_rhel7_v1r4 v_71925
  set_fact: stig_rhel7_v1r4_results['v_71925'] = 'fail'
  when: '"v_71925" in stig_rhel7_v1r4_checks'


# Vuln ID: V-71927
# Severity: medium
# Group Title: SRG-OS-000075-GPOS-00043
# Rule ID: SV-86551r1_rule
# STIG ID: RHEL-07-010240
# Rule Title: Passwords must be restricted to a 24 hours/1 day minimum lifetime.
# Discussion: Enforcing a minimum password lifetime helps to prevent repeated password changes to defeat the password reuse or history enforcement requirement. If users are allowed to immediately and continually change their password, the password could be repeatedly changed in a short period of time to defeat the organization's policy regarding password reuse.
# IA Controls:
# Check Content: Check whether the minimum time period between password changes for each user account is one day or greater.
#
# # awk -F: '$4 < 1 {print $1}' /etc/shadow
#
# If any results are returned that are not associated with a system account, this is a finding.
# Fix Text: Configure non-compliant accounts to enforce a 24 hours/1 day minimum password lifetime:
#
# # chage -m 1 [user]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000198
# The information system enforces minimum password lifetime restrictions.
# NIST SP 800-53 :: IA-5 (1) (d)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (d)
#
#
- name: check stig_rhel7_v1r4 v_71927
  set_fact: stig_rhel7_v1r4_results['v_71927'] = 'fail'
  when: '"v_71927" in stig_rhel7_v1r4_checks'


# Vuln ID: V-71929
# Severity: medium
# Group Title: SRG-OS-000076-GPOS-00044
# Rule ID: SV-86553r1_rule
# STIG ID: RHEL-07-010250
# Rule Title: Passwords for new users must be restricted to a 60-day maximum lifetime.
# Discussion: Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed periodically. If the operating system does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the operating system passwords could be compromised.
# IA Controls:
# Check Content: Verify the operating system enforces a 60-day maximum password lifetime restriction for new user accounts.
#
# Check for the value of "PASS_MAX_DAYS" in "/etc/login.defs" with the following command:
#
# # grep -i pass_max_days /etc/login.defs
# PASS_MAX_DAYS     60
#
# If the "PASS_MAX_DAYS" parameter value is not 60 or less, or is commented out, this is a finding.
# Fix Text: Configure the operating system to enforce a 60-day maximum password lifetime restriction.
#
# Add the following line in "/etc/login.defs" (or modify the line to have the required value):
#
# PASS_MAX_DAYS     60
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000199
# The information system enforces maximum password lifetime restrictions.
# NIST SP 800-53 :: IA-5 (1) (d)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (d)
#
#
- name: check stig_rhel7_v1r4 v_71929
  set_fact: stig_rhel7_v1r4_results['v_71929'] = 'fail'
  when: '"v_71929" in stig_rhel7_v1r4_checks'


# Vuln ID: V-71931
# Severity: medium
# Group Title: SRG-OS-000076-GPOS-00044
# Rule ID: SV-86555r1_rule
# STIG ID: RHEL-07-010260
# Rule Title: Existing passwords must be restricted to a 60-day maximum lifetime.
# Discussion: Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed periodically. If the operating system does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the operating system passwords could be compromised.
# IA Controls:
# Check Content: Check whether the maximum time period for existing passwords is restricted to 60 days.
#
# # awk -F: '$5 > 60 {print $1}' /etc/shadow
#
# If any results are returned that are not associated with a system account, this is a finding.
# Fix Text: Configure non-compliant accounts to enforce a 60-day maximum password lifetime restriction.
#
# # chage -M 60 [user]
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000199
# The information system enforces maximum password lifetime restrictions.
# NIST SP 800-53 :: IA-5 (1) (d)
# NIST SP 800-53A :: IA-5 (1).1 (v)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (d)
#
#
- name: check stig_rhel7_v1r4 v_71931
  set_fact: stig_rhel7_v1r4_results['v_71931'] = 'fail'
  when: '"v_71931" in stig_rhel7_v1r4_checks'


# Vuln ID: V-71935
# Severity: medium
# Group Title: SRG-OS-000078-GPOS-00046
# Rule ID: SV-86559r1_rule
# STIG ID: RHEL-07-010280
# Rule Title: Passwords must be a minimum of 15 characters in length.
# Discussion: The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised.
#
# Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.
# IA Controls:
# Check Content: Verify the operating system enforces a minimum 15-character password length. The "minlen" option sets the minimum number of characters in a new password.
#
# Check for the value of the "minlen" option in "/etc/security/pwquality.conf" with the following command:
#
# # grep minlen /etc/security/pwquality.conf
# minlen = 15
#
# If the command does not return a "minlen" value of 15 or greater, this is a finding.
# Fix Text: Configure operating system to enforce a minimum 15-character password length.
#
# Add the following line to "/etc/security/pwquality.conf" (or modify the line to have the required value):
#
# minlen = 15
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000205
# The information system enforces minimum password length.
# NIST SP 800-53 :: IA-5 (1) (a)
# NIST SP 800-53A :: IA-5 (1).1 (i)
# NIST SP 800-53 Revision 4 :: IA-5 (1) (a)
#
#
- name: check stig_rhel7_v1r4 v_71935
  set_fact: stig_rhel7_v1r4_results['v_71935'] = 'fail'
  when: '"v_71935" in stig_rhel7_v1r4_checks'


# Vuln ID: V-71941
# Severity: medium
# Group Title: SRG-OS-000118-GPOS-00060
# Rule ID: SV-86565r1_rule
# STIG ID: RHEL-07-010310
# Rule Title: The operating system must disable account identifiers (individuals, groups, roles, and devices) if the password expires.
# Discussion: Inactive identifiers pose a risk to systems and applications because attackers may exploit an inactive identifier and potentially obtain undetected access to the system. Owners of inactive accounts will not notice if unauthorized access to their user account has been obtained.
#
# Operating systems need to track periods of inactivity and disable application identifiers after zero days of inactivity.
# IA Controls:
# Check Content: Verify the operating system disables account identifiers (individuals, groups, roles, and devices) after the password expires with the following command:
#
# # grep -i inactive /etc/default/useradd
# INACTIVE=0
#
# If the value is not set to "0", is commented out, or is not defined, this is a finding.
# Fix Text: Configure the operating system to disable account identifiers (individuals, groups, roles, and devices) after the password expires.
#
# Add the following line to "/etc/default/useradd" (or modify the line to have the required value):
#
# INACTIVE=0
# False Positives:
# False Negatives:
# Documentable: false
# Mitigations:
# Potential Impact:
# Third Party Tools:
# Mitigation Control:
# Responsibility:
# Severity Override Guidance:
# Check Content Reference: M
# Classification: Unclass
# STIG: Red Hat Enterprise Linux 7 Security Technical Implementation Guide :: Release: 4 Benchmark Date: 26 Jan 2018
# VMS Asset Posture:
#  CCI: CCI-000795
# The organization manages information system identifiers by disabling the identifier after an organization defined time period of inactivity.
# NIST SP 800-53 :: IA-4 e
# NIST SP 800-53A :: IA-4.1 (iii)
# NIST SP 800-53 Revision 4 :: IA-4 e
#
#
- name: check stig_rhel7_v1r4 v_71941
  set_fact: stig_rhel7_v1r4_results['v_71941'] = 'fail'
  when: '"v_71941" in stig_rhel7_v1r4_checks'
